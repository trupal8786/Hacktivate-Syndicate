"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="64227ceb-6998-5d24-a46c-3cfbc63f1f33")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([["3416"],{958850(e,t,r){r.d(t,{Om:()=>o,R:()=>d,j6:()=>i,o:()=>s,r$:()=>l,rR:()=>a,xn:()=>n});let n="interactive_thumbnail--thumbnail--weL9A",a="interactive_thumbnail--onboardingTarget--r3Gag",l="interactive_thumbnail--dots--uCufy",i="interactive_thumbnail--dotHoverArea--C3Tz9",o="interactive_thumbnail--dot--ULKPh",s="interactive_thumbnail--activeDot--JtmqS",d="interactive_thumbnail--hidden--xiiPn"},69950(e,t,r){r.d(t,{Az:()=>E});var n=r(105652);if(1464==r.j)var a=r(741542);var l=r(350923),i=r(779757),o=r(63633),s=r(870527),d=r(668522),c=r(153480),u=r(425145),p=r(653982),_=r(473397),f=r(271332),m=r(487817),h=r(644350);let y=(0,l.Iz)(({orgId:e})=>(0,l.eU)(t=>e?t((0,c.K)((0,h.WF4)({orgId:e}))).transform(({org:e})=>{let t=!!(0,d.oA)(e?.isSalesAssistedPlanProperty)?.value,r=!!(0,d.oA)(e?.subscriptionShouldNotAutoRenewPlanProperty);return{isSalesAssisted:t,noTosAcceptanceKey:(0,d.oA)(e?.plan?.termsOfServiceAcceptanceByTermsKey)?.termsKey!==m.Lb.SEATS_MODEL_BILLING_2025,shouldNotAutoRenew:r}}):i.Qw.disabled()));function E(e){let t,r,i,c=e?.id??null,m=!(0,_.CT)(),{warningStatus:h,renewalDate:E,warningType:b}=function(e){let t=(0,o.Xf)(e),r=t.data?.analyze_data_contract_v2_start,n=r?(0,s.A)(r):null,a=(0,u.w)();function l(e,t,r){return{warningType:e,renewalDate:t,warningStatus:r}}if(n&&a.isBefore(n))if(30>=n.diff(a,"day"))return l("error",n,"loaded");else if(90>=n.diff(a,"day"))return l("warning",n,"loaded");else return l(null,n,"loaded");return l(null,n,t.status)}(c),g=!!(0,a.getFeatureFlags)().order_form_billing_terms_banner,v=(0,f.n)(),F=(0,l.md)((0,n.useMemo)(()=>y({orgId:c}),[c])),x=(0,d.oA)(F.data),I=function({orgCreatedAt:e,isSalesAssisted:t,noTosAcceptanceKey:r,shouldNotAutoRenew:n,onExclusionList:a,isAdminView:l,isTermsOfServiceUpdateOn:i}){return!!(e&&(0,p.d)({date:new Date(e)})&&t&&r&&(n||a)&&(l||i))}({orgCreatedAt:e?.created_at,isSalesAssisted:!!x?.isSalesAssisted,noTosAcceptanceKey:!!x?.noTosAcceptanceKey,shouldNotAutoRenew:!!x?.shouldNotAutoRenew,onExclusionList:m,isAdminView:v,isTermsOfServiceUpdateOn:(t=!!(0,a.getFeatureFlags)().terms_of_service_may_2025_update,r=(0,u.w)(),i=!!E&&r.isBefore(E)&&30>=E.diff(r,"day"),t&&i)}),T=(0,n.useMemo)(()=>"loaded"===F.status&&!!I,[F.status,I]);return"loading"===F.status||"loading"===h?(0,d.Xm)():(0,d.gB)({isEligible:g&&T,renewalDate:E,warningType:b})}},653982(e,t,r){r.d(t,{d:()=>l});var n=r(870527),a=r(838719);function l(e){let t=(0,a.initialOptions)().analyze_data_flow_v2_until;return!!t&&(0,n.A)(e.date).isBefore((0,n.A)(t))}},875604(e,t,r){r.d(t,{f:()=>c,x:()=>d});var n=r(239976);if(1464==r.j)var a=r(147911);if(1464==r.j)var l=r(391119);var i=r(865804);if(1464==r.j)var o=r(113641);var s=r(341234);let d="FILE_CREATION_OMNICREATE_DROPDOWN";function c({menuItems:e,"data-onboarding-key":t,trackingProperties:r}){let c=e.newFiles.map(({key:e,...t})=>(0,n.jsx)(s.e,{...t},e));return(0,n.jsx)(l.a,{mode:"match",children:(0,n.jsx)(a.mc,{"data-onboarding-key":t,children:(0,n.jsxs)(i.fu,{name:o.e0.RESOURCE_CREATION_DROPDOWN,properties:{...r,fileCreationDefaultsDropdownType:d},onlyOnce:!0,children:[(0,n.jsx)(a.YJ,{children:c}),function(){if(!e.import)return null;let{key:t,...r}=e.import;return(0,n.jsx)(s.e,{...r},t)}()]})})})}},341234(e,t,r){r.d(t,{e:()=>p,_:()=>u});var n,a=r(239976);if(1464==r.j)var l=r(147911);if(1464==r.j)var i=r(67548);if(1464==r.j)var o=r(145906);var s=r(850159);r(574988);var d=r(623620);function c({text:e,disabled:t}){return(0,a.jsx)(d.Ex,{color:t?d.zE.DISABLED:d.zE.DEFAULT_TRANSLUCENT,text:e})}var u=1464==r.j?((n=u||{}).REQUEST_UPGRADE="REQUEST_UPGRADE",n.REQUEST_SENT="REQUEST_SENT",n.ALPHA="ALPHA",n.BETA="BETA",n):null;function p(e){let t=(0,i.G)(),r=e.isDisabled||e.isLoading;return(0,a.jsx)(o.J,{brand:e.brand,children:(0,a.jsx)(l.q7,{...{0:{className:"x19y5rnk xb3r6kr x1iorvi4 xjkvuk6 xet2fuk x1db2dqx x12ro6kh x1pcmjzl xmh6jz9 x1hop9l x1sd2uan x1g40iwv"},2:{className:"x19y5rnk xb3r6kr x1iorvi4 xjkvuk6 xet2fuk x1db2dqx x12ro6kh xmh6jz9 x1hop9l x1sd2uan x1g40iwv xc4ye4f"},1:{className:"x19y5rnk xb3r6kr x1iorvi4 xjkvuk6 xet2fuk x1db2dqx x12ro6kh xmh6jz9 x1hop9l x1sd2uan x1g40iwv x1fukjz5"},3:{className:"x19y5rnk xb3r6kr x1iorvi4 xjkvuk6 xet2fuk x1db2dqx x12ro6kh xmh6jz9 x1hop9l x1sd2uan x1g40iwv x1fukjz5"}}[("dark"===t.color)<<1|!!e.brand],onClick:e.onClick,"data-testid":e.isLoading?void 0:e.dataTestId,disabled:r,"data-onboarding-key":e.dataOnboardingKey,children:(0,a.jsxs)("div",{...{className:"x78zum5 x6s0dn4 xh8yej3"},children:[(0,a.jsxs)("div",{...{className:"x78zum5 x167g77z x6s0dn4 x1iyjqo2"},children:[(0,a.jsx)("div",{...{0:{},2:{className:"x1aue78i"},1:{className:"xe5c7bq"},3:{className:"xe5c7bq"}}[!!e.brand<<1|!!e.isDisabled],children:e.icon}),(0,a.jsx)("span",{...{0:{className:"x17akokd x1qxcl5b xclx6tv x1akne3o"},1:{className:"x17akokd x1qxcl5b xclx6tv x3vvef7"}}[0|!!e.isDisabled],children:e.title})]}),e.badges?(0,a.jsx)("div",{...{className:"x78zum5 x1c4vz4f x6s0dn4"},children:e.badges.map(e=>(0,a.jsx)(c,{text:_(e),disabled:r},e))}):null]})})})}let _=e=>{switch(e){case"REQUEST_UPGRADE":return(0,s.t)("upgrades.request");case"REQUEST_SENT":return(0,s.t)("upgrades.request_sent");case"ALPHA":return(0,s.t)("file_browser.creation_buttons.alpha");case"BETA":return(0,s.t)("file_browser.creation_buttons.beta")}}},207187(e,t,r){r.d(t,{q:()=>c});var n=r(239976),a=r(395227),l=r(71239),i=r(297151),o=r(732632),s=r(850159),d=r(687497);let c=(0,r(936652).Ju)(function(e){let{open:t,onClose:r,onRemove:c,fileName:u}=e,p=a.hS({open:t,onClose:r}),_=(0,n.jsx)(d.E,{fontWeight:"semi-bold",children:u}),f=async()=>{await c(),r()};return(0,n.jsx)(l.bL,{manager:p,width:"md",children:(0,n.jsxs)(i.vo,{children:[(0,n.jsx)(i.Y9,{children:(0,n.jsx)(i.hE,{children:(0,s.tx)("shared_with_you.confirm_delete.remove_file")})}),(0,n.jsx)(i.nB,{children:(0,s.tx)("shared_with_you.confirm_delete.body",{file_name:_})}),(0,n.jsx)(i.wi,{children:(0,n.jsxs)(i.jk,{children:[(0,n.jsx)(o.$n,{variant:"secondary",onClick:r,children:(0,s.tx)("shared_with_you.confirm_delete.cancel")}),(0,n.jsx)(o.$n,{variant:"destructive",onClick:f,children:(0,s.tx)("shared_with_you.confirm_delete.remove")})]})})]})})})},102959(e,t,r){let n;r.d(t,{a:()=>i});var a=r(765326),l=r(936652);function i(){return n??=(0,l.Ju)(a.A.createLazyComponent(()=>Promise.all([r.e("905"),r.e("7360"),r.e("1617"),r.e("826"),r.e("7205"),r.e("7840"),r.e("7606"),r.e("5830"),r.e("8916"),r.e("5639"),r.e("8701"),r.e("5654"),r.e("8783"),r.e("1904"),r.e("9387"),r.e("907"),r.e("177"),r.e("5693"),r.e("9931"),r.e("5869"),r.e("3416"),r.e("6467"),r.e("3582"),r.e("4395"),r.e("3278")]).then(r.bind(r,553436)).then(e=>e.AddPinModal),(0,l.Ij)("AddPinModal")))}},642135(e,t,r){let n;r.d(t,{I:()=>i});var a=r(765326),l=r(936652);function i(){return n??=(0,l.Ju)(a.A.createLazyComponent(()=>Promise.all([r.e("905"),r.e("7360"),r.e("1617"),r.e("826"),r.e("7205"),r.e("7840"),r.e("7606"),r.e("5830"),r.e("8916"),r.e("5639"),r.e("8701"),r.e("5654"),r.e("8783"),r.e("1904"),r.e("9387"),r.e("907"),r.e("177"),r.e("5693"),r.e("9931"),r.e("5869"),r.e("3416"),r.e("6467"),r.e("3582"),r.e("4395"),r.e("3278")]).then(r.bind(r,342068)).then(e=>e.DeletePinModal),(0,l.Ij)("DeletePinModal")))}},636080(e,t,r){let n;r.d(t,{l:()=>i});var a=r(765326),l=r(936652);function i(){return n??=(0,l.Ju)(a.A.createLazyComponent(()=>Promise.all([r.e("905"),r.e("7360"),r.e("1617"),r.e("826"),r.e("7205"),r.e("7840"),r.e("7606"),r.e("5830"),r.e("8916"),r.e("5639"),r.e("8701"),r.e("5654"),r.e("8783"),r.e("1904"),r.e("9387"),r.e("907"),r.e("177"),r.e("5693"),r.e("9931"),r.e("5869"),r.e("3416"),r.e("6467"),r.e("3582"),r.e("4395"),r.e("3278")]).then(r.bind(r,247045)).then(e=>e.EditPinModal),(0,l.Ij)("EditPinModal")))}},78732(e,t,r){r.d(t,{Z:()=>tH});var n,a=r(239976),l=r(105652),i=r(645186),o=r(741542),s=r(843489),d=r(350923),c=r(574988),u=r(645724),p=r(230191),_=r(947169),f=r(12633),m=r(928397),h=r(773201),y=r(710383),E=r(766632),b=r(622516),g=r(555235),v=r(812456),F=r(799680),x=r(850159),I=r(587047),T=r(985373),w=r(328151),R=r(497935),k=r(349145),O=r(104782),S=r(280891),C=r(422642),A=r(140390),P=r(249318);function j(e){let t=e?.type??null,r=(0,d.md)(E.J),n=(0,d.md)(E.jM),a=(0,d.md)(E.P_),[i,o]=(0,d.fp)(C.R9),s=(0,d.md)(C.Q8),c=(0,d.md)(C.BA),u=(0,d.md)(C.sC),p=(0,d.md)(f.hO.isFragmentSearchAtom),[_,m]=(0,d.fp)((0,E.l4)(t)),h=(0,P.L)(p?"fragment_search_modal":"file_browser",u,!0);return l.useCallback(()=>{if(!e||!_)return;let t=null;e.type===A.WY.RESOURCE&&_.type===A.WY.RESOURCE?t=null:e.type===A.WY.CREATOR&&_.type===A.WY.CREATOR?t=(0,O.C8)(e,O.M2.REMOVE_FROM_GROUP,_):e.type===A.WY.SPACE&&_.type===A.WY.SPACE&&(t=(0,O.q1)(e,O.M2.REMOVE_FROM_GROUP,_)),m(t);let l=(0,O.gh)(t||{type:e.type,value:null},n,r,a,i??void 0);o(l?.searchModelType??null),h(s,A.uH.FILES,l,c,!1,!1)},[e,r,_,n,a,c,h,i,s,m,o])}var N=r(645569);let L="facet_pills--type---RCNh";function M({previewIsShown:e}){let t=(0,d.md)(E.L8),r=(0,d.md)(E.rG);return(0,a.jsx)(a.Fragment,{children:t.map((t,n)=>(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(W,{facet:t,index:n,isActive:(0,R.c2)(t,r),previewIsShown:e},`pill-${n}`):(0,a.jsx)(D,{facet:t,index:n,isActive:(0,R.c2)(t,r)},`pill-${n}`))})}function W({facet:e,index:t,isActive:r,previewIsShown:n}){let i=l.useRef(null),o=(0,d.md)(E.L8),s=(0,d.Xr)(E.rG),c=j(e),u=(0,O.gl)(e.type),p=(0,O.FR)(e),_=(0,S.k)(),f=l.useCallback(t=>{r?(s(null),i.current?.blur()):(t.stopPropagation(),s(e),i.current?.focus())},[e,r,s]),m=l.useCallback(n=>{r&&(("Backspace"===n.key||"Delete"===n.key)&&(c(),_((0,O.oM)(e),A.jD.PILL,A.uR.AUTOCOMPLETE)),"ArrowLeft"===n.key&&t>0&&s(o[t-1]),"ArrowRight"===n.key&&(t<o.length-1?s(o[t+1]):s(null)))},[o,t,r,c,s,_,e]),h=l.useCallback(e=>{n&&f(e)},[n,f]);return l.useEffect(()=>{r&&i.current?.focus()},[r]),(0,a.jsx)("span",{className:r?"facet_pills--activePill--ujE04 facet_pills--pill--11FPS faceted_search_bar--activePill--5IYCE":"facet_pills--pill--11FPS",children:(0,a.jsxs)(k.v,{variant:"primary",selected:r,hasCloseButton:!0,onKeyDown:m,onMouseDown:h,tabIndex:0,ref:i,onClose:c,children:[(0,a.jsx)("span",{className:L,children:u}),p]})})}function D({facet:e,index:t,isActive:r}){let n=l.useRef(null),o=(0,i.d4)(e=>e.modalShown?.type===N.R),s=(0,d.md)(E.L8),c=(0,d.Xr)(E.rG),u=j(e),p=(0,O.gl)(e.type),_=(0,O.FR)(e),f=(0,S.k)(),m=l.useCallback(t=>{r?(c(null),n.current?.blur()):(t.stopPropagation(),c(e),n.current?.focus())},[e,r,c]),h=l.useCallback(n=>{r&&(("Backspace"===n.key||"Delete"===n.key)&&(u(),f((0,O.oM)(e),A.jD.PILL,A.uR.AUTOCOMPLETE)),"ArrowLeft"===n.key&&t>0&&c(s[t-1]),"ArrowRight"===n.key&&(t<s.length-1?c(s[t+1]):c(null)))},[s,t,r,u,c,f,e]),y=l.useCallback(e=>{o&&m(e)},[o,m]);return l.useEffect(()=>{r&&n.current?.focus()},[r]),(0,a.jsxs)("button",{className:r?"facet_pills--activePill_DEPRECATED--8WzJB facet_pills--pill_DEPRECATED--x5yCZ faceted_search_bar--activePill--5IYCE":"facet_pills--pill_DEPRECATED--x5yCZ",onKeyDown:h,onMouseDown:y,ref:n,children:[(0,a.jsx)("span",{className:L,children:p}),_]})}var B=r(548735),U=r(87557),K=((n=K||{}).TYPE="TYPE",n.TYPE_AND_VALUES="TYPE_AND_VALUES",n);let V=(0,d.eU)([]),H=(0,d.eU)(e=>e(V),(e,t,r)=>{t(V,r)}),Y=(0,d.eU)(e=>{let t=e(E.L8),r=e(E.zD),n=e(C.Q8),a=e(C.BA),l=G(t,r);if(n.length<2||0===l.length||a)return null;for(let e of l){let t=X((0,O.qM)(e)+":"),r=X(n,!0).lastIndexOf(t);if(r>=0)return{suggestionType:"TYPE",facetType:e,facetTypeIndex:r,valueToQuery:n.slice(r+t.length).trim()};let a=X(n).split(" ").pop();if(a&&Q(a,t))return{suggestionType:"TYPE",facetType:e,facetTypeIndex:n.lastIndexOf(a),valueToQuery:null}}return null}),z=(0,d.eU)(e=>{let t=e(Y);if(!t||null==t.valueToQuery)return null;let r=t.valueToQuery;if(t.facetType===A.WY.RESOURCE){let n=e(E._4),a=n.map(O.S2),l=[];return(n.forEach((e,t)=>{Q(r,a[t])&&l.push(e)}),0===l.length)?null:{suggestionType:"TYPE_AND_VALUES",facetType:A.WY.RESOURCE,facetTypeIndex:t.facetTypeIndex,facetValues:l.slice(0,6)}}let n=e(H);if(0===n.length)return null;if(t.facetType===A.WY.CREATOR){let r=(0,U.nv)(n,A.dC.USERS);if(0===r.length)return null;let a=e(E.J),l=a?.value||[],i=r.filter(e=>!(0,R.Jj)(l,e)).slice(0,5);if(0===i.length)return null;let o=i.map(e=>({type:A.WY.CREATOR,value:e}));return{suggestionType:"TYPE_AND_VALUES",facetType:A.WY.CREATOR,facetTypeIndex:t.facetTypeIndex,facetValues:o}}if(t.facetType===A.WY.SPACE){let r=e(E.P_),a=e(E.q$),l=[];if(a.includes(A.qy.FOLDER)){let e=r?.value?.folders||[],t=(0,U.nv)(n,A.dC.PROJECTS).slice(0,5).filter(t=>!(0,R.Jj)(e,t)).map(e=>({type:A.WY.SPACE,spaceType:A.qy.FOLDER,value:e}));l.push(...t)}if(a.includes(A.qy.TEAM)){let e=r?.value?.teams||[],t=(0,U.nv)(n,A.dC.TEAMS).slice(0,5).filter(t=>!(0,R.Jj)(e,t)).map(e=>({type:A.WY.SPACE,spaceType:A.qy.TEAM,value:e}));l.push(...t)}if(a.includes(A.qy.ORG)){let e=r?.value?.orgs||[],t=(0,U.nv)(n,A.dC.ORGS).slice(0,5).filter(t=>!(0,R.Jj)(e,t)).map(e=>({type:A.WY.SPACE,spaceType:A.qy.ORG,value:e}));l.push(...t)}return 0===l.length?null:{suggestionType:"TYPE_AND_VALUES",facetType:A.WY.SPACE,facetTypeIndex:t.facetTypeIndex,facetValues:l.slice(0,5)}}return null}),$=(0,d.eU)(e=>{let t=e(Y);return e(z)||t}),q=(0,d.eU)(null);function G(e,t){let r=new Set(t);(0,O.sd)(A.WY.RESOURCE,e)&&r.delete(A.WY.RESOURCE);let n=0,a=0;for(let t of e)t.type===A.WY.CREATOR&&n++,t.type===A.WY.SPACE&&a++;return n>=O.hp&&r.delete(A.WY.CREATOR),a>=O.hp&&r.delete(A.WY.SPACE),Array.from(r)}let Q=(e,t)=>X(t).startsWith(X(e)),X=(e,t)=>t?e.toLocaleLowerCase():e.toLocaleLowerCase().trim().replace(/\s+/g," ");var J=r(349114);function Z(){let e=(0,d.Xr)(H),t=(0,d.md)(Y),r=t?.facetType,n=t?.valueToQuery??null,a=(0,J.F)(n,r);l.useEffect(()=>{"loading"===a.status||e(a.data?a.data:[])},[a,e])}function ee({hideSearchPreview:e,autocomplete:t,searchInputRef:r,expanded:n,expandModal:o,collapseModal:s}){let c=(0,i.wA)(),u=(0,h._6)(),p=(0,y.X0)(u),[_,R]=l.useState(!1),k=l.useRef(null),[O,S]=(0,d.fp)(C.Q8),A=(0,d.md)(C.BA),N=(0,d.md)(C.sC),L=(0,d.md)(E.oT),W=(0,d.md)(E.L8),[D,U]=(0,d.fp)(E.rG),K=(0,d.Xr)(E.q4),V=(0,d.md)(f.hO.isFragmentSearchAtom),H=(0,P.y)(V?"fragment_search_modal":p?"desktop_new_tab":"file_browser",N,!0),Y=j(D),{activeValue:z,setActiveValue:$}=l.useContext(B.M),q="[role=option]",G=t?.refs.scroll,Q=l.useCallback(()=>{let e=G?.current,t=e?.querySelector(q);return t?t.id:void 0},[G]),X=l.useCallback(()=>{let e=G?.current,t=e?.querySelectorAll(q);return t?.[t.length-1]?t?.[t.length-1].id:void 0},[G]);Z();let J=l.useCallback(()=>{k.current?.scrollTo({left:k.current.scrollWidth})},[]);l.useEffect(()=>{let e=e=>{e.metaKey&&"/"===e.key&&(r.current?.focus(),J())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[J,r]);let ee=l.useCallback(t=>{S(t.target.value),e||H(t.target.value,A,!1,!1)},[A,H,S,e]),et=l.useCallback(e=>{if(_)return;"Escape"===e.key||"Tab"===e.key?s?.():o?.();let{selectionStart:t,selectionEnd:r}=e.currentTarget,n=0===t&&0===r,a=0===O.trim().length&&0===W.length;if("Enter"===e.key&&void 0===z){if(a)return;H(O,A,!0,!0),V&&s?.()}!A&&(("Backspace"===e.key||"Delete"===e.key)&&n&&(D?Y():U(L)),"ArrowLeft"===e.key&&n&&U(L))},[_,D,A,L,W.length,H,O,Y,U,V,z,s,o]),er=l.useCallback(()=>{S(""),c(m._z({})),K(),A&&(0,y.kV)(u)&&c(T.sf(u.previousView??{view:"recentsAndSharing"}))},[K,c,u,A,S]),en=l.useCallback(e=>{if(e.stopPropagation(),e.preventDefault(),r.current?.focus(),n||o?.(),r.current){let e=r.current.value.length;r.current.setSelectionRange(e,e)}D&&U(null)},[D,U,r,n,o]),ea=l.useCallback(e=>{e.stopPropagation(),e.preventDefault()},[]);l.useEffect(()=>{D||A||!n||(r.current?.focus(),$(void 0))},[D,W,O,A,$,n,r]);let el=0!==W.length,ei=0===O.length&&(!el||A);l.useLayoutEffect(()=>{if(!r||!r.current)return;if(ei){r.current.style.width="calc(100% - 10px)";return}var e=document.createElement("span");e.innerHTML=(0,I.p)(O.replace(/<|>/,"W")),e.style.font="11px Inter",document.body.appendChild(e);let t=e.getBoundingClientRect().width+8;r.current.style.width=`${t}px`,document.body.removeChild(e),J()},[O,J,r,ei]);let eo=!A&&!p,es=l.useMemo(()=>t?.getInputProps({onKeyDown:et,onFocus:o})??{ref:r,onKeyDown:et,onFocus:o},[t,et,r,o]),ed={...es,onKeyDown:l.useCallback(e=>{if("ArrowUp"===e.key&&void 0!==z&&Q()===z)G.current?.scrollTo({top:0}),e.preventDefault(),$(void 0);else{if("ArrowUp"===e.key&&void 0===z||"ArrowDown"===e.key&&void 0!==z&&X()===z)return;es.onKeyDown?.(e)}},[z,Q,X,es,$,G])};return(0,a.jsxs)(b.Y.Root,{className:"faceted_search_bar--searchBar--FO3mb search--searchContainerSidebarWithSelection--nmGHp search--_expandingSearchBoxSidebarContainerBase--C6eb2 search--searchContainerSidebar--WhHk4",onMouseDown:en,onClick:ea,children:[(0,a.jsx)("div",{className:"faceted_search_bar--rightFadeContainer--NFGS6 faceted_search_bar--_fadeContainer--TZ-3N",children:(0,a.jsx)(v.W,{className:"faceted_search_bar--iconWrapper--0xWey","aria-hidden":!0})}),(0,a.jsxs)("div",{className:"faceted_search_bar--clipContainer--LZia-",ref:k,children:[eo&&(0,a.jsx)(M,{previewIsShown:n}),(0,a.jsx)(b.Y,{"aria-label":(0,x.t)("search.search_bar.placeholder_v2"),className:"faceted_search_bar--input--DXi7V","data-testid":"facetedSearchInput",id:"facetedSearchInput",onChange:(e,t)=>ee(t.event),onCompositionEnd:()=>R(!1),onCompositionStart:()=>R(!0),onMouseDown:e=>{e.stopPropagation(),o?.()},placeholder:ei?(0,x.t)("search.search_bar.placeholder_v2"):void 0,spellCheck:!1,value:O,...ed})]}),(!!O||el)&&(0,a.jsx)("div",{className:"faceted_search_bar--leftFadeContainer--CFZP0 faceted_search_bar--_fadeContainer--TZ-3N","data-testid":"facetedSearchClear",children:(0,a.jsx)("div",{className:"faceted_search_bar--clearButtonWrapper--30-gF",children:(0,a.jsx)(g.K,{"aria-label":(0,x.t)("search.search_bar.clear"),"data-tooltip-type":w.Ib.TEXT,"data-tooltip":(0,x.t)("search.search_bar.clear"),onClick:er,actionOnPointerDown:!0,children:(0,a.jsx)(F.X,{})})})})]})}var et=r(859978),er=r(224542),en=r.n(er),ea=r(295815),el=r(584376),ei=r(692851),eo=r(38900),es=r(928814);function ed({hideSearchPreview:e}){let t=(0,i.wA)(),r=(0,h._6)(),n=(0,y.X0)(r),[o,c]=l.useState(!1),u=l.useRef(null),p=l.useRef(null),[_,b]=(0,d.fp)(C.Q8),R=(0,d.md)(C.BA),k=(0,d.md)(C.sC),O=(0,d.md)(E.oT),S=(0,d.md)(E.L8),[A,N]=(0,d.fp)(E.rG),L=(0,d.Xr)(E.q4),W=(0,d.md)(f.hO.isFragmentSearchAtom),D=(0,P.y)(W?"fragment_search_modal":n?"desktop_new_tab":"file_browser",k,!0),B=j(A);Z();let{setKeyboardNavigationElement:U,keyboardNavigationItem:K,isFocused:V,isFauxFocused:H}=(0,el.M3)({id:"faceted-search-bar",path:[0]});(0,s.h)(()=>{u.current&&U?.(u.current)});let Y=l.useCallback(()=>{p.current?.scrollTo({left:p.current.scrollWidth})},[]);l.useEffect(()=>{let e=e=>{e.metaKey&&"/"===e.key&&(K?.focus(),K?.fauxFocus(),Y())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[K,Y]);let z=l.useCallback(t=>{b(t.target.value),e||D(t.target.value,R,!1,!1)},[R,D,b,e]),$=l.useCallback(e=>{if(o)return;let{selectionStart:r,selectionEnd:n}=e.currentTarget,a=0===r&&0===n,l=0===_.trim().length&&0===S.length;if("Enter"===e.key&&H){if(l)return;D(_,R,!0,!0),W&&t(eo.Lo())}!R&&(("Backspace"===e.key||"Delete"===e.key)&&a&&(A?B():N(O)),"ArrowLeft"===e.key&&a&&N(O))},[H,S.length,o,A,R,O,D,_,B,N,W,t]),q=l.useCallback(()=>{b(""),t(m._z({})),L(),R&&(0,y.kV)(r)&&t(T.sf(r.previousView??{view:"recentsAndSharing"}))},[L,t,r,R,b]),G=l.useCallback(e=>{if(e.stopPropagation(),e.preventDefault(),K?.focus(),K?.fauxFocus(),u.current){let e=u.current.value.length;u.current.setSelectionRange(e,e)}A&&N(null)},[A,K,N]),Q=l.useCallback(e=>{e.stopPropagation(),e.preventDefault()},[]);l.useEffect(()=>{V&&(K?.focus(),K?.fauxFocus(),Y(),t(m.W0({entryPoint:W?"fragment_search_modal":"file_browser"})))},[t,V,K,Y,W]),l.useEffect(()=>{A||R||(K?.focus(),K?.fauxFocus())},[A,S,K,_,R]);let X=0!==S.length,J=0===_.length&&(!X||R);l.useLayoutEffect(()=>{if(!u||!u.current)return;if(J){u.current.style.width="calc(100% - 10px)";return}var e=document.createElement("span");e.innerHTML=(0,I.p)(_.replace(/<|>/,"W")),e.style.font="11px Inter",document.body.appendChild(e);let t=e.getBoundingClientRect().width+8;u.current.style.width=`${t}px`,document.body.removeChild(e),Y()},[_,Y,u,J]);let ee=!R&&!n;return(0,a.jsxs)("div",{className:"faceted_search_bar_deprecated--searchBar--NATRa search--searchContainerSidebarWithSelection--nmGHp search--_expandingSearchBoxSidebarContainerBase--C6eb2 search--searchContainerSidebar--WhHk4",onMouseDown:G,onClick:Q,role:"button",tabIndex:0,children:[(0,a.jsx)("div",{className:"faceted_search_bar_deprecated--rightFadeContainer--MfSDN faceted_search_bar_deprecated--_fadeContainer--JLh32",children:(0,a.jsx)(v.W,{className:"faceted_search_bar_deprecated--iconWrapper--Ej1Tq"})}),(0,a.jsxs)("div",{className:"faceted_search_bar_deprecated--clipContainer--vGZa5",ref:p,children:[ee&&(0,a.jsx)(M,{}),(0,a.jsx)(ei.i,{ref:u,autoFocus:!0,className:"faceted_search_bar_deprecated--input--OUQ1l","data-testid":"facetedSearchInput",onChange:z,onCompositionEnd:()=>c(!1),onCompositionStart:()=>c(!0),onKeyDown:$,onMouseDown:es.dG,placeholder:J?(0,x.t)("search.search_bar.placeholder_v2"):void 0,spellCheck:"false",value:_})]}),(!!_||X)&&(0,a.jsx)("div",{className:"faceted_search_bar_deprecated--leftFadeContainer--IcGj- faceted_search_bar_deprecated--_fadeContainer--JLh32","data-testid":"facetedSearchClear",children:(0,a.jsx)(g.K,{"aria-label":(0,x.t)("search.search_bar.clear"),onClick:q,"data-tooltip-type":w.Ib.TEXT,"data-tooltip":(0,x.t)("search.search_bar.clear"),children:(0,a.jsx)(F.X,{})})})]})}var ec=r(559055),eu=r(86057),ep=r(936652),e_=r(754305),ef=r(56967),em=r(493094),eh=r(758336),ey=r(784195),eE=r(644350),eb=r(141363),eg=r(352870),ev=r(436174),eF=r(140979),ex=r(198788),eI=r(883652),eT=r(801236),ew=r(30223),eR=r(738109),ek=r(832763),eO=r(57551),eS=r(745463),eC=r(739565),eA=r(878521),eP=r(170793),ej=r(837487);let eN=l.createContext("PREVIEW");function eL({href:e,icon:t,id:r,path:n,text:o,breadcrumbElement:s,disableRecentSearchOnClick:c,onClickCallback:u,onContextMenuCallback:p,onKeyEnterCallback:_,sideElement:f,sideElementAlwaysVisible:h,rowStyle:y,rowHeight:E,textToHighlight:b,trackInteraction:g,elementBesideName:v}){let F=(0,eS.sR)(l.useContext(eN),"Must use `FacetedSearchPreviewRowBase` inside `<SearchRowContext.Provider>"),x=(0,i.wA)(),I=(0,d.md)(C.Q8),T=(0,i.d4)(e=>e.currentUserOrgId),w=(0,eh.S)(T)?.searches,{setKeyboardNavigationElement:R,isFauxFocused:k}=(0,el.M3)({id:r,path:n}),O=l.useCallback(()=>{I&&!c&&x(m.nG({searchQuery:I,previousSearches:w})),g?.(ec.vj.Query.ClickAction.CLICK)},[c,x,w,I,g]),S=l.useCallback(e=>{O(),u?.(e)},[O,u]),A=l.useCallback(e=>{1===e.button&&(O(),u?.(e))},[O,u]),P=l.useCallback(e=>{"Enter"===e.key&&(g?.(ec.vj.Query.ClickAction.ENTER),_?.(e))},[_,g]),j=l.useCallback(e=>{p?.(e)},[p]);return(0,a.jsx)(eC.o,{eventListeners:["onClick","onMouseDown"],children:(0,a.jsx)(eA.N,{href:e??"",onContextMenu:j,onKeyDown:P,onAuxClick:A,tabIndex:0,onClick:S,ref:R,children:(0,a.jsxs)("div",{className:en()(ej.nM,{[ej._O]:"BRAND"===y,[ej.iJ]:"BRAND_HOVER"===y,[ej.fc]:"SHORT"===E,[ej.Hi]:k}),children:[(0,a.jsxs)("div",{className:ej.aU,tabIndex:-1,children:[t&&(0,a.jsx)("div",{className:en()(ej.Kk,{[ej.L0]:"CHECKBOX"===y}),children:t}),(0,a.jsxs)("div",{className:en()(ej.FS,{[ej.y4]:!t,[ej.JX]:"BRAND"===y||"BRAND_HOVER"===y,[ej.b3]:"DROPDOWN"===F,[ej.P6]:"CHECKBOX"===y}),children:[(0,a.jsxs)("div",{className:ej.mX,children:[(0,a.jsx)("div",{className:ej.h5,children:b?(0,a.jsx)(eP.f,{text:o,query:b}):(0,a.jsx)(a.Fragment,{children:o})}),!!v&&v]}),!!s&&(0,a.jsx)("div",{className:ej.QF,children:s})]})]}),!!f&&(0,a.jsx)("div",{className:en()({[ej.qZ]:!h,[ej.PQ]:h,[ej.eF]:"CHECKBOX"===y,[ej.Hi]:k}),tabIndex:-1,children:f})]})})})}function eM({leftElement:e,rightElement:t}){return(0,a.jsxs)("div",{className:"faceted_search_preview_row_breadcrumb--breadcrumbContainer--iSL-F text--fontPos11--rO47d text--_fontBase--VaHfk",children:[(0,a.jsx)("span",{className:"faceted_search_preview_row_breadcrumb--ellipsis--Xxf2x ellipsis--ellipsis--70pHK",children:e}),!!e&&!!t&&(0,a.jsx)("span",{className:"faceted_search_preview_row_breadcrumb--dot--aW3BF",children:"\xb7"}),(0,a.jsx)("span",{children:t})]})}function eW({fileResult:e,id:t,path:r,position:n,onContextMenuCallback:s,collapseModal:c}){let u=(0,i.wA)(),p=(0,i.d4)(e=>e.currentUserOrgId||void 0),_=(0,i.d4)(e=>e.currentTeamId),f=(0,i.d4)(e=>e.user),m=(0,i.d4)(e=>e.search.sessionId),y=(0,d.md)(C.Q),E=(0,eT.$E)(),b=(0,h._6)(),g=(0,U.EN)(e),v=g?e.model:e,F=g?e:v,{data:x}=(0,eF.bc)((0,eE.yf7)(v.folder_id?{projectId:v.folder_id}:null)),I=x?.project?.path??"",T=(0,U.AR)(v,f,p,_,b),w=(0,ew.GT)(T,n,g?e:void 0),{Sprig:R}=(0,ex.A)(),k=(0,eR.v)(),O=l.useCallback(()=>{(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(c?.(),k((0,ek.fA)(v))):(u(eo.AS()),(0,U.K4)(u,v,p??null,_,f,R))},[p,_,f,u,v,k,R,c]),S=l.useCallback(e=>{e.preventDefault(),(0,o.getFeatureFlags)().file_browser_sentiment_survey&&R("setAttribute","fb_file_opened",!0),(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?k((0,ek.fA)(v),e):e.metaKey||1===e.button?ev.Ay.redirect(T,"_blank"):O()},[T,O,v,k,R]),A=l.useCallback(e=>{e.preventDefault(),(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(c?.(),k((0,ek.fA)(v),e)):(u(eo.AS()),(0,U.K4)(u,v,p??null,_,f,R))},[p,_,f,u,v,k,R,c]),P=l.useCallback(e=>{s({index:0,data:F,canAccessFileResultFolder:!!I},e)},[F,I,s]),j=l.useCallback(t=>{g?w(t):ec.vj.Recents.trackRecentsClick(m,n,e.key,ec.vj.RecentType.FILE)},[e,g,n,m,w]),N=E(v);return(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(eO.cr,{breadcrumbElement:(0,a.jsx)(eD,{file:v,folderName:I}),icon:(0,a.jsx)(eT.w4,{size:16,type:N}),id:t,onClickCallback:S,onContextMenuCallback:P,onSelectCallback:O,text:v.name,textToHighlight:y,trackInteraction:j}):(0,a.jsx)(eL,{breadcrumbElement:(0,a.jsx)(eD,{file:v,folderName:I}),icon:(0,a.jsx)(eT.w4,{size:16,type:N}),id:t,onClickCallback:S,onContextMenuCallback:P,onKeyEnterCallback:A,path:r,text:v.name,textToHighlight:y,trackInteraction:j})}function eD({file:e,folderName:t}){let r=e.touched_at?(0,x.tx)("search.preview_item.edited_from_now",{relativeTimeString:(0,a.jsx)(eI.h1,{date:e.touched_at,style:"narrow"})}):null;return(0,a.jsx)(eM,{leftElement:t||null,rightElement:r})}var eB=r(635618),eU=r(211573),eK=r(824234),eV=r(19264);function eH({id:e,path:t,position:r,recentSearch:n}){let s=(0,i.wA)(),c=(0,h._6)(),u=(0,y.X0)(c)?"desktop_new_tab":"file_browser",p=(0,d.Xr)(C.Q8),_=(0,d.md)(C.sC),f=(0,d.md)(C.R9),b=(0,d.md)(E.CZ),v=(0,i.d4)(e=>e.currentUserOrgId||null),F=(0,i.d4)(e=>e.search.sessionId),I=(0,eh.S)(v)?.searches,T=l.useCallback(()=>{(0,y.X0)(c)&&s(m.Rz({query:n.query,searchScope:_,searchModelType:A.uH.FILES})),s(m.Dy({entryPoint:u})),p(n.query),(0,U.Yb)(s,c,u,n.query,_,f??A.uH.FILES,!0,b),s(eo.AS())},[s,u,b,n.query,f,_,c,p]),w=l.useCallback(e=>{if(e.preventDefault(),e.metaKey){(0,y.X0)(c)&&s(m.Rz({query:n.query,searchScope:_,searchModelType:A.uH.FILES}));let e=(0,U.XW)(n.query,v,f??A.uH.FILES);ev.Ay.redirect(e,"_blank")}else T()},[c,s,T,n.query,_,v,f]),R=l.useCallback(e=>{e.stopPropagation(),e.preventDefault(),s(m.uL({orgId:v,searchQuery:n.query,previousSearches:I}))},[v,s,I,n.query]),k=l.useCallback(()=>{ec.vj.Recents.trackRecentsClick(F,r,null,ec.vj.RecentType.SEARCH)},[r,F]),O=(0,a.jsx)("div",{className:"faceted_search_preview_recent_row--clearButton--BwAYl raw_components--iconButtonEnabled--dC-EG raw_components--_iconButton--aCldD",children:(0,a.jsx)(g.K,{"aria-label":(0,x.t)("search.search_bar.clear"),onClick:R,children:(0,a.jsx)(eB.A,{})})});return(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(eO.cr,{icon:(0,a.jsx)(eU.R,{}),id:e,text:n.query,onClickCallback:w,onSelectCallback:T,sideElement:O,trackInteraction:k}):(0,a.jsx)(eL,{icon:(0,a.jsx)(eK.B,{className:"faceted_search_preview_recent_row--icon--NNpnj",svg:eV.A}),id:e,path:t,text:n.query,onClickCallback:w,sideElement:O,trackInteraction:k})}function eY({id:e,path:t,collapseModal:r}){let n=(0,i.d4)(e=>e.currentUserOrgId),o=(0,eh.S)(n),s=o.searches.slice(0,A.Or),d=A.MU-s.length,c=function(){let[e]=(0,em.IT)((0,eE.MAl)({})),t=l.useMemo(()=>e.transform(e=>(0,eb.YN)(e.currentUser.recentFiles)),[e]);return l.useEffect(()=>{"loaded"===t.status&&(0,ef.Wn)(t.data)},[t]),l.useMemo(()=>t.transform(e=>e.recent_files),[t])}(),u=c?.data?.slice(0,d)||[];return"loaded"!==c.status||"loaded"!==o.status?(0,a.jsx)(eg.e,{numRows:A.MU}):(0,a.jsxs)(a.Fragment,{children:[s.length+u.length>0&&(0,a.jsx)("div",{className:"faceted_search_preview_recents--header--eCXyq",children:(0,x.tx)("search.preview_section.recent")}),s.map((r,n)=>{let l=`${e}-recent-search-${n}`;return(0,a.jsx)(eH,{id:l,path:[...t,0,n],position:n,recentSearch:r},l)}),(0,a.jsx)(ey.Q0,{isDropdown:!0,children:(0,a.jsx)(ey.kq.Consumer,{children:n=>(0,a.jsx)(a.Fragment,{children:u.map((l,i)=>{let o=`${e}-recent-file-${i}`,d=s.length+i;return(0,a.jsx)(eW,{fileResult:l,id:o,path:[...t,1,i],position:d,onContextMenuCallback:n.onContextMenuClick,collapseModal:r},o)})})})})]})}var ez=r(273313),e$=r(419450),eq=r(689024),eG=r(328403),eQ=r(11637);function eX({folderResult:e,id:t,path:r,position:n,onContextMenuCallback:s,collapseModal:c}){let u=(0,i.wA)(),p=(0,d.md)(C.Q8),_=(0,U.uF)(e.model),f=(0,ew.GT)(_,n,e),m=(0,eG.EB)(),h=l.useCallback(()=>{(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(c?.(),m(e.model.id)):(u(eo.AS()),(0,U.NE)(u,e.model))},[u,e,m,c]),y=l.useCallback(t=>{t.preventDefault(),(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(t.metaKey||1===t.button||c?.(),m(e.model.id,t)):t.metaKey||1===t.button?ev.Ay.redirect(_,"_blank"):h()},[_,h,e.model.id,m,c]),E=l.useCallback(t=>{t.preventDefault(),(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(c?.(),m(e.model.id,t)):(u(eo.AS()),(0,U.NE)(u,e.model))},[u,e,m,c]),b=l.useCallback(t=>{s({index:0,data:e},t)},[e,s]);return(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(eO.cr,{breadcrumbElement:(0,a.jsx)(eJ,{folderResult:e}),elementBesideName:e.model.is_connected_project?(0,a.jsx)(eq.W,{}):void 0,icon:(0,a.jsx)(e$.J,{}),id:t,onClickCallback:y,onContextMenuCallback:b,onSelectCallback:h,text:e.model.name,textToHighlight:p,trackInteraction:f}):(0,a.jsx)(eL,{breadcrumbElement:(0,a.jsx)(eJ,{folderResult:e}),elementBesideName:e.model.is_connected_project?(0,a.jsx)(eq.W,{}):void 0,icon:(0,a.jsx)(eK.B,{className:"faceted_search_preview_folder_row--icon--DDefz",svg:eQ.A}),id:t,onClickCallback:y,onContextMenuCallback:b,onKeyEnterCallback:E,path:r,text:e.model.name,textToHighlight:p,trackInteraction:f})}function eJ({folderResult:e}){let{data:t}=(0,eF.bc)(eE.sn$,{teamId:e.model.team_id??""},{enabled:!!e.model.team_id}),r=t?.team?.name||"",n=r?(0,x.tx)("search.preview_item.in_team",{teamName:r}):null,l=(0,x.tx)("search.preview_item.num_files_in_project",{fileCount:e.file_count});return(0,a.jsx)(eM,{leftElement:n,rightElement:l})}var eZ=r(412427),e0=r(9348);function e1({teamResult:e,id:t,path:r,position:n,onContextMenuCallback:s,collapseModal:c}){let u=(0,i.wA)(),p=(0,d.md)(C.Q),_=(0,U.Xx)(e.model),f=(0,ew.GT)(_,n,e),m=(0,e0.lo)(),h=l.useCallback(()=>{(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(c?.(),m(e.model)):(u(eo.AS()),(0,U.e_)(u,e.model))},[u,e,m,c]),y=l.useCallback(t=>{t.preventDefault(),(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(t.metaKey||1===t.button||c?.(),m(e.model,t)):t.metaKey||1===t.button?ev.Ay.redirect(_,"_blank"):h()},[_,h,e,m,c]),E=l.useCallback(t=>{t.preventDefault(),(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(c?.(),m(e.model,t)):(u(eo.AS()),(0,U.e_)(u,e.model))},[u,e,m,c]),b=l.useCallback(t=>{s({index:0,data:e},t)},[s,e]);return(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(eO.cr,{breadcrumbElement:(0,a.jsx)(e5,{teamResult:e}),icon:(0,a.jsx)(eZ.nl,{team:e.model,size:eZ.Pf.MEDIUM}),id:t,onClickCallback:y,onContextMenuCallback:b,onSelectCallback:h,text:e.model.name,textToHighlight:p,trackInteraction:f}):(0,a.jsx)(eL,{breadcrumbElement:(0,a.jsx)(e5,{teamResult:e}),icon:(0,a.jsx)(eZ.nl,{team:e.model,size:eZ.Pf.MEDIUM}),id:t,onClickCallback:y,onContextMenuCallback:b,onKeyEnterCallback:E,path:r,text:e.model.name,textToHighlight:p,trackInteraction:f})}function e5({teamResult:e}){let t=(0,i.d4)(t=>t.teams[e.model.id]),r=(0,x.tx)("search.preview_item.num_members_in_team",{memberCount:e.member_count}),n=t?(0,x.tx)("search.preview_item.num_projects_in_team",{projectCount:t.projects??0}):null;return(0,a.jsx)(eM,{leftElement:r,rightElement:n})}var e4=r(275262),e6=r(848594),e2=r(69806);function e8({id:e,path:t,position:r,userResult:n,onContextMenuCallback:s,collapseModal:c}){let u=(0,i.wA)(),p=(0,d.md)(C.Q),_=(0,i.d4)(e=>e.currentUserOrgId||void 0),f=(0,i.d4)(e=>e.orgById),m=(0,e6.t)(n.model,_),h=(0,ew.GT)(m,r,n),y=(0,e4.y)(),E=l.useCallback(()=>{(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(c?.(),y(n.model)):(u(eo.AS()),(0,U.KL)(u,n.model))},[u,n,y,c]),b=l.useCallback(e=>{e.preventDefault(),(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(e.metaKey||1===e.button||c?.(),y(n.model,e)):e.metaKey||1===e.button?ev.Ay.redirect(m,"_blank"):E()},[m,E,n,y,c]),g=l.useCallback(e=>{e.preventDefault(),(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(c?.(),y(n.model,e)):(u(eo.AS()),(0,U.KL)(u,n.model))},[u,n,y,c]),v=l.useCallback(e=>{s({index:0,data:n},e)},[s,n]),F=n.model.org_id&&f[n.model.org_id]||null,I=(0,a.jsxs)("div",{className:"faceted_search_preview_user_row--iconContainer--qq0UZ",children:[(0,a.jsx)(eZ.H8,{user:n.model,size:eZ.Pf.MEDIUM}),F&&(0,a.jsx)("div",{className:"faceted_search_preview_user_row--planIcon--YZqvT",children:(0,a.jsx)(e2.H,{entityId:F.id,entityName:F.name,imgUrl:F.img_url,size:10})})]});return(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(eO.cr,{breadcrumbElement:n.last_active_at?(0,x.tx)("search.preview_item.active_from_now",{relativeTimeString:(0,a.jsx)(eI.h1,{date:n.last_active_at,style:"narrow"})}):void 0,icon:I,id:e,onClickCallback:b,onContextMenuCallback:v,onSelectCallback:E,text:n.model.name||n.model.handle,textToHighlight:p,trackInteraction:h}):(0,a.jsx)(eL,{icon:I,id:e,onClickCallback:b,onContextMenuCallback:v,onKeyEnterCallback:g,path:t,text:n.model.name||n.model.handle,textToHighlight:p,trackInteraction:h})}var e3=r(402631),e7=r(611100),e9=r(302789),te=r(767713),tt=r(478499),tr=r(519668);function tn({onSearch:e,id:t,path:r,showResultsForModelType:n}){let i=(0,d.md)(C.Q8),s=(0,d.md)(E.jM),c=n&&s?(0,A.Xr)(s):null,u=l.useCallback(()=>{e(i,!1,!0,!0)},[i,e]),p=l.useCallback(e=>{e.preventDefault(),e.metaKey||u()},[u]),_=l.useMemo(()=>{if((0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration)switch(c){case A.uH.FILES:return(0,a.jsx)(e3.p,{});case A.uH.PROJECTS:return(0,a.jsx)(e7.e,{});case A.uH.TEAMS:return(0,a.jsx)(e9.b,{});case A.uH.USERS:return(0,a.jsx)(te.j,{});default:return(0,a.jsx)(v.W,{})}switch(c){case A.uH.FILES:return(0,a.jsx)(tt.In,{icon:"page-16",fill:"brand"});case A.uH.PROJECTS:return(0,a.jsx)(tt.In,{icon:"folder-16",fill:"brand"});case A.uH.TEAMS:return(0,a.jsx)(tt.In,{icon:"team-16",fill:"brand"});case A.uH.USERS:return(0,a.jsx)(eK.B,{svg:tr.A,className:"faceted_search_see_all_results--icon--nYbNU"});default:return(0,a.jsx)(tt.In,{icon:"search-32",fill:"brand"})}},[c]),f=l.useMemo(()=>{switch(c){case A.uH.FILES:return(0,x.t)("search.facet_preview_section.see_more_files");case A.uH.PROJECTS:return(0,x.t)("search.facet_preview_section.see_more_projects");case A.uH.TEAMS:return(0,x.t)("search.facet_preview_section.see_more_teams");case A.uH.USERS:return(0,x.t)("search.facet_preview_section.see_more_users");default:return(0,x.t)("search.preview_section.see_all_results")}},[c]);return(0,a.jsx)("div",{className:"faceted_search_see_all_results--container--LPor3",onContextMenu:es.wo,children:(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(eO.cr,{icon:_,id:t,onClickCallback:p,onSelectCallback:u,rowStyle:eO.yY.BRAND_HOVER,rowHeight:eO.CO.SHORT,text:f}):(0,a.jsx)(eL,{icon:_,id:t,onClickCallback:p,path:r,rowStyle:eO.yY.BRAND_HOVER,rowHeight:eO.CO.SHORT,text:f})})}let ta="faceted_search_preview_results--emptyState--zuAcX";function tl({id:e,path:t,collapseModal:r}){let n=(0,o.getFeatureFlags)().search_preview_results_livestore?ez.lN:ez.KU,i=(0,d.md)(E.jM),s=(0,d.md)(C.ih),c=(0,d.md)(E.CZ),u=(0,d.md)(C.Q),p=(0,A.Xr)(i),_=(0,d.md)(C.sC),f=(0,h._6)(),m=(0,y.X0)(f)?"desktop_new_tab":"file_browser",b=(0,P.y)(m,_,!0),g=n(),v=l.useMemo(()=>g.data?.searchPreviewOrder??[],[g.data?.searchPreviewOrder]),F=l.useMemo(()=>g.data?.searchResults??{},[g.data?.searchResults]),I=l.useMemo(()=>!g.status||"loading"===g.status||!(0,R.c2)(s,c),[g.status,s,c]),T=l.useMemo(()=>{if(!F)return!1;for(let e of v){let t=F[e]?.results;if(t&&t.length>0)return!1}return!0},[v,F]);return(0,O.GX)(u)?(0,a.jsx)("div",{className:ta,children:(0,x.tx)("search.error.max_query_length_exceeded")}):I?(0,a.jsx)(eg.e,{numRows:7}):T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:ta,"data-testid":"facetedSearchNoResults",children:u?p?(0,a.jsxs)(a.Fragment,{children:[(0,A.hf)(p),"\xa0",(0,a.jsx)("span",{children:u})]}):(0,x.tx)("search.empty_state.no_file_project_team_or_people_results",{searchQuery:u}):(0,x.tx)("search.zero_state.empty_state")}),(0,a.jsx)(tn,{id:e,path:t,onSearch:b})]}):(0,a.jsx)(ey.Q0,{isDropdown:!0,children:(0,a.jsx)(ey.kq.Consumer,{children:n=>(0,a.jsxs)(a.Fragment,{children:[v.map((i,o)=>{let s=F[i]?.results;return s&&0!==s.length?(0,a.jsxs)(l.Fragment,{children:[v.length>1&&(0,a.jsx)("div",{className:"faceted_search_preview_results--header--sS4dy faceted_search_preview_recents--header--eCXyq",children:(0,A.q6)(i)}),s.map((l,i)=>{if(l.search_model_type===A.uH.FILES){let s=`${e}-file-${i}`;return(0,a.jsx)(eW,{fileResult:l,id:s,path:[...t,0,o,i],position:i,onContextMenuCallback:n.onContextMenuClick,collapseModal:r},s)}if(l.search_model_type===A.uH.PROJECTS){let s=`${e}-folder-${i}`;return(0,a.jsx)(eX,{folderResult:l,id:s,path:[...t,0,o,i],position:i,onContextMenuCallback:n.onContextMenuClick,collapseModal:r},s)}if(l.search_model_type===A.uH.TEAMS){let s=`${e}-team-${i}`;return(0,a.jsx)(e1,{teamResult:l,id:s,path:[...t,0,o,i],position:i,onContextMenuCallback:n.onContextMenuClick,collapseModal:r},s)}if(l.search_model_type===A.uH.USERS){let s=`${e}-user-${i}`;return(0,a.jsx)(e8,{userResult:l,id:s,path:[...t,0,o,i],position:i,onContextMenuCallback:n.onContextMenuClick,collapseModal:r},s)}})]},o):null}),(0,a.jsx)(tn,{id:`${e}-see-all`,path:[...t,1],onSearch:b,showResultsForModelType:!0})]})})})}var ti=r(667243),to=r(181645),ts=r(158016),td=r(426474),tc=r(500391),tu=r(508295),tp=r(523924),t_=r(769060);let tf="faceted_search_preview_suggestion_row--pill--M8GIO",tm="faceted_search_preview_suggestion_row--row--5I2v9",th="faceted_search_preview_suggestion_row--fauxFocus--LXfPz",ty="faceted_search_preview_suggestion_row--hoveredPill--TbBLC",tE="faceted_search_preview_suggestion_row--helpText--Gq-VM",tb="faceted_search_preview_suggestion_row--container--I7wBO",tg="faceted_search_preview_suggestion_row--valueContainer--SczlK";function tv({type:e,value:t,onSelect:r,showHint:n}){let i=(0,d.md)(C.Q8),{activeValue:o}=l.useContext(B.M),s=(e=>{switch(e){case A.WY.RESOURCE:return(0,x.t)("search.facets.filter_by_resource");case A.WY.CREATOR:return(0,x.t)("search.facets.filter_by_creator");case A.WY.SPACE:return(0,x.t)("search.facets.filter_by_space");default:return(0,tp.xb)(e)}})(e),c=l.useId(),u=o===c;return(0,a.jsx)(t_.M.Option,{onSelect:r,value:c,id:c,children:(0,a.jsx)(eC.o,{eventListeners:["onPointerMove"],children:(0,a.jsxs)("div",{className:en()(tm,u&&th),"aria-current":u||void 0,children:[(0,a.jsxs)("div",{className:tb,children:[(0,a.jsx)("div",{className:en()(tf,u&&ty),children:(0,O.gl)(e)}),!!t&&(0,a.jsx)("div",{className:tg,children:(0,a.jsx)(eP.f,{text:t,query:i})})]}),n&&(0,a.jsx)("div",{className:tE,children:s})]})})})}function tF({type:e,value:t,onSelect:r,showHint:n,id:l,path:i}){let o=(0,d.md)(C.Q8),{setKeyboardNavigationElement:s,isFauxFocused:c}=(0,el.M3)({id:l,path:i}),u=(e=>{switch(e){case A.WY.RESOURCE:return(0,x.t)("search.facets.filter_by_resource");case A.WY.CREATOR:return(0,x.t)("search.facets.filter_by_creator");case A.WY.SPACE:return(0,x.t)("search.facets.filter_by_space");default:return""}})(e);return(0,a.jsxs)(et.E,{ref:s,className:en()(tm,"faceted_search_preview_suggestion_row--rowDeprecated--FyjY-",c&&th),"aria-label":u,"aria-current":c||void 0,onClick:r,children:[(0,a.jsxs)("div",{className:tb,children:[(0,a.jsx)("div",{className:en()(tf,c&&ty),children:(0,O.gl)(e)}),!!t&&(0,a.jsx)("div",{className:tg,children:(0,a.jsx)(eP.f,{text:t,query:o})})]}),n&&(0,a.jsx)("div",{className:tE,children:u})]})}function tx({id:e,path:t}){let r=(0,d.md)(E.zD),n=(0,d.md)(E.L8),s=(0,d.md)($),[c,u]=(0,d.fp)(C.Q8),p=(0,tu.iZ)(),_=G(n,r),m=function(){let e=(0,d.md)($),t=(0,d.md)(C.sC),r=(0,d.md)(C.BA),n=(0,d.md)(E.jM),a=(0,d.md)(E.J),i=(0,d.md)(E.P_),[o,s]=(0,d.fp)(C.R9),[c,u]=(0,d.fp)(C.Q8),p=(0,tc.f)(),_=(0,td.n)(),m=(0,d.Xr)((0,E.l4)(e?.facetType??null)),h=(0,d.md)(f.hO.isFragmentSearchAtom),y=(0,P.L)(h?"fragment_search_modal":"file_browser",t,!0),b=l.useCallback(t=>{if(e)if("TYPE_AND_VALUES"===e.suggestionType){let l=e.facetType,o=null==t?e.facetValues[0]:e.facetValues[t],d=l===A.WY.RESOURCE?{type:A.WY.RESOURCE,value:o}:o,p=null;l===A.WY.RESOURCE?p=(0,O.jN)(o):l===A.WY.CREATOR?p=(0,O.C8)(o,O.M2.ADD_TO_GROUP,a):l===A.WY.SPACE&&(p=(0,O.q1)(o,O.M2.ADD_TO_GROUP,i)),m(p);let f=c.slice(0,e.facetTypeIndex);if(u(f),!p)return;let E=(0,O.gh)(p,n,a,i);s(E?.searchModelType??null),h||y(f,A.uH.FILES,E,r,!1,!1),_((0,O.oM)(d),c)}else{let t=c.split(" ").slice(0,-1).join(" "),l=t+(t?" ":"")+(0,O.gl)(e.facetType);u(l);let s=(0,O.nX)(n,a,i,o??void 0);h||y(l,A.uH.FILES,s,r,!1,!1),p(A.uR.AUTOCOMPLETE,e.facetType)}},[e,m,c,u,n,a,i,o,s,y,r,_,p,h]);return l.useMemo(()=>b,[b])}(),h=l.useCallback(e=>{m(e)},[m]),y=l.useCallback((e,t)=>{e.preventDefault(),m(t)},[m]),b=l.useCallback(e=>{let t=(0,O.gl)(e);u(c?c+" "+t:t)},[c,u]),g=l.useCallback((e,t)=>{e.preventDefault();let r=(0,O.gl)(t);u(c?c+" "+r:r)},[c,u]);return(!function(){let e,t,r,n=(0,d.md)($),[a,o]=(0,d.fp)(E.a3),[s,c]=(0,d.fp)(q),u=(0,d.md)(E.wf),p=(0,d.md)(Y),_=p?.valueToQuery??"",f=(e=(0,i.d4)(e=>e.search.sessionId),t=(0,i.d4)(e=>e.search.queryId),r=(0,i.d4)(e=>e.search.parameters.query),n=>{let a={sessionId:e,queryId:t,query:r,facet_entrypoint:A.uR.AUTOCOMPLETE,facet_type:n};(0,to.sx)("facet_type_shown",a)}),m=(0,ti.P)(),h=(0,ts.A)();l.useEffect(()=>{n&&(n.suggestionType===K.TYPE?f(n.facetType):_.length>0&&a!==u&&(o(u),m(_,n.facetType,A.uR.AUTOCOMPLETE))),!n&&s&&h(A.uR.AUTOCOMPLETE,s.facetType),c(n)},[n])}(),s)?s.suggestionType===K.TYPE?(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(tv,{type:s.facetType,value:null,onSelect:h,showHint:!0},s.facetType):(0,a.jsx)(tF,{type:s.facetType,value:null,onSelect:y,showHint:!0,id:`${e}-facet-type`,path:t}):(0,a.jsx)(a.Fragment,{children:s.facetValues.map((r,n)=>{let l,i=((e,t,r)=>{if(t===A.WY.RESOURCE){let t=(0,O.jN)(e);return t?(0,O.yA)(t):""}return t===A.WY.CREATOR||t===A.WY.SPACE?(0,O.FR)(e,r):""})(r,s.facetType,p?.id),d=s.facetType;switch(d){case A.WY.RESOURCE:l=`${d}-${r}`;break;case A.WY.CREATOR:case A.WY.SPACE:l=`${d}-${r.value.id}`;break;default:l=`${d}-${i}`}return(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(tv,{type:d,value:i,onSelect:()=>h(n),showHint:!1},l):(0,a.jsx)(tF,{type:s.facetType,value:i,onSelect:e=>y(e,n),showHint:!1,id:`${e}-facet-type`,path:[...t,n]},n)})}):c||n.length>0?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(a.Fragment,{children:_.map((r,n)=>(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(tv,{type:r,value:null,onSelect:()=>b(r),showHint:!0},`${r}`):(0,a.jsx)(tF,{type:r,value:null,onSelect:e=>g(e,r),showHint:!0,id:`${e}-${n}`,path:[...t,n]},`suggestion-row-${n}`))})}r(526865);let tI=(0,ea.jz)("8px"),tT=(0,ea.jz)("380px"),tw=(0,ea.jz)("48px"),tR=(0,ea.jz)("32px"),tk=(0,ep.Ju)(function(){let e=(0,i.wA)(),t=(0,i.d4)(e=>e.modalShown),r=(0,i.d4)(e=>e.search.sessionId),n=(0,d.md)(C.Q),o=(0,d.md)(E.L8);l.useEffect(()=>()=>{r&&ec.vj.Session.searchModalExit(r)},[r]);let c=l.useCallback(()=>{e(p.ky())},[e]),[u,_]=l.useState(t?.data.topOffset);if((0,s.h)(()=>{if(t?.data.relativePositionRef&&t?.data.resizableObservedRef){let e=new ResizeObserver(()=>{_(t?.data.relativePositionRef.current.getBoundingClientRect().top-tI)});return e.observe(t?.data.resizableObservedRef.current,{box:"border-box"}),()=>e.disconnect()}}),!t)return null;let f=t.data.width??tT,m=t.data.hideFacetFilters??!1,h=t.data.leftOffset,y=t.data.bottomPadding;return(0,a.jsx)(e_.d_,{absolutePosition:{top:u,left:h},"data-testid":"facetedSearchModal",maxHeight:y?`calc(100vh - ${u}px - ${y}px)`:"90vh",minHeight:tR+2*tI,onHide:c,padding:`0 0 ${tI}px 0`,popStack:!0,size:"any",tintedModalBackground:!1,useModalViewScroll:!1,width:`calc(min(${f}px, calc(100vw - 2 * ${tI}px))`,children:(0,a.jsx)(el.dP,{children:(0,a.jsxs)(eO.a3.Provider,{value:eO.Vm.PREVIEW,children:[(0,a.jsx)("div",{style:{margin:tI,width:f-2*tI,maxWidth:`calc(100vw - 4 * ${tI}px)`},children:(0,a.jsx)(ed,{hideSearchPreview:t.data.hideSearchPreview})}),(0,a.jsxs)(eu.P,{maxHeight:y?`calc(100vh - ${u}px - ${y}px - ${tw}px - ${tI}px)`:`calc(80vh - 2 * ${tw}px)`,children:[!m&&(0,a.jsx)(tx,{id:"suggestions",path:[4]}),t.data.hideSearchPreview?null:n||o.length>0?(0,a.jsx)(tl,{id:"search-results",path:[5]}):(0,a.jsx)(eY,{id:"recents",path:[5]})]})]})})})},N.R);var tO=r(231484),tS=r(188481),tC=r(487817),tA=r(948240),tP=r(331850),tj=r(794061);function tN(){let e=(0,i.wA)(),t=(0,tO.UP)();return l.useCallback(async()=>{let r=await (0,tS.Q)((0,tA.mZ)(!0)),n=await (0,tS.Q)((0,tA.Ji)(!0)),a=(0,tP.zQ)(r),l=(0,tP.A8)(n,tC.Xn.MEMBER);e(m.Ns({searchScope:(0,tj.l_)(t,a,l)}))},[e,t])}let tL=(0,ea.jz)("8px");function tM({hideSearchPreview:e,modalPositionRef:t}){let r=(0,i.wA)(),n=(0,i.d4)(e=>e.modalShown),o=(0,h._6)(),c=(0,y.X0)(o),u=tN(),[p,_]=(0,d.fp)(C.Q8),b=(0,d.md)(E.L8),g=l.useRef(null),F=(0,d.Xr)(E.q4),I=l.useCallback(()=>{let a,l,i;if(!g.current||n?.type===N.R)return;let o=g.current.getBoundingClientRect(),s=o.top-tL,d=o.left-tL,u=(0,ea.jz)("380px"),p=!1;c&&(d=void 0,u=(0,ea.jz)("816px"),p=!0,a=(0,ea.jz)("32px"),l=t,i=g),r(eo.to({type:tk,data:{topOffset:s,leftOffset:d,hideSearchPreview:e,width:u,hideFacetFilters:p,resizableObservedRef:l,relativePositionRef:i,bottomPadding:a},showModalsBeneath:!0}))},[n?.type,c,r,e,t]);(0,s.h)(()=>{u()}),l.useEffect(()=>{let e=e=>{e.metaKey&&"/"===e.key&&!n&&I()},t=e=>{"Tab"===e.key&&n?.type===N.R&&r(eo.AS())};return document.addEventListener("keydown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keydown",t)}},[r,n,I]);let T=(0,d.md)(f.hO.isFragmentSearchAtom);if(l.useEffect(()=>{T||"search"===o.view||(r(m._z({})),_(""),F())},[r,o,_,F,T]),l.useEffect(()=>{if(c){let e=()=>{"visible"===document.visibilityState&&(r(m._z({})),_(""),F())};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)}},[F,r,c,_]),"search"===o.view)return(0,a.jsx)("div",{className:"faceted_search_entrypoint_deprecated--fullResultsSearchWrapper--TN-d9",children:(0,a.jsx)(el.dP,{children:(0,a.jsx)(ed,{})})});let w=!c;return(0,a.jsxs)(et.E,{className:en()("faceted_search_entrypoint_deprecated--inputWrapper--V197A search--searchContainerSidebarWithSelection--nmGHp search--_expandingSearchBoxSidebarContainerBase--C6eb2 search--searchContainerSidebar--WhHk4",{"faceted_search_entrypoint_deprecated--isDesktopNewTabSearch--019Zm":c}),onClick:I,onFocus:I,"data-testid":"facetedSearchEntrypoint",ref:g,"aria-label":(0,x.t)("search.search_bar.placeholder_v2"),children:[(0,a.jsx)(v.W,{className:"faceted_search_entrypoint_deprecated--iconWrapper--ZC-MA"}),(0,a.jsxs)("div",{className:"faceted_search_entrypoint_deprecated--contentContainer--5abd1",children:[w&&(0,a.jsx)(M,{}),(0,a.jsx)(ei.i,{className:"faceted_search_entrypoint_deprecated--input--nUU8P faceted_search_bar_deprecated--input--OUQ1l",placeholder:0===b.length?(0,x.t)("search.search_bar.placeholder_v2"):"",value:p})]}),!e&&(0,a.jsx)("div",{className:"faceted_search_entrypoint_deprecated--leftFadeContainer--4t-7q faceted_search_bar_deprecated--leftFadeContainer--IcGj- faceted_search_bar_deprecated--_fadeContainer--JLh32"})]})}function tW({maxHeight:e,modalHideFacetFilters:t,modalHiddenStyles:r,modalExpandedStyles:n,expanded:o,expandModal:s,collapseModal:u}){let p=(0,i.d4)(e=>e.search.sessionId),_=(0,d.md)(C.Q),f=(0,d.md)(E.L8);l.useEffect(()=>()=>{p&&ec.vj.Session.searchModalExit(p)},[p]);let m=l.useRef(null),[h,y]=l.useState(void 0),b=t_.M.useAutocomplete({activeValue:h,onActiveValueChange:y,expanded:o,expandOnFocus:!1});return(0,a.jsx)("div",{"data-testid":"facetedSearchModal",...c.xk(o?tD.facetedSearchModalExpanded:tD.facetedSearchModalHidden,o?n:r),ref:m,children:(0,a.jsx)(eO.a3.Provider,{value:eO.Vm.PREVIEW,children:(0,a.jsxs)(B.M.Provider,{value:{activeValue:h,setActiveValue:y},children:[(0,a.jsx)("div",{...{className:"x1e56ztr xet2fuk x1db2dqx"},children:(0,a.jsx)(ee,{expanded:o,expandModal:s,collapseModal:u,hideSearchPreview:!o,autocomplete:b,searchInputRef:b.refs.input})}),o&&(0,a.jsxs)(t_.M.List,{...b.getListProps({maxHeight:e}),"data-testid":"facetedSearchPreviewList",children:[!t&&(0,a.jsx)(tx,{id:"suggestions",path:[4]}),o?_||f.length>0?(0,a.jsx)(tl,{id:"search-results",path:[5],collapseModal:u}):(0,a.jsx)(eY,{id:"recents",path:[5],collapseModal:u}):null]})]})})})}let tD={facetedSearchModalExpanded:{kVAEAm:"x10l6tqk",k87sOh:"x1v4kod4",kY2c9j:"x1h5zca0",kaIpWk:"x1mxnbhz",krdFHd:null,kfmiAY:null,kVL7Gh:null,kT0f0o:null,kIxVMA:null,ksF3WI:null,kqGeR4:null,kYm2EN:null,kGVxlE:"x1wu5q8a",kWkggS:"x1yjdb4r",kLKAdn:"x1y1aw1k",ks0D6T:"x87tlaw",kGO01o:"xwib8y2",$$css:!0},facetedSearchModalHidden:{kVAEAm:"x1n2onr6",ks0D6T:"x87tlaw",$$css:!0}},tB={kbCHJM:"x2akjr6",kLqNvP:null,kt4wiu:null,kzqmXN:"xzx2ped",$$css:!0},tU={kzqmXN:"xf14fn5",$$css:!0},tK={kzqmXN:"x1j0aogd",$$css:!0};function tV(){let e=(0,i.wA)(),t=(0,h._6)(),r=(0,y.X0)(t),n=tN(),o=(0,d.Xr)(C.Q8),c=l.useRef(null),b=(0,d.Xr)(E.q4),[g,v]=l.useState(!1),F=l.useCallback(()=>{g&&(e(p.ky()),v(!1))},[g,e,v]),x=(0,d.md)(f.hO.isFragmentSearchAtom),I=l.useCallback(()=>{if(!g){v(!0);let t=x?"fragment_search_modal":r?"desktop_new_tab":"file_browser";e(m.W0({entryPoint:t}))}},[g,v,e,x,r]);(0,s.h)(()=>{n()});let T=l.useCallback(()=>{let e=`calc(80vh - 2 * ${_.ID.previewRowHeight})`;if(r){let t=_.ID.bottomPaddingDesktopNewTab;if(c.current){let r=c.current.getBoundingClientRect(),n=`${r.top}px`;e=`calc(100vh - ${n} - ${t} - ${_.ID.previewRowHeight})`}return{maxHeight:e,modalHideFacetFilters:!0,modalBottomPadding:t,modalHiddenStyles:tB,modalExpandedStyles:tB}}return{maxHeight:e,modalHideFacetFilters:!1,modalHiddenStyles:tK,modalExpandedStyles:tU}},[c,r]);l.useEffect(()=>{let e=e=>{e.metaKey&&"/"===e.key&&!g&&(c.current?.focus(),I())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[I,c,g]),l.useEffect(()=>{x||"search"===t.view||(e(m._z({})),o(""),b())},[e,t,o,b,x]),l.useEffect(()=>{if(r){let t=()=>{"visible"===document.visibilityState&&(e(m._z({})),o(""),b(),F(),document.activeElement&&document.activeElement.blur&&document.activeElement.blur())};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)}},[b,e,r,o,F]);let w=l.useRef(null);return"search"===t.view?(g&&v(!1),(0,a.jsx)("div",{...{className:"x1661ufe xdj266r"},children:(0,a.jsx)(ee,{searchInputRef:w})})):(0,a.jsxs)("div",{ref:c,...{0:{className:"x1n2onr6 xzo6umx"},1:{className:"x1n2onr6 xqd9ieg"}}[0|!!r],"data-testid":"facetedSearchEntrypoint",children:[g&&(0,a.jsx)(u.X9,{closeDropdown:F}),(0,a.jsx)(tW,{...T(),expanded:g,expandModal:I,collapseModal:F})]})}function tH({hideSearchPreview:e,modalPositionRef:t}){return(0,o.getFeatureFlags)().file_browser_search_panel_fpl_migration?(0,a.jsx)(tV,{}):(0,a.jsx)(tM,{hideSearchPreview:e,modalPositionRef:t})}},30223(e,t,r){r.d(t,{GT:()=>f,aL:()=>E,db:()=>h,hA:()=>y});var n=r(105652),a=r(645186);if(1464==r.j)var l=r(710127);var i=r(559055),o=r(87557),s=r(928397),d=r(865780),c=r(773201),u=r(508295),p=r(458983);function _(e,t,r,n,a,l,s){let d=(0,o.mv)(e);new i.vj.Analytics(a,{position:t,resource_id:d,resource_type:e.search_model_type.toString(),matched_queries:e.matched_queries,result:e},{plan:s}).click(e.search_model_type,l,{action:n,target:r})}function f(e,t,r){let i=(0,a.wA)(),o=(0,a.d4)(e=>e.search),d=(0,c._6)(),u=(0,a.d4)(e=>(0,l.S)(e));return n.useCallback(n=>{i(s.ky()),r&&_(r,t,e,n,o,d,u)},[i,e,t,r,o,d,u])}function m(){let e=(0,a.wA)(),t=(0,a.d4)(e=>e.search),r=(0,c._6)(),i=(0,a.d4)(e=>(0,l.S)(e));return n.useCallback((n,a,l,o)=>{e(s.ky()),_(o,n,a,l,t,r,i)},[e,t,r,i])}function h(){let e=(0,u.iZ)(),t=(0,d.dq)(),r=(0,p.ol)()?.id,a=(0,c._6)(),l=m();return n.useCallback((n,i,s)=>{if(!s)return;let d=s.model;l(n,(0,o.AR)(d,e,t,r,a),i,s)},[e,t,r,a,l])}function y(){let e=m();return n.useCallback((t,r,n)=>{if(!n)return;let a=n.model;e(t,(0,o.uF)(a),r,n)},[e])}function E(){let e=m();return n.useCallback((t,r,n)=>{if(!n)return;let a=n.model;e(t,(0,o.Xx)(a),r,n)},[e])}},354504(e,t,r){r.d(t,{G:()=>c,R:()=>s});var n=r(239976),a=r(105652),l=r(645186);if(1464==r.j)var i=r(710127);var o=r(559055);let s="search_file_browser_full_results",d=e=>"href"in e?e.href:null;function c({category:e,searchResult:t,index:r,children:s,planFilter:c}){let u=(0,l.d4)(e=>e.search),p=(0,l.d4)(e=>e.selectedView),_=(0,l.d4)(i.S),f=(0,a.useMemo)(()=>({position:r,resource_id:"id"in t.model?t.model.id:t.model.key,resource_type:t.search_model_type,matched_queries:t.matched_queries,result:t}),[t,r]),m=(0,a.useMemo)(()=>new o.vj.Analytics(u,f,{plan:_}),[]);(0,a.useEffect)(()=>{m.update(u,f,{plan:_})},[m,u,f,_]);let h=(0,a.useCallback)(t=>{let r=t.target,n=r.closest("[data-search-click-action]")?.getAttribute("data-search-click-action");n!==o.jr&&m.click(e,p,{action:n||"click",target:d(r)},c)},[m,e,p,c]),y=(0,a.useCallback)(t=>{let r=t.target,n=r.closest("[data-search-context-menu-action]")?.getAttribute("data-search-context-menu-action");n!==o.jr&&m.click(e,p,{action:n||"context-click",target:d(r)})},[m,e,p]);return(0,n.jsx)("div",{"data-search-context-menu-action":"context-click","data-search-click-action":"click",onClickCapture:h,onContextMenuCapture:y,children:s})}},784195(e,t,r){r.d(t,{kq:()=>eI,Q0:()=>eT,ro:()=>ex});var n,a,l,i,o,s,d,c,u,p,_,f,m,h,y,E,b,g=r(239976),v=r(523924),F=r(921282),x=r(105652),I=r(645186),T=r(490753),w=r(985373),R=r(735594),k=r(140390),O=r(354504),S=r(928814),C=r(645724);function A(e){return t=>{let r,n;return r=e.map(e=>e(t.data)).filter(e=>null!==e),n={...t.targetRect,position:"fixed"},(0,g.jsx)(C.ms,{style:n,children:r.map((e,t)=>null===e?null:"SEPARATOR"===e?t===r.length-1?null:(0,g.jsx)(C.wv,{},`sep${t}`):(0,g.jsx)(C.c$,{id:e.id,onClick:e.onClick,disabled:e.disabled,onMouseDown:S.wo,children:e.text},e.id))})}}var P=r(850159),j=r(904511),N=r(154077),L=r(74020),M=r(38900),W=r(575425),D=r(701156),B=r(832763),U=r(164031),K=r(832508),V=r(907988),H=r(181645),Y=r(436174),z=r(198788),$=r(898312),q=r(358873),G=r(389218);(e=>{var t;e.Separator=()=>"SEPARATOR";let r=(e,t)=>r=>{let n=e(r);return n?t(n):null};function n(e){let t=(0,I.wA)(),{Sprig:r}=(0,z.A)();if(!e)return null;let{overrides:n,...a}=e;return{id:"open_view",text:(0,P.t)("general.open"),onClick:()=>{let e=(0,Y.Xr)();"fullscreen"===a.view&&a.fileKey&&e&&((0,H.sx)("Open File Click",{fileKey:a.fileKey,uiSelectedView:JSON.stringify(e.view)}),(0,q.k1)(a.fileKey,{selectedViewName:e.view,sprig:r})),t(w.sf(a))},...n}}let a=e=>{let t=(0,I.wA)(),{overrides:r,...n}=e;return{id:"copy_link",text:(0,P.t)("file_browser.copy_link"),onClick:()=>t(j.S(n)),...r}};function l(e){let t=(0,I.wA)();if(!e)return null;let{overrides:r,...n}=e;return{id:"copy_view_link",text:(0,P.t)("file_browser.copy_link"),onClick:()=>t(j.le(n)),...r}}let i=e=>{let t=(0,I.wA)(),{overrides:r,...n}=e;return{id:"open_in_new_tab",text:(0,P.t)("file_browser.open_in_new_tab"),onClick:()=>t($.V3(n)),...r}};function o(e){let t=(0,I.wA)(),r=(0,I.Pj)();if(!e)return null;let{overrides:n,...a}=e;return{id:"open_view_in_new_tab",text:(0,P.t)("file_browser.open_in_new_tab"),onClick:()=>{let e=(0,Y.Xr)();"fullscreen"===a.view&&a.fileKey&&e&&((0,H.sx)("Open File in New Tab Click",{fileKey:a.fileKey,uiSelectedView:JSON.stringify(e.view)}),t($.UN({fileKey:a.fileKey})));let n=(0,G.xS)(r.getState(),a);t($.V3({url:n}))},...n}}(t=e.Creators||(e.Creators={})).Open=e=>r(e,n),t.CopyLink=e=>r(e,a),t.CopyViewLink=e=>r(e,l),t.OpenInNewTab=e=>r(e,i),t.OpenViewInNewTab=e=>r(e,o)})(u||(u={}));let Q=e=>({view:"fullscreen",fileKey:e.key,editorType:(0,W.wN)(e.editorType||"design")});(n=p||(p={})).Open=u.Creators.Open(Q),n.OpenInNewTab=u.Creators.OpenViewInNewTab(Q),n.CopyLink=function(e){let t=(0,I.wA)(),r=(0,I.d4)(e=>e.sharingAttributionContextKey);return{id:"copy_view_link",text:(0,P.t)("file_browser.copy_link"),onClick:()=>{let n=new K.a;t(j.TH({selector:n,selectedView:Q(e),data:{sharingAttributionContextKey:r,resources:{file:R.F.toSinatra(e),repo:e.fileRepo}}}))}}},n.Share=e=>{let t=(0,I.wA)();return{id:"share_file",text:"Share",onClick:()=>{t((0,M.to)({type:V.g_,data:{fileKey:e.key,source:D.nk.fileBrowserContextMenu}}))}}},n.ShowInFolder=function(e){let t=(0,I.wA)(),{folderId:r}=e;return r?{id:"show_in_folder",text:"Show in project",onClick:()=>{t(w.sf({view:"folder",folderId:r})),t(L.y$({type:U.F.FILES,tiles:[(0,B.fA)(R.F.toSinatra(e))]}))}}:null},n.SetFavoriteStatus=e=>{let t=(0,I.wA)();return e.isFavorited?{id:"set_favorite_status",text:e.isFavorited?(0,P.t)("tile.favoriting.remove_from_favorites"):(0,P.t)("tile.favoriting.add_to_favorites"),onClick:()=>{e.isFavorited?t(N.qP({file:{editorType:e.editorType,key:e.key},entrypoint:"search_dropdown",fileBrowserEntryPoint:!0})):t(N.Fb({file:e,entrypoint:"search_dropdown",fileBrowserEntryPoint:!0})),t(w.oB())}}:null};var X=r(852401);let J=e=>function(t){return e&&F.eD?null:{view:"folder",folderId:t.id}};(a=_||(_={})).CopyLink=u.Creators.CopyViewLink(J(!1)),a.Open=u.Creators.Open(J(!1)),a.OpenInNewTab=u.Creators.OpenViewInNewTab(J(!0)),a.ShowInTeam=e=>{let t=(0,I.wA)(),{team_id:r}=e;return r?{id:"show_in_team",text:"Show team",onClick:()=>{t(w.sf({view:"team",teamId:r}))}}:null},a.Share=e=>{let t=(0,I.wA)();return{id:"share_folder",text:"Share",onClick:()=>{t(M.to({type:X.WY,data:{folderId:e.id}}))}}};var Z=r(613629),ee=r(634993),et=r(508295);let er=e=>({view:"communityHub",subView:"hubFile",hubFileId:e.id});(l=f||(f={})).Open=u.Creators.Open(er),l.OpenInNewTab=u.Creators.OpenViewInNewTab(er),l.CopyLink=u.Creators.CopyViewLink(er),l.Duplicate=e=>{let t=(0,I.wA)(),r=(0,et.iZ)();return{id:"duplicate_hub_file",text:"Duplicate",onClick:()=>{r?t((0,ee.p7)({hubFileId:e.id,workspace:{userId:r.id,orgId:null}})):t(Z.F.enqueue({message:"Must be signed in to duplicate a file",error:!0}))}}};let en=e=>function(t){return e&&F.eD?null:{view:"communityHub",subView:"plugin",publishedPluginId:t.id}};(i=m||(m={})).Open=u.Creators.Open(en(!1)),i.OpenInNewTab=u.Creators.OpenViewInNewTab(en(!0)),i.CopyLink=u.Creators.CopyViewLink(en(!1));let ea=e=>({view:"communityHub",subView:"handle",handle:e.profile_handle});(o=h||(h={})).Open=u.Creators.Open(ea),o.OpenInNewTab=u.Creators.OpenViewInNewTab(ea),o.CopyLink=u.Creators.CopyViewLink(ea);var el=r(140979),ei=r(644350),eo=r(621995);let es=e=>{let t=(0,el.bc)(ei.yQw,{teamId:e.id}).transform(({team:e})=>!e?.canRead).unwrapOr(!1);return{view:"team",teamId:e.id,overrides:{disabled:!!t}}};(s=y||(y={})).Open=u.Creators.Open(es),s.OpenInNewTab=u.Creators.OpenViewInNewTab(function(e){return F.eD?null:es(e)}),s.CopyLink=u.Creators.CopyViewLink(es),s.Leave=e=>{let t=(0,I.wA)(),r=(0,I.d4)(e=>e.user),n=(0,I.d4)(t=>t.roles?.byTeamId[e.id]);return r&&n&&n[r.id]?{id:"leave_team_prompt",text:"Leave team",onClick:()=>{t((0,M.to)({type:eo.p,data:{teamId:e.id}}))}}:null};var ed=r(440103);let ec=e=>function(t){return e&&F.eD?null:{view:"user",userId:t.id,orgId:t.org_id,userViewTab:ed.o.INTERNAL_PROFILE}};(d=E||(E={})).Open=u.Creators.Open(ec(!1)),d.OpenInNewTab=u.Creators.OpenViewInNewTab(ec(!0)),d.CopyLink=u.Creators.CopyViewLink(ec(!1));let eu=e=>function(t){return e&&F.eD?null:{view:"communityHub",subView:"widget",widgetId:t.id}};(c=b||(b={})).Open=u.Creators.Open(eu(!1)),c.OpenInNewTab=u.Creators.OpenViewInNewTab(eu(!0)),c.CopyLink=u.Creators.CopyViewLink(eu(!1));let ep=A([m.Open,m.OpenInNewTab,u.Separator,m.CopyLink]),e_=A([f.Open,f.OpenInNewTab,u.Separator,f.CopyLink,f.Duplicate]),ef=A([f.Open,u.Separator,f.CopyLink,f.Duplicate]),em=A([E.Open,E.OpenInNewTab,u.Separator,E.CopyLink]),eh=A([h.Open,h.OpenInNewTab,u.Separator,h.CopyLink]),ey=A([y.Open,y.OpenInNewTab,u.Separator,y.Leave]),eE=A([b.Open,b.OpenInNewTab,u.Separator,b.CopyLink]);function eb(e){let t,{data:r,canAccessFileResultFolder:n}=e.selected,a=(t=e.isDropdown,A([p.Open].concat([p.OpenInNewTab],[u.Separator],[p.CopyLink],t?[]:[p.Share],n?[p.ShowInFolder]:[],[p.SetFavoriteStatus])));if(!("search_model_type"in r))return(0,g.jsx)(a,{targetRect:e.targetRect,data:R.F.toLiveGraph(r)});switch(r.search_model_type){case k.uH.HUB_FILES:if(F.eD)return(0,g.jsx)(ef,{targetRect:e.targetRect,data:r.model});return(0,g.jsx)(e_,{targetRect:e.targetRect,data:r.model});case k.uH.PUBLIC_PLUGINS:return(0,g.jsx)(ep,{targetRect:e.targetRect,data:r.model});case k.uH.PUBLIC_PROFILES:return(0,g.jsx)(eh,{targetRect:e.targetRect,data:r.model});case k.uH.USERS:return(0,g.jsx)(em,{targetRect:e.targetRect,data:r.model});case k.uH.FILES:return(0,g.jsx)(a,{targetRect:e.targetRect,data:R.F.toLiveGraph(r.model)});case k.uH.TEAMS:return(0,g.jsx)(ey,{targetRect:e.targetRect,data:r.model});case k.uH.PROJECTS:let l,i=(l=e.isDropdown,A([_.Open].concat([_.OpenInNewTab],[u.Separator],l?[]:[_.Share],[_.ShowInTeam])));return(0,g.jsx)(i,{targetRect:e.targetRect,data:r.model});case k.uH.PRIVATE_PLUGINS:return(0,g.jsx)(ep,{targetRect:e.targetRect,data:r.model});case k.uH.PUBLIC_WIDGETS:case k.uH.PRIVATE_WIDGETS:return(0,g.jsx)(eE,{targetRect:e.targetRect,data:r.model});default:return(0,v.xb)(r)}}let{Context:eg,Provider:ev}=function(e,t){let r=x.createContext({onContextMenuClick:(e,t)=>{}});function n(r){let n=(0,I.d4)(e=>e.dropdownShown);return n&&n.data&&n.type===e?t(r,{...n.data}):null}let a=class extends x.PureComponent{constructor(){super(...arguments),this.onContextMenuClick=(t,r)=>{r.stopPropagation(),r.preventDefault();let n=window.innerWidth,a=window.innerHeight,l={};l={left:r.clientX<n/2?r.clientX:"auto",right:r.clientX<n/2?"auto":n-r.clientX,top:r.clientY<a/2?r.clientY:"auto",bottom:r.clientY<a/2?"auto":a-r.clientY},this.props.onContextClick&&this.props.onContextClick(t,r),this.props.dispatch(w.j7({type:e,data:{selected:t,targetRect:l,modifiers:(0,T.sN)(r)}}))}}render(){let e={onContextMenuClick:this.onContextMenuClick};return(0,g.jsx)(r.Provider,{value:e,children:this.props.children})}};return{Context:r,Provider:e=>{let t=(0,I.wA)(),r=(0,I.d4)(e=>e.dropdownShown);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(a,{dispatch:t,dropdownShown:r,...e}),(0,g.jsx)(n,{...e,children:void 0})]})}}}("search-results-context-menu",(e,t)=>{let{data:r,index:n}=t.selected;return"search_model_type"in r?(0,g.jsx)(O.G,{category:r.search_model_type,searchResult:r,index:n,children:(0,g.jsx)(eb,{isDropdown:e.isDropdown,...t})}):(0,g.jsx)(eb,{isDropdown:e.isDropdown,...t})});function eF(e){return(0,g.jsx)("div",{onContextMenu:t=>{let r={index:e.index,data:e.data};e.onContextMenu(r,t)},children:e.children})}function ex(e){return(0,g.jsx)(eg.Consumer,{children:t=>(0,g.jsx)(eF,{onContextMenu:t.onContextMenuClick,...e})})}let eI=eg,eT=ev},645569(e,t,r){r.d(t,{R:()=>n});let n="FACETED_SEARCH_MODAL_DEPRECATED_TYPE"},629239(e,t,r){if(r.d(t,{C:()=>o}),1464==r.j)var n=r(523924);var a=r(801236),l=r(832763);if(1464==r.j)var i=r(487817);function o(e){let t=(0,a.NN)();switch(e.type){case l.nb.FILE:return t(e.file);case l.nb.PINNED_FILE:case l.nb.OFFLINE_FILE:if(e.file.editorType===i._Y.WHITEBOARD)return a.y1.WHITEBOARD;if(e.file.editorType===i._Y.SLIDES)return a.y1.SLIDES;if(e.file.editorType===i._Y.SITES)return a.y1.SITES;if(e.file.editorType===i._Y.COOPER)return a.y1.COOPER;if(e.file.editorType===i._Y.FIGMAKE)return a.y1.FIGMAKE;if(e.file.editorType===i._Y.DESIGN||null===e.file.editorType)return a.y1.DESIGN;(0,n.xb)(e.file.editorType);case l.nb.PROTOTYPE:return a.y1.PROTOTYPE;case l.nb.REPO:return a.y1.REPO;default:(0,n.xb)(e)}}},328403(e,t,r){r.d(t,{EB:()=>c,WJ:()=>p,ym:()=>u});var n=r(105652),a=r(645186),l=r(436174),i=r(490753);if(1464==r.j)var o=r(898312);var s=r(985373),d=r(389218);function c(){let e=u(),t=p();return n.useCallback(async(r,n)=>{(n?.preventDefault(),n&&((0,i.oJ)(n)||1===n.button))?t(r):await e(r)},[e,t])}function u(){let e=(0,a.wA)();return n.useCallback(async t=>{e(s.oB()),await e(o.gN(t))},[e])}function p(){let e=(0,a.wA)(),t=(0,a.Pj)();return n.useCallback(r=>{e(s.oB());let n=o.gN(r),a=t.getState(),i=(0,d.xS)(a,n.payload);l.Ay.redirect(i,"_blank")},[e,t])}},738109(e,t,r){r.d(t,{v:()=>T});var n=r(105652),a=r(645186);if(1464==r.j)var l=r(523924);var i=r(30890),o=r(921282),s=r(436174),d=r(490753),c=r(985373),u=r(942496),p=r(944706),_=r(575425),f=r(303875),m=r(682894),h=r(832763),y=r(865780),E=r(773201),b=r(508295),g=r(886213),v=r(458983);if(1464==r.j)var F=r(323440);var x=r(309295);if(1464==r.j)var I=r(153645);function T(){let e=(0,b.iZ)(),t=(0,y.dq)(),r=(0,v.cD)(),l=(0,E._6)(),i=(0,a.wA)(),s=(0,a.d4)(e=>e.selectedBranchKeyByRepoId);return n.useCallback(async(n,a)=>{i(c.oB());let u=a&&1===a.button,p=a&&((0,d.Fo)(a)||u),_=null;if(p&&a?.shiftKey?_=o.aw.FOCAL_TAB:p?_=o.aw.BACKGROUND_TAB:a?.shiftKey&&(_=o.aw.NEW_WINDOW),o.eD){w({tile:n,selectedBranchKeyByRepoId:s,dispatch:i,user:e,target:_}),a?.preventDefault();return}return null!=_&&a?void R({tile:n,e:a,selectedBranchKeyByRepoId:s,target:_,dispatch:i}):(a?.preventDefault(),void await k({tile:n,selectedBranchKeyByRepoId:s,dispatch:i,user:e,selectedView:l,currentUserOrgId:t,currentTeamId:r}))},[s,i,e,t,r,l])}let w=({tile:e,selectedBranchKeyByRepoId:t,dispatch:r,user:n,target:a})=>{if(!o.eD)return void(0,l.KF)(!0,"Should not be calling openGenericTileDesktop if not in the desktop app");a=a??o.aw.FOCAL_TAB;let i=h.Tf.getIsTeamTemplate(e),s=h.Tf.getName(e),d=h.Tf.getEditorType(e);switch(e.type){case h.nb.FILE:o.eD.openFile({fileKey:e.file.key,title:e.file.name,fileEditorType:e.file.editorType,target:a,isBranch:(0,f.Kz)(e.file),isLibrary:!!e.file.lastPublishedAt,isTeamTemplate:i,userId:n?.id});break;case h.nb.PINNED_FILE:o.eD.openFile({fileKey:e.file.key,title:s,fileEditorType:d,isTeamTemplate:i,target:a,userId:n?.id});break;case h.nb.PROTOTYPE:o.eD.openPrototype(e.prototype.file_key,e.prototype.page_id,e.prototype.fig_file.name||"",a,n?.id);break;case h.nb.REPO:let c=(0,f.mr)(e.repo,e.branches,t);c&&o.eD.openFile({fileKey:c.key,title:c.name,fileEditorType:c.editor_type,target:a,isBranch:(0,f.Xm)(c),isLibrary:!!c.last_published_at,userId:n?.id});break;case h.nb.OFFLINE_FILE:r(u.NA({file:e.file,openNewFileIn:x.ai.NEW_TAB,source:F.U.OFFLINE_FILE_TILE}));break;default:(0,l.xb)(e)}},R=({tile:e,e:t,selectedBranchKeyByRepoId:r,dispatch:n})=>{e.type===h.nb.OFFLINE_FILE&&n(u.NA({file:e.file,openNewFileIn:x.ai.NEW_TAB,source:F.U.OFFLINE_FILE_TILE}));let a=h.Tf.getEditUrl(e,r);s.Ay.redirect(a,"_blank"),t.preventDefault()},k=async({tile:e,selectedBranchKeyByRepoId:t,dispatch:r,currentUserOrgId:n,selectedView:a,currentTeamId:o,user:s})=>{let d="recentsAndSharing"===a.view||"folder"===a.view?a:void 0;r(p.c5({planId:n||o,planType:n?I.O.ORG:I.O.TEAM}));let y={user:s,teamId:o,orgId:n,selectedView:a};switch(e.type){case h.nb.FILE:i.N7(n,e.file.parentOrgId,o,e.file.teamId)?i.QV({file:{key:e.file.key,editorType:e.file.editorType||void 0}},y):r(c.sf({view:"fullscreen",fileKey:e.file.key,editorType:m.z4.getIsExtension()?_.nT.DevHandoff:e.file.editorType?(0,_.wN)(e.file.editorType):_.nT.Design,prevSelectedView:d}));break;case h.nb.PINNED_FILE:let E=await g.M4.fetchFile(e.file.key);i.N7(n,E.parent_org_id,o,E.team_id)?i.QV({file:{key:e.file.key,editorType:e.file.editorType}},y):r(c.sf({view:"fullscreen",fileKey:e.file.key,editorType:(0,_.wN)(e.file.editorType),prevSelectedView:d}));break;case h.nb.PROTOTYPE:let b=e.prototype.fig_file;i.N7(n,b.parent_org_id,o,b.team_id)?i.QV({base:"proto",file:{key:b.key,editorType:b.editor_type||void 0},nodeId:e.prototype.page_id},y):r(c.sf({view:"prototype",file:b,nodeId:e.prototype.page_id,prevSelectedView:d}));break;case h.nb.REPO:let v=(0,f.mr)(e.repo,e.branches,t);if(!v)return;i.N7(n,v.parent_org_id,o,v.team_id)?i.QV({file:{key:v.key}},y):r(c.sf({view:"fullscreen",fileKey:v.key,editorType:_.nT.Design,prevSelectedView:d}));break;case h.nb.OFFLINE_FILE:r(u.NA({file:e.file,openNewFileIn:x.ai.SAME_TAB,source:F.U.OFFLINE_FILE_TILE}));break;default:(0,l.xb)(e)}}},9348(e,t,r){r.d(t,{TS:()=>p,Vj:()=>_,lo:()=>u});var n=r(105652),a=r(645186),l=r(436174),i=r(490753);if(1464==r.j)var o=r(898312);var s=r(985373),d=r(865780),c=r(852734);function u(){let e=p(),t=_();return n.useCallback((r,n)=>{n&&((0,i.oJ)(n)||1===n.button)?t(r.id):(n?.preventDefault(),e(r.id))},[t,e])}function p(){let e=(0,a.wA)();return n.useCallback(t=>{e(o.kg({clickedResourceType:"team",resourceIdOrKey:t})),e(s.sf({view:"team",teamId:t}))},[e])}function _(){let e=(0,d.dq)();return n.useCallback(t=>{let r=(0,c.bL)(t,e);l.Ay.redirect(r,"_blank")},[e])}},275262(e,t,r){r.d(t,{y:()=>p});var n=r(105652),a=r(645186),l=r(436174),i=r(490753);if(1464==r.j)var o=r(848594);var s=r(985373),d=r(865780),c=r(508295);if(1464==r.j)var u=r(440103);function p(){let e=(0,a.wA)(),t=(0,c.TA)(),r=(0,d.dq)();return n.useCallback((n,a)=>{if(a&&((0,i.oJ)(a)||1===a.button)){a?.stopPropagation();let e=n.id;if(e===t)return void l.Ay.redirect(`/files/${r}/user/${e}`,"_blank");let i=n.org_id,s=(0,o.t)(n,i);return void l.Ay.redirect(s,"_blank")}a?.preventDefault(),e(s.sf({view:"user",userId:n.id,orgId:n.org_id||null,userViewTab:u.o.INTERNAL_PROFILE}))},[t,r,e])}},753495(e,t,r){r.d(t,{$:()=>i});var n=r(885705),a=r(181645),l=r(539236);let i=new class{constructor(e){this.type=e}start(e){performance.mark(`${this.type}_${e}.startSpan`,{startTime:performance.now()})}endAndReport(e){let t=performance.now(),r=`${this.type}_${e}`;performance.mark(`${r}.endSpan`,{startTime:t});try{let e=performance.measure(`${r}`,`${r}.startSpan`,`${r}.endSpan`).duration;a.az.trackDefinedEvent("file_browser.total_context_menu_load_time",{durationMs:Math.round(e),type:this.type});let t=performance.getEntriesByName(`${r}.startSpan`)[0]?.startTime??0;l.J.logVital(`${this.type}.duration`,{level:n.$.INFO,startTime:t+performance.timeOrigin,duration:e,description:`Latency for ${this.type} dropdown to render`}),performance.clearMarks(`${r}.startSpan`),performance.clearMarks(`${r}.endSpan`)}catch(e){}}}("tile-action-dropdown")},642529(e,t,r){if(r.d(t,{K:()=>l}),1464==r.j)var n=r(523924);if(1464==r.j)var a=r(487817);function l(e){switch(e){case a._Y.DESIGN:return"design";case a._Y.WHITEBOARD:return"whiteboard";case a._Y.SLIDES:return"piper";case a._Y.SITES:return"seascape";case a._Y.FIGMAKE:return"bake-filebrowser";case a._Y.COOPER:return"cooper";default:return(0,n.S9)(e,"design")}}},848594(e,t,r){r.d(t,{t:()=>n});function n(e,t){return t?`/files/${t}/user/${e.id}`:`/files/user/${e.id}`}},121267(e,t,r){r.d(t,{i:()=>eH});var n=r(239976),a=r(105652),l=r(706354),i=r(181645),o=r(582036),s=r(485587),d=r(227031),c=r(684325),u=r(904788),p=r(753495),_=r(442549),f=r(645186),m=r(745463),h=r(194535),y=r(805242);function E({children:e,portalTarget:t,portalKey:r}){return(0,y.createPortal)(e,t,r)}var b=r(303875),g=r(832763),v=r(735594),F=r(164031),x=r(165617),I=r(740939),T=r(523924),w=r(850159),R=r(954720),k=r(113641),O=r(904511),S=r(927243),C=r(83522),A=r(109095),P=r(79303),j=r(741405),N=r(493094),L=r(863825),M=r(741542),W=r(198788);function D(){let{Sprig:e}=(0,W.A)();return a.useCallback(()=>{(0,M.getFeatureFlags)().file_browser_sentiment_survey&&e("setAttribute","fb_file_organized",!0)},[e])}var B=r(286185),U=r(964680),K=r(508295),V=r(74020),H=r(126002),Y=r(110638),z=r(798413),$=r(613549),q=r(138107),G=r(154077),Q=r(571916),X=r(38900),J=r(148929),Z=r(331850),ee=r(32763),et=r(684769),er=r(350923),en=r(998277),ea=r(423915),el=r(946182),ei=r(183890),eo=r(487817),es=r(129862),ed=r(27261),ec=r(30890),eu=r(436174),ep=r(985373),e_=r(990483),ef=r(921282),em=r(942496),eh=r(282008),ey=r(323440),eE=r(309295),eb=r(56967),eg=r(167523),ev=r(460677),eF=r(207187),ex=r(700354),eI=r(462198),eT=r(225376),ew=r(920952),eR=r(701156),ek=r(506213),eO=r(542179),eS=r(907988),eC=r(73089),eA=r(89393),eP=r(446989),ej=r(642135),eN=r(636080);function eL({loadedQueries:e,onMount:t,openTile:r,permsByFileKey:i,permsByPrototypeId:s,permsByRepoId:d,selectedTiles:c,sourceFile:p,tile:_,tileActions:y,trackSearchFn:M}){let eL=(0,f.wA)(),{dropdownShown:eM}=(0,h.R)(e=>({dropdownShown:e.dropdownShown})),eW=(0,o.gS)(c),eD=a.useMemo(()=>Object.keys(eW[F.F.FILES]),[eW]),eB=a.useMemo(()=>Object.keys(eW[F.F.REPOS]),[eW]),eU=_.type===g.nb.FILE?_.file:null,eK=_.type===g.nb.PINNED_FILE?_.file:null,eV=eK||eU,eH=_.type===g.nb.REPO?_.repo:null,eY=(eV&&i[eV.key])??null,ez=(eH&&d[eH.id])??null,e$=_.type===g.nb.PROTOTYPE?_.prototype:null,eq=_.type===g.nb.REPO?_.branches.find(e=>(0,b.SA)(e,_.repo))??null:null,eG=eq?v.F.toLiveGraph(eq):null,eQ=(e$&&s[e$.file_key])??null,eX=a.useMemo(()=>({tile:_,file:eU,pinnedFile:eK,fileOrPinnedFile:eV,repo:eH,repoDefaultFile:eq,repoDefaultFileLG:eG,prototype:e$,filePerms:eY,repoPerms:ez,prototypePerms:eQ}),[_,eU,eK,eV,eH,eq,eG,e$,eY,ez,eQ]),eJ=Object.keys(eW[F.F.FILES]).length,eZ=Object.keys(eW[F.F.PINNED_FILES]).length,e0=Object.keys(eW[F.F.PROTOTYPES]).length,e1=Object.keys(eW[F.F.REPOS]).length,e5=Object.keys(eW[F.F.OFFLINE_FILES]).length,e4=eJ+eZ+e1+e0+e5,e6=1===e4,e2=a.useMemo(()=>({isSingleTileSelected:e6,numFilesSelected:eJ,numPinnedFilesSelected:eZ,numPrototypesSelected:e0,numReposSelected:e1,numOfflineFilesSelected:e5,totalTilesSelected:e4}),[e6,eJ,eZ,e0,e1,e5,e4]),e8=function({loadedQueries:e,sourceFile:t,tileActions:r,tileSelectCounts:n}){let l=(0,f.wA)();return a.useMemo(()=>{let{isSingleTileSelected:a,numFilesSelected:i,numPinnedFilesSelected:o,numReposSelected:s}=n,d=null!=e.createBranchStatus&&"disabled"===e.createBranchStatus.status,c=!!(r.createBranch&&a&&(1===i||1===o||1===s)&&t&&e.createBranchStatus&&"hidden"!==e.createBranchStatus.status);return{[I.W.CREATE_BRANCH]:c?{displayText:(0,w.t)("tile.dropdown.create_new_branch"),recordingKey:"create-branch",callback:()=>{let r=e.createBranchStatus;if(!t||!r)return;let n=k.e0.FILE_BROWSER;switch(r.status){case"upsell-org":l(R.j({trackingContextName:n}));break;case"enabled":l(R.l({trackingContextName:n,sourceFileKey:t.key,dispatchedFromEditor:!1}));break;case"disabled":case"hidden":break;default:(0,T.xb)(r.status)}},disabled:d}:null}},[n,e.createBranchStatus,r.createBranch,t,l])}({loadedQueries:e,sourceFile:p,tileActions:y,tileSelectCounts:e2}),e3=function({tileSelectCounts:e,tileActions:t,tile:r}){let n=(0,f.wA)(),{selectedBranchKeyByRepoId:l,attributionContextKey:i}=(0,h.R)(e=>({selectedBranchKeyByRepoId:e.selectedBranchKeyByRepoId,attributionContextKey:e.sharingAttributionContextKey})),o=r.type===g.nb.OFFLINE_FILE?r.file:null;return a.useMemo(()=>{let{isSingleTileSelected:a}=e,s=!!(t.copyLink&&a&&!o);return{[I.W.COPY_LINK]:s?{displayText:(0,w.t)("tile.dropdown.copy_link"),recordingKey:"copy-link",callback:()=>(e=>{switch(e.type){case g.nb.FILE:let t=e.file;n(S.S({fileKey:t.key,url:(0,C.jN)({file:t,attributionContext:(0,A.b)(i,A.d.FILE_TILE_CONTEXT_MENU),allowDefaulting:!0}),source:A.d.FILE_TILE_CONTEXT_MENU}));break;case g.nb.PINNED_FILE:n(S.S({fileKey:e.file.key,url:(0,C.jN)({file:e.file,attributionContext:(0,A.b)(i,A.d.FILE_TILE_CONTEXT_MENU),allowDefaulting:!0}),source:A.d.FILE_TILE_CONTEXT_MENU}));break;case g.nb.PROTOTYPE:n(O.S({url:(0,C.Kw)({base:"proto",file:{key:e.prototype.file_key},nodeId:e.prototype.page_id,attributionContext:(0,A.b)(i,A.d.FILE_TILE_CONTEXT_MENU)})}));break;case g.nb.REPO:let r=(0,b.mr)(e.repo,e.branches,l);n(S.S({fileKey:r.key,url:(0,b.CE)(r,e.repo,"file"),source:A.d.FILE_TILE_CONTEXT_MENU}))}})(r)}:null}},[e,t.copyLink,o,n,i,l,r])}({tileSelectCounts:e2,tileActions:y,tile:_}),e7=function({permsByFileKey:e,permsByRepoId:t,selectedFileKeys:r,selectedRepoIds:n,selectedTiles:l,tile:i,tileActions:o,tileSelect:s,tileSelectCounts:d}){let c=(0,f.wA)(),{selectedBranchKeyByRepoId:u}=(0,h.R)(e=>({selectedBranchKeyByRepoId:e.selectedBranchKeyByRepoId})),p=(0,K.TA)(),[_]=(0,N.IT)((0,U.OL)({userId:p})),m=(0,a.useMemo)(()=>_?.data??{},[_]),y=D(),E=a.useMemo(()=>(0,P.n)(r,e)||[],[e,r]),v=a.useMemo(()=>(0,j.zj)(n,t)||[],[t,n]),x=a.useMemo(()=>Object.keys((0,U.gp)(s[F.F.OFFLINE_FILES],{offlineFiles:m})),[m,s]);return a.useMemo(()=>{let{numFilesSelected:r,numPinnedFilesSelected:n,numPrototypesSelected:a,numReposSelected:s,numOfflineFilesSelected:p,totalTilesSelected:_}=d,f=v.length+E.length+x.length,m=!!(o.delete&&f>0&&0===n),h=r+n+s+p,F="";1===h||(F=(0,w.t)("tile.dropdown.multiple_file_suffix",{totalSelected:h}));let T=F,R=!1;if(i.type===g.nb.REPO){let e=(0,b.mr)(i.repo,i.branches,u);R=!(0,b.SA)(e,i.repo)}let k=R?(0,w.t)("tile.dropdown.move_file_and_branches_to_trash"):1===_?(0,w.t)("tile.dropdown.trash_single_tile"):(0,w.t)("tile.dropdown.trash_file",{objText:T});return{[I.W.DELETE]:m?{displayText:k,recordingKey:"delete",callback:()=>{let{selectedCount:r,deletableCount:n,allDrafts:a,filesByKey:i,reposById:o,offlineFilesByKey:s}=B.Mw(l,e,t);if(n<r){let e=(0,w.t)("tile.dropdown.no_permission_to_trash_error");c(L.s.error(e));return}c(B.U1({filesByKey:i,reposById:o,offlineFilesByKey:s,allDrafts:a})),y()},disabled:f<r||a>0}:null}},[E.length,x.length,v.length,c,e,t,l,o.delete,d,u,i,y])}({permsByFileKey:i,permsByRepoId:d,selectedFileKeys:eD,selectedRepoIds:eB,selectedTiles:c,tileSelect:eW,tileSelectCounts:e2,tileActions:y,tile:_}),e9=function({permsByFileKey:e,permsByRepoId:t,selectedFileKeys:r,selectedRepoIds:n,selectedTiles:l,tile:i,tileActions:o,tileData:s,tileSelect:d,tileSelectCounts:c}){let u=(0,Y.FC)(),p=(0,f.wA)(),{user:_,currentUserOrgId:m}=u,{selectedBranchKeyByRepoId:y,isOnDeleted:E}=(0,h.R)(e=>({selectedBranchKeyByRepoId:e.selectedBranchKeyByRepoId,isOnDeleted:"deletedFiles"===e.selectedView.view})),b=i.type===g.nb.FILE?i.file?.teamId:void 0,v=(0,q.vt)(b),x=(0,$.jn)(),T=D(),R=a.useMemo(()=>Object.keys(d[F.F.PINNED_FILES]),[d]),k=a.useMemo(()=>(0,P.v_)(r,e).length,[e,r]),O=a.useMemo(()=>(0,P.v_)(R,e).length,[e,R]),S=a.useMemo(()=>{let e={};for(let t of l.filter(e=>e.type===g.nb.REPO)){let r=t.repo.id,n=y[r],a=t.repo.default_file_key;n?e[r]=n:a&&(e[r]=a)}return e},[l,y]),C=a.useMemo(()=>E?Object.keys(d[F.F.REPOS]).length:((0,j.nL)(n,S,t)||[]).length,[E,t,d,n,S]);return a.useMemo(()=>{let{file:e}=s,{numFilesSelected:t,numPinnedFilesSelected:r,numPrototypesSelected:n,numReposSelected:a,numOfflineFilesSelected:l,totalTilesSelected:i}=c,u=(0,z.R$)(_,m),f=!!e&&!!e.teamId&&v,h=(k>0||O>0||C>0)&&!u&&!f&&!x,y=!!(o.duplicate&&h),E=!!(o.duplicateToDrafts&&h),b=t+r+a,g=k<t||O<r||C<a||n>0||l>0,F="";1!==b&&(F=(0,w.t)("tile.dropdown.multiple_file_suffix",{totalSelected:b}));let R=F;return{[I.W.DUPLICATE]:y?{displayText:1===i?(0,w.t)("tile.dropdown.duplicate_single_tile"):(0,w.t)("tile.dropdown.duplicate",{objText:R}),recordingKey:"duplicate",callback:()=>{p((0,H.n_)({toDraft:!1,tileSelect:d})),p(V.an()),T()},disabled:g}:null,[I.W.DUPLICATE_TO_DRAFTS]:E?{displayText:1===b?(0,w.t)("tile.dropdown.duplicate_to_draft_single_file_or_repo"):(0,w.t)("tile.dropdown.duplicate_to_draft",{objText:R}),recordingKey:"duplicate-to-drafts",callback:()=>{p((0,H.g4)({tileSelect:d})),p(V.an()),T()},disabled:g}:null}},[m,p,x,v,k,O,C,o.duplicate,o.duplicateToDrafts,s,d,c,T,_])}({permsByFileKey:i,permsByRepoId:d,tileSelectCounts:e2,tileActions:y,tile:_,selectedFileKeys:eD,selectedRepoIds:eB,selectedTiles:c,tileSelect:eW,tileData:eX}),te=function({tileSelectCounts:e,tileData:t,loadedQueries:r}){let n=(0,Y.FC)(),l=(0,f.wA)(),{currentUserOrgId:i}=n,{selectedView:o}=(0,h.R)(e=>({selectedView:e.selectedView})),s=D();return a.useMemo(()=>{let{pinnedFile:n,fileOrPinnedFile:a,repo:d,repoDefaultFile:c,prototype:u,filePerms:p,repoPerms:_,prototypePerms:f}=t,{isSingleTileSelected:m,numFilesSelected:h,numPinnedFilesSelected:y,numPrototypesSelected:E,numReposSelected:b}=e,g=(0,Q.D6)(i),F=(e,t,r)=>{let n={file:e,sectionId:t,entrypoint:"dropdown",fileBrowserFavorite:!0};r?l(G.Fb(n)):l(G.qP(n)),s()},x=(e,t)=>{let r={prototype:e,entrypoint:"dropdown",fileBrowserEntryPoint:!0};t?l(G.iN(r)):l(G.X7(r))},T=(e,t,r,n)=>{let a=e.is_favorited&&t.some(e=>e.id===r?.id);return{recordingKey:"add-to-sidebar",displayText:e.is_favorited?`${(0,w.t)("favorited_resources.indicate_section_prefix")}: ${r?.name||(0,w.t)("sidebar.starred")}`:(0,w.t)("favorited_resources.add_to_sidebar"),children:t.map(({id:e,name:t})=>({recordingKey:"add-to-sidebar-section",displayText:""===t?(0,w.t)("sidebar.starred"):t,isChecked:r?.id===e,alwaysShowCheckMarkOffset:a,callback:()=>n(e)}))}},R=(e,t,r,n)=>{if(null===e.default_file_key)return void console.error("Repo file key should not be null");let a={file:v.F.toLiveGraph(t),repoId:e.id,sectionId:r,entrypoint:"dropdown",fileBrowserFavorite:!0};n?l(G.Fb(a)):l(G.qP(a))},k=(0,Q.D6)(i),O=k?(0,w.t)("favorited_resources.remove_from_sidebar"):(0,w.t)("tile.favoriting.remove_from_favorites");return{[I.W.FAVORITE_FILE]:a&&(()=>{if("deletedFiles"===o.view||a?.parentOrgId!==i)return!1;let e=p?.canFavorite&&r.isResourceInUserPlan,t=p?.canFavorite&&!p?.isFavorited&&r.isResourceInUserPlan;return!!("team"!==o.view&&!r.hasMaxFavorites&&!g&&(t&&1===h&&m||n&&1===y&&!n?.isFavorited))||(g&&r.userSidebarSections,!!e&&1===h&&!!m||!!n&&1===y)})()?((e,t)=>{let{favoriteSidebarSection:n}=r;return k&&null!=t&&t?.length>0?T({is_favorited:e.isFavorited},t,n,t=>{F(e,t,n?.id!==t)}):{displayText:(0,w.t)("tile.favoriting.add_to_favorites"),recordingKey:"favorite-file",callback:()=>F(e,void 0,!0)}})(a,r.userSidebarSections):null,[I.W.FAVORITE_PROTOTYPE]:u&&(()=>{if("deletedFiles"===o.view||"team"===o.view||u?.parent_org?.id!==i)return!1;let e=f?.canFavorite&&r.isResourceInUserPlan;return!!(!r.hasMaxFavorites&&!g&&1===E&&m&&e)})()?{displayText:(0,w.t)("tile.favoriting.add_to_favorites"),recordingKey:"favorite-prototype",callback:()=>x(u,!0)}:null,[I.W.FAVORITE_REPO]:d&&c&&(()=>{if("deletedFiles"===o.view||d?.parent_org_id!==i)return!1;let e=_?.canFavorite&&r.isResourceInUserPlan;return!!("team"!==o.view&&!r.hasMaxFavorites&&!g&&1===b&&m&&e)||(g&&r.userSidebarSections,1===b&&!!m&&!!e)})()?((e,t,n)=>{let{favoriteSidebarSection:a}=r;return k&&null!=n?T(e,n,a,r=>{R(e,t,r,a?.id!==r)}):{displayText:(0,w.t)("tile.favoriting.add_to_favorites"),recordingKey:"favorite-repo",callback:()=>R(e,t,void 0,!0)}})(d,c,r.userSidebarSections):null,[I.W.UNFAVORITE_FILE]:a&&(()=>{if("deletedFiles"===o.view||"team"===o.view||a?.parentOrgId!==i)return!1;let e=p?.canFavorite&&p?.isFavorited;return!!(1===h&&m&&e||n&&1===y&&n?.isFavorited)})()?{displayText:O,recordingKey:"unfavorite-file",callback:()=>F(a,void 0,!1)}:null,[I.W.UNFAVORITE_PROTOTYPE]:u&&(()=>{if("deletedFiles"===o.view||"team"===o.view||u?.parent_org?.id!==i)return!1;let e=f?.canUnfavorite;return!!(1===E&&m&&e)})()?{displayText:O,recordingKey:"unfavorite-prototype",callback:()=>x(u,!1)}:null,[I.W.UNFAVORITE_REPO]:d&&c&&(()=>{if("deletedFiles"===o.view||"team"===o.view||d?.parent_org_id!==i)return!1;let e=_?.canUnfavorite;return!!(1===b&&m&&e)})()?{displayText:O,recordingKey:"unfavorite-repo",callback:()=>R(d,c,void 0,!1)}:null}},[t,e,i,r,s,l,o.view])}({tileSelectCounts:e2,tileData:eX,loadedQueries:e}),tt=function({tileData:e}){let t=(0,f.wA)(),r=(0,Z.D6)("TileActionDropdown"),n=(0,Z.Kd)(r).unwrapOr(!1);return a.useMemo(()=>{let{fileOrPinnedFile:r,repoDefaultFileLG:a}=e,l=r??a,i=(0,et.MG)(l?{parentOrgId:l.parentOrgId||null}:null,!!l?.lastPublishedAt,n),o=!!l&&i;return{[I.W.FILE_ANALYTICS]:o?{displayText:(0,w.t)("fullscreen.filename_view.file_analytics"),recordingKey:"file-analytics",callback:()=>{null!=l.folderId&&t((0,X.to)({type:ee.e,data:{fileKey:l.key,entrypoint:J.F.FileNavigation}}))}}:null}},[n,t,e])}({tileData:eX}),tr=function({tileActions:e,tileData:t,tileSelect:r,tileSelectCounts:n}){let l=(0,f.wA)(),{openFileFolderId:i,selectedView:o,pinnedFileKeys:s}=(0,h.R)(e=>({openFileFolderId:e.openFile?.folderId,selectedView:e.selectedView,pinnedFileKeys:e.pinnedFileKeys})),d=D(),c=(0,er.md)(ea.V1);return a.useMemo(()=>{let{file:a,pinnedFile:u,fileOrPinnedFile:p,repo:_,filePerms:f,repoPerms:m}=t,{numFilesSelected:h,numPinnedFilesSelected:y,numReposSelected:E,isSingleTileSelected:b}=n,g="folder"===o.view&&s[o.folderId]||c&&i&&s[i]||[],v=a&&g.includes(a.key),x=u&&g.includes(u.key),T=_&&_.default_file_key&&g.includes(_.default_file_key),R=v||x||T||Object.keys(r[F.F.PINNED_FILES]).length>0,k=e.pinToFolder&&!e.showInFolder&&b,O=f?.canPin,S=m?.canPin,C=!!(!R&&1===h&&k&&O),A=!!(!R&&1===E&&k&&S),P=!!(R&&y<=1&&k&&O),j=!!(R&&E<=1&&k&&S);return{[I.W.PIN_FILE_TO_FOLDER]:a&&C?{displayText:(0,w.t)("tile.dropdown.pin_to_project"),recordingKey:"pin-file-to-folder",callback:()=>{null!=a.folderId&&l(en.gO({folderId:a.folderId,teamId:a.teamId,fileKey:a.key})),d()}}:null,[I.W.PIN_REPO_TO_FOLDER]:_&&A?{displayText:(0,w.t)("tile.dropdown.pin_to_project"),recordingKey:"pin-repo-to-folder",callback:()=>{null!=_.folder_id&&null!=_.default_file_key&&l(en.gO({folderId:_.folder_id,teamId:_.team_id,fileKey:_.default_file_key})),d()}}:null,[I.W.UNPIN_FILE_FROM_FOLDER]:p&&P?{displayText:(0,w.t)("tile.dropdown.remove_project_pin"),recordingKey:"unpin-file-from-folder",callback:()=>{let e;null!=(e=p.folderId)&&l(en.z6({folderId:e,fileKey:p.key})),d()}}:null,[I.W.UNPIN_REPO_FROM_FOLDER]:_&&j?{displayText:(0,w.t)("tile.dropdown.remove_project_pin"),recordingKey:"unpin-repo-from-folder",callback:()=>{null!=_.folder_id&&null!=_.default_file_key&&l(en.z6({folderId:_.folder_id,fileKey:_.default_file_key})),d()}}:null}},[t,n,o,s,c,i,r,e.pinToFolder,e.showInFolder,d,l])}({tileActions:y,tileData:eX,tileSelect:eW,tileSelectCounts:e2}),tn=function({permsByFileKey:e,permsByRepoId:t,selectedFileKeys:r,selectedRepoIds:n,selectedTiles:l,tile:i,tileActions:o,tileData:s,tileSelect:d,tileSelectCounts:c}){let u=(0,f.wA)(),p=(0,el.bY)("file_multi_move_limit").getDynamicConfig().get("fileLimit",100),_=D(),m=a.useMemo(()=>(0,P.Ul)(r,e)||[],[e,r]),h=a.useMemo(()=>(0,j.ae)(n,t)||[],[t,n]),y=a.useMemo(()=>Object.keys(d[F.F.FILES]).length+Object.keys(d[F.F.REPOS]).length,[d]),E=a.useMemo(()=>{let a=new Set,l=new Set;return r.forEach(t=>{let r=e[t];r&&(a.add(r.planType||""),l.add(r.planId||""))}),n.forEach(e=>{let r=t[e];r&&(a.add(r.planType||""),l.add(r.planId||""))}),1===a.size&&(a.has("team")||1===l.size)},[e,t,r,n]),x=(0,ed.aI)(),{file:T,repo:R,filePerms:k,repoPerms:O}=s,{numFilesSelected:S,numPinnedFilesSelected:C,numReposSelected:A,numOfflineFilesSelected:N,totalTilesSelected:L,isSingleTileSelected:M}=c,W=(0,es.jB)({files:T?[v.F.toSinatra(T)]:[],repos:R?[R]:[],destinationFolderId:g.Tf.getFolderId(i),isDestinationDrafts:!1}),B=(0,es.Cp)(W.destinationPlan?.key||null,W.licenseType);return a.useMemo(()=>{let e,t,r=l.filter(e=>e.type===g.nb.FILE).map(e=>e.file).some(e=>e.editorType===eo._Y.FIGMAKE)&&W.requiresUpgrade&&!x,n=k?.canOpenMoveModal,a=O?.canOpenMoveModal,i=S+C+A,s=m.length+h.length,d=!!(o.moveFile&&0===N&&(M&&(1===S&&n||1===A&&a)||i>1&&i<=p&&s>0)),c="";return 1!==i&&(c=(0,w.t)("tile.dropdown.multiple_file_suffix",{totalSelected:i})),{[I.W.MOVE_FILE]:d?(e=c,t=1!==L&&(s<i||!E),{displayText:1===y?(0,w.t)("tile.dropdown.move_file"):(0,w.t)("tile.dropdown.move_object",{objText:e}),recordingKey:"move-file",callback:()=>((e,t,r)=>{if(1===r){let r=l[0];if(r?.type===g.nb.FILE)(0,ei.h)(v.F.toSinatra(r.file),null,u,void 0,void 0,{canMove:!!e?.canMove,isUserViewerRestricted:!!e?.isUserRestrictedForSeat,planUser:e?.planUser??null,inDrafts:!!e?.isDraftFile,draftsMoveData:W,hasConnectedPlanUserInOrg:B,canMoveWithReasons:e?.canMoveWithReasons});else if(r?.type===g.nb.REPO){let e=r.branches.find(e=>(0,b.SA)(e,r.repo));(0,ei.h)(e??null,r.repo,u,void 0,void 0,{canMove:!!t?.canMove,isUserViewerRestricted:!!t?.isUserRestrictedForSeat,planUser:t?.planUser??null,inDrafts:!!t?.isDraftRepo,draftsMoveData:W,hasConnectedPlanUserInOrg:B,canMoveWithReasons:t?.canMoveWithReasons})}}else{let e=l.filter(e=>e.type===g.nb.FILE).map(e=>v.F.toSinatra(e.file)),t=l.filter(e=>e.type===g.nb.REPO).map(e=>e.repo);(0,ei.O)(e,t,u)}_()})(k,O,y),disabled:t||r||(0,es.Px)(W,!!k?.isFileTypeDisabled,B),sideText:(0,es.zS)(W,t||!!k?.isFileTypeDisabled,B),rightJustifySideText:!0}):null}},[u,W,k,B,E,M,m.length,h.length,p,S,N,C,A,y,l,o.moveFile,O,x,L,_])}({permsByFileKey:i,permsByRepoId:d,selectedFileKeys:eD,selectedRepoIds:eB,selectedTiles:c,tile:_,tileActions:y,tileData:eX,tileSelect:eW,tileSelectCounts:e2}),ta=function({tileSelectCounts:e,tileData:t,tileActions:r,tile:n}){let l=(0,Y.FC)(),i=(0,f.wA)(),{user:o,currentUserOrgId:s}=l;return a.useMemo(()=>{let{filePerms:a,repoPerms:l}=t,{isSingleTileSelected:d,numFilesSelected:c,numReposSelected:u}=e,p=a?.canShowInProject,_=l?.canShowInProject,f=!!(r.showInFolder&&d&&(1===u&&_||1===c&&p));return{[I.W.SHOW_IN_FOLDER]:f?(e=>{switch(e.type){case g.nb.FILE:return{displayText:(0,w.t)("tile.dropdown.show_in_project"),recordingKey:"show-in-project-file",callback:()=>(e=>{if(null!=e.file.folderId)if(s===e.file.parentOrgId)i(ep.sf({view:"folder",folderId:e.file.folderId})),i(V.y$({type:F.F.FILES,tiles:[e]}));else{let t=e.file.parentOrgId?`/files/${e.file.parentOrgId}/project/${e.file.folderId}`:`/files/project/${e.file.folderId}`;t=o?(0,ec.NQ)(t,"fuid",o.id):t,eu.Ay.redirect(t)}})(e)};case g.nb.REPO:return{displayText:(0,w.t)("tile.dropdown.show_in_project"),recordingKey:"show-in-project-repo",callback:()=>{i(ep.sf({view:"folder",folderId:e.repo.folder_id})),i(V.y$({type:F.F.REPOS,tiles:[e]}))}};default:(0,T.wc)(I.W.SHOW_IN_FOLDER)}})(n):null}},[s,i,r.showInFolder,t,e,n,o])}({tileSelectCounts:e2,tileData:eX,tileActions:y,tile:_}),tl=function({openTile:e,tile:t,tileActions:r,tileSelectCounts:n,trackSearchFn:l}){let i=(0,f.wA)(),{selectedView:o,selectedBranchKeyByRepoId:s}=(0,h.R)(e=>({selectedView:e.selectedView,selectedBranchKeyByRepoId:e.selectedBranchKeyByRepoId})),{Sprig:d}=(0,W.A)();return a.useMemo(()=>{let{isSingleTileSelected:a}=n,c=!!(r.open&&a),u=!!(r.open&&a&&!ef.eD&&!(0,e_.ce)()),p=!!(r.open&&a&&(t.type===g.nb.FILE&&t.file.editorType===eo._Y.FIGMAKE||t.type===g.nb.PINNED_FILE&&t.file.editorType===eo._Y.FIGMAKE));return{[I.W.OPEN]:c?{displayText:(0,w.t)("tile.dropdown.open"),recordingKey:"open",callback:(t,r,n,a)=>{e(a)}}:null,[I.W.OPEN_NEW_TAB]:u?{displayText:(0,w.t)("tile.dropdown.open_new_tab"),recordingKey:"open-new-tab",callback:()=>(e=>{l&&l();let t=void 0===l;switch(e.type){case g.nb.FILE:let r=(0,C.rl)(e.file);(0,eh.nz)(r,e.file.key,o,i,d,t);break;case g.nb.PINNED_FILE:(0,eh.nz)((0,C.jN)(e),e.file.key,o,i,d,t);break;case g.nb.PROTOTYPE:(0,eh.D4)(e.prototype.url,e.prototype.file_key,e.prototype.page_id,o);break;case g.nb.REPO:let n=(0,b.mr)(e.repo,e.branches,s);eu.Ay.redirect((0,b.CE)(n,e.repo,"file"),"_blank");break;case g.nb.OFFLINE_FILE:i(em.NA({file:e.file,openNewFileIn:eE.ai.NEW_TAB,source:ey.U.OFFLINE_FILE_TILE}));return;default:(0,T.xb)(e)}})(t)}:null,[I.W.OPEN_WITH_DISABLED_PREVIEW]:p?{displayText:(0,w.t)("tile.dropdown.open_with_disabled_preview"),recordingKey:"open-with-disabled-preview",callback:()=>(e=>{switch(l&&l(),e.type){case g.nb.FILE:case g.nb.PINNED_FILE:if(e.file.editorType===eo._Y.FIGMAKE){let t=(0,C.jN)({file:e.file,disablePreview:!0});(0,eh.nz)(t,e.file.key,o,i,d)}}})(t)}:null}},[n,r.open,t,l,o,i,d,s,e])}({openTile:r,tile:_,tileActions:y,tileSelectCounts:e2,trackSearchFn:M}),ti=function({tileSelect:e,tileActions:t,tileSelectCounts:r}){let n=(0,f.wA)(),{fileKeysByRepoId:l}=(0,h.R)(e=>({fileKeysByRepoId:e.fileKeysByRepoId}));return a.useMemo(()=>{let a,{numOfflineFilesSelected:i}=r,o=Object.keys(e[F.F.FILES]).length+Object.keys(e[F.F.REPOS]).length+Object.keys(e[F.F.PROTOTYPES]).length,s=!!(t.removeFromRecents&&o>0);return{[I.W.REMOVE_FROM_RECENTS]:s?(a=i>0,{displayText:(0,w.t)("tile.dropdown.remove_from_recent_pluralized",{numFiles:o}),recordingKey:"remove-from-recents",callback:()=>{let t=Object.keys(e[F.F.REPOS]);t.length>0&&n(ev.iC({recent_repo_ids:t}));let r=[];for(let e of t)r=r.concat(l[e]);let a=Object.keys(e[F.F.FILES]).concat(r),i=a.map(e=>({key:e}));for(let t of(i.length>0&&(0,eb.yN)(i.map(e=>e.key)).catch(e=>{throw n(L.s.error((0,w.t)("file_browser.file_browser_actions.recently_viewed_error",{numFiles:a.length}))),e}),Object.keys(e[F.F.PROTOTYPES]))){let[e,r,a]=t.split(",");n(eg.tl({fileKey:e,pageId:r}))}n(V.an())},disabled:a}):null}},[n,l,t.removeFromRecents,e,r])}({tileSelect:eW,tileActions:y,tileSelectCounts:e2}),to=function({tileSelect:e,tileActions:t,tile:r}){let n=(0,f.wA)();return a.useMemo(()=>{let a=Object.keys(e[F.F.FILES]).length+Object.keys(e[F.F.PROTOTYPES]).length,l=!!(t.removeFromSharedFiles&&1===a);return{[I.W.REMOVE_FROM_SHARED_FILES]:l?{displayText:(0,w.t)("tile.dropdown.remove_from_shared_files"),recordingKey:"remove-from-shared-files",callback:()=>{let e,t,a;return e="",t="",r.type===g.nb.FILE?(e=r.sharedWithYouFields?.id??"",t=r.file.name??""):r.type===g.nb.PROTOTYPE&&(e=r.prototype.shared_with_you_id??"",t=r.prototype.fig_file?.name??r.prototype.name??""),a=async()=>{try{await (0,eb.LG)(e)}catch(e){n(L.s.error((0,w.t)("file_browser.file_browser_actions.remove_files_from_shared_files")))}},void n(X.to({type:eF.q,data:{fileName:t,onRemove:a}}))}}:null}},[n,t.removeFromSharedFiles,r,e])}({tileSelect:eW,tileActions:y,tile:_}),ts=function({tileData:e,tileSelectCounts:t,tileActions:r,tile:n}){let l=(0,f.wA)(),{selectedBranchKeyByRepoId:i}=(0,h.R)(e=>({selectedBranchKeyByRepoId:e.selectedBranchKeyByRepoId})),o=D(),s=(0,er.Xr)(g.Y6);return a.useMemo(()=>{let{filePerms:a,repoPerms:d}=e,{numFilesSelected:c,numReposSelected:u,numOfflineFilesSelected:p,isSingleTileSelected:_}=t,f=a?.canRename,m=d?.canRename,h=!!(r.rename&&_&&(1===c&&f||1===u&&m||1===p)),y=n.type===g.nb.FILE||n.type===g.nb.REPO||n.type===g.nb.OFFLINE_FILE;return{[I.W.RENAME]:h&&y?(e=>{switch(e.type){case g.nb.FILE:return{displayText:(0,w.t)("tile.dropdown.rename"),recordingKey:"rename",callback:()=>{s({type:"FILE",id:e.file.key}),l(V.an()),o()}};case g.nb.REPO:let t=(0,b.mr)(e.repo,e.branches,i);return{displayText:(0,b.SA)(t,e.repo)?(0,w.t)("tile.dropdown.rename"):(0,w.t)("tile.dropdown.rename_file"),recordingKey:"rename",callback:()=>{s({type:"REPO",id:e.repo.id}),l(V.an()),o()}};case g.nb.OFFLINE_FILE:return{displayText:(0,w.t)("tile.dropdown.rename"),recordingKey:"rename",callback:()=>{var t;return t=e.file,void((0,U.dm)(t),l(V.an()),o())}};default:(0,T.xb)(e)}})(n):null}},[l,r.rename,e,t,i,s,n,o])}({tileData:eX,tileSelectCounts:e2,tileActions:y,tile:_}),td=function({tile:e,tileActions:t,tileData:r,tileSelectCounts:n}){let l=(0,f.wA)(),{selectedBranchKeyByRepoId:i}=(0,h.R)(e=>({selectedBranchKeyByRepoId:e.selectedBranchKeyByRepoId})),o=D();return a.useMemo(()=>{let a=e=>{l(ex.Z({fileKey:e.key})),o()},{fileOrPinnedFile:s,repo:d,filePerms:c,repoPerms:u}=r,{numFilesSelected:p,numReposSelected:_,isSingleTileSelected:f}=n,m=s?.editorType===eo._Y.FIGMAKE,h=c?.canRestoreFromVersion,y=!!d&&u?.canEditBranch(i[d.id]),E=!!(t.restoreFromVersion&&f&&(1===p&&h||1===_&&y)&&!m);return{[I.W.RESTORE_FROM_VERSION]:E?(e=>{switch(e.type){case g.nb.FILE:return{displayText:(0,w.t)("fullscreen_actions.toggle-version-history"),recordingKey:"restore-from-version",callback:()=>{a(e.file)}};case g.nb.REPO:let t=(0,b.mr)(e.repo,e.branches,i);return{displayText:(0,w.t)("fullscreen_actions.toggle-version-history"),recordingKey:"restore-from-version",callback:()=>{a(t)}};default:(0,T.wc)(I.W.RESTORE_FROM_VERSION)}})(e):null}},[l,t.restoreFromVersion,r,n,i,e,o])}({tile:_,tileActions:y,tileData:eX,tileSelectCounts:e2}),tc=function({tileActions:e,tileSelectCounts:t,tileData:r,tile:n}){let i=(0,Y.FC)(),o=(0,f.wA)(),{user:s}=i,{selectedBranchKeyByRepoId:d}=(0,h.R)(e=>({selectedBranchKeyByRepoId:e.selectedBranchKeyByRepoId})),c=(0,K.TA)(),{hasPendingRequest:u,getUpgradeEligibility:p,getUpgradePathway:_}=(0,ek.wH)({folderId:n.type===g.nb.FILE?n.file.folderId:null,fileInBrowser:n.type===g.nb.FILE?n.file:void 0}),m=(0,ed.aI)(),{fileOrPinnedFile:y,filePerms:E,repoDefaultFileLG:F}=r,x=(0,eA.mu)(n.type===g.nb.FILE?v.F.toSinatra(n.file):null,c),T=(0,eT.a9)(),R=n.type===g.nb.REPO?F:y,k=(0,a.useMemo)(()=>{let e=g.Tf.getEditorType(n);if(!s||!e||!R)return null;let t=v.F.toSinatra(R),r=E?.mustUpgradeToShareDraft??!1;return p((0,ew.wR)(e),!(0,eC.l)({file:{...t,mustUpgradeToShareDraft:r},user:s,orgUser:T,orgDraftsOwner:T,teamUser:x}))},[n,R,s,x,p,T,E?.mustUpgradeToShareDraft]);return a.useMemo(()=>{var r;let a,i,s,{numFilesSelected:c,numPinnedFilesSelected:p,numReposSelected:f,isSingleTileSelected:h}=t,v=y?.editorType===eo._Y.FIGMAKE&&!m,F=!!(e.share&&h&&(1===c||1===p||1===f)&&!E?.isFileTypeDisabled&&!v);return{[I.W.SHARE]:F?(r=n,a=(()=>{switch(r.type){case g.nb.FILE:case g.nb.PINNED_FILE:return r.file;case g.nb.REPO:return(0,b.mr)(r.repo,r.branches,d);default:return(0,eI.$D)(l.FigmaTeam.WAYFINDING,Error("Invalid tile type when rendering DropdownActionOptions.SHARE"),{extra:{"tile.type":r.type,numFilesSelected:c,numPinnedFilesSelected:p,numReposSelected:f}}),null}})(),i=g.Tf.getEditorType(r),s=(0,ew.wR)(i),{displayText:(0,w.t)("tile.dropdown.share"),recordingKey:"share",callback:()=>{a&&o(X.to({type:eS.g_,data:{fileKey:a.key,source:eR.nk.fileBrowserTileActionMenu}}))},sideText:(e=>{if(k!==eO.q.UPGRADE_NOT_NEEDED&&_(e)!==eO.J.AUTO_PATHWAY)return u(e)?(0,w.t)("upgrades.request_sent"):(0,w.t)("upgrades.request")})(s),rightJustifySideText:!0,disabled:!!u(s)&&k===eO.q.CANNOT_UPGRADE}):null}},[o,y?.editorType,E?.isFileTypeDisabled,_,u,e.share,t,k,d,m,n])}({tileSelectCounts:e2,tileData:eX,tileActions:y,tile:_}),tu=function({tileSelectCounts:e,tileData:t}){let r=(0,f.wA)();return a.useMemo(()=>{let{fileOrPinnedFile:n,filePerms:a}=t,{isSingleTileSelected:l}=e,i=!!a?.canUseInNewFile;return{[I.W.USE_IN_NEW_FILE]:l&&n&&i?(0,eP.rC)({dispatch:r,fileKey:n.key,templateName:n.name}):null}},[r,t,e])}({tileSelectCounts:e2,tileData:eX}),tp=function({permsByFileKey:e,permsByRepoId:t,selectedFileKeys:r,selectedRepoIds:n,selectedTiles:l,tile:i,tileActions:o,tileData:s,tileSelectCounts:d}){let c=(0,Y.FC)(),u=(0,f.wA)(),{user:p,currentUserOrgId:_}=c,m=D(),h=a.useMemo(()=>(0,P.g4)(r,e)||[],[e,r]),y=a.useMemo(()=>(0,P.SW)(r,e)||[],[e,r]),E=a.useMemo(()=>(0,P.m8)(r,e)||[],[e,r]),F=a.useMemo(()=>(0,j._H)(n,t)||[],[t,n]),x=a.useMemo(()=>(0,j.CS)(n,t)||[],[t,n]),T=a.useMemo(()=>(0,j.gX)(n,t)||[],[t,n]),{file:R,repo:k,filePerms:O,repoPerms:S}=s,{numFilesSelected:C,numPinnedFilesSelected:A,numPrototypesSelected:N,numReposSelected:M,numOfflineFilesSelected:W}=d,U=(0,es.jB)({files:R?[v.F.toSinatra(R)]:[],repos:k?[k]:[],destinationFolderId:g.Tf.getFolderId(i),isDestinationDrafts:!1});return a.useMemo(()=>{let a,i,s,d,c=(0,z.R$)(p,_),f=T.length+E.length,R=F.length+h.length,k=x.length+y.length,D=!!(o.trashPageActions&&f>0),K=!!(o.trashPageActions&&R>0&&!c),V=!!(o.trashPageActions&&k>0&&!c&&!(o.trashPageActions&&R>0)),Y=C+A+M,$=1===Y,q=h.length<C||F.length<M||N>0||W>0,G=y.length<C||x.length<M,Q="";return $||(Q=(0,w.t)("tile.dropdown.multiple_file_suffix",{totalSelected:Y})),{[I.W.RESTORE]:K?(a=Q,{displayText:(0,w.t)("tile.dropdown.restore",{objectText:a,numFiles:Y}),recordingKey:"restore",callback:()=>{let a,l;return a=(0,P.g4)(r,e),l=(0,j._H)(n,t),void(0===a.length+l.length?u(L.s.error((0,w.t)("tile.dropdown.no_permission_to_restore_error"))):(u((0,H.b4)({fileKeys:a,repoIds:l})),m()))},disabled:q}):null,[I.W.RESTORE_TO]:V?(i=Q,{displayText:(0,w.t)("tile.dropdown.restore_to",{objectText:i,numFiles:Y}),recordingKey:"restore-to",callback:()=>((e,t)=>{let r=y.length+x.length;if(0===r)return void u(L.s.error((0,w.t)("tile.dropdown.no_permission_to_restore_error")));if(1===r){let r=l[0];if(r?.type===g.nb.FILE)(0,ei.h)(v.F.toSinatra(r.file),null,u,void 0,void 0,{canMove:!!e?.canMove,isUserViewerRestricted:!!e?.isUserRestrictedForSeat,planUser:e?.planUser??null,inDrafts:!!e?.isDraftFile,draftsMoveData:U,canMoveWithReasons:e?.canMoveWithReasons},void 0,!0);else if(r?.type===g.nb.REPO){let e=r.branches.find(e=>(0,b.SA)(e,r.repo));(0,ei.h)(e??null,r.repo,u,void 0,void 0,{canMove:!!t?.canMove,isUserViewerRestricted:!!t?.isUserRestrictedForSeat,planUser:t?.planUser??null,inDrafts:!!t?.isDraftRepo,draftsMoveData:U,canMoveWithReasons:t?.canMoveWithReasons},void 0,!0)}}else{let e=l.filter(e=>e.type===g.nb.FILE).map(e=>v.F.toSinatra(e.file)),t=l.filter(e=>e.type===g.nb.REPO).map(e=>e.repo);(0,ei.O)(e,t,u,void 0,!0)}})(O,S),disabled:G}):null,[I.W.DELETE_FOREVER]:D?(s=Q,d=f<C||N>0||W>0,{displayText:(0,w.t)("tile.dropdown.delete_forever",{objectText:s}),recordingKey:"delete-forever",callback:()=>{let a=(0,P.m8)(r,e),l=(0,j.gX)(n,t);a.length+l.length<r.length+n.length?u(L.s.error((0,w.t)("flash.dont_have_permission_permanently_delete_files"))):(u(B.Fh({fileKeys:a,repoIds:l})),m())},disabled:d}):null}},[_,u,U,O,E.length,T.length,C,W,A,N,M,e,t,l,o.trashPageActions,S,h.length,F.length,y.length,x.length,r,n,m,p])}({permsByFileKey:i,permsByRepoId:d,selectedFileKeys:eD,selectedRepoIds:eB,selectedTiles:c,tile:_,tileActions:y,tileData:eX,tileSelectCounts:e2}),t_=function({loadedQueries:e,tileActions:t,tileData:r,tileSelectCounts:n}){let l=(0,f.wA)(),i=(0,u.GI)("tile_action_dropdown"),o=D();return a.useMemo(()=>{let a,s,d,{file:c,repoDefaultFile:u}=r,{numFilesSelected:p,numReposSelected:_,isSingleTileSelected:f}=n,m=c?.key||u?.key;return{[I.W.PIN_FILE_TO_WORKSPACE]:m&&f&&(1===p||1===_)&&t.pinToWorkspace&&e.fileWorkspacePinActions&&e.fileWorkspacePinActions.shouldShowPinFileToWorkspaceAction?(a=!!e.fileWorkspacePinActions&&e.fileWorkspacePinActions.workspaceHasMaxPins,{displayText:(0,w.t)("tile.dropdown.pin_to_workspace"),recordingKey:"pin-file-to-workspace",callback:()=>i(m,a)}):null,[I.W.EDIT_WORKSPACE_PIN]:t.pinToWorkspace&&1===p&&e.fileWorkspacePinActions&&e.fileWorkspacePinActions.canEditPin?(s=e.fileWorkspacePinActions.existingFilePinId,{displayText:(0,w.t)("tile.dropdown.edit_workspace_pin"),recordingKey:"edit-workspace-pin",callback:()=>{l(X.to({type:(0,eN.l)(),data:{pinnedFileId:s}})),o()}}):null,[I.W.UNPIN_FILE_FROM_WORKSPACE]:t.pinToWorkspace&&f&&e.fileWorkspacePinActions&&e.fileWorkspacePinActions.canEditPin?(d=e.fileWorkspacePinActions.existingFilePinId,{displayText:(0,w.t)("tile.dropdown.remove_workspace_pin"),recordingKey:"unpin-file-from-workspace",callback:()=>{l(X.to({type:(0,ej.I)(),data:{pinnedFileId:d}})),o()}}):null}},[l,e.fileWorkspacePinActions,t.pinToWorkspace,r,n,o,i])}({loadedQueries:e,tileActions:y,tileData:eX,tileSelectCounts:e2}),tf=eM?.data;if(!tf)return null;let tm=eJ+eZ+e1,th=[[ta[I.W.SHOW_IN_FOLDER],tl[I.W.OPEN],tl[I.W.OPEN_NEW_TAB],tl[I.W.OPEN_WITH_DISABLED_PREVIEW]].filter(m.Vq),[e8[I.W.CREATE_BRANCH]].filter(m.Vq),[tt[I.W.FILE_ANALYTICS]].filter(m.Vq),[te[I.W.FAVORITE_FILE],te[I.W.FAVORITE_PROTOTYPE],te[I.W.FAVORITE_REPO],te[I.W.UNFAVORITE_FILE],te[I.W.UNFAVORITE_PROTOTYPE],te[I.W.UNFAVORITE_REPO],tr[I.W.PIN_FILE_TO_FOLDER],tr[I.W.PIN_REPO_TO_FOLDER],tr[I.W.UNPIN_FILE_FROM_FOLDER],tr[I.W.UNPIN_REPO_FROM_FOLDER],t_[I.W.PIN_FILE_TO_WORKSPACE],t_[I.W.EDIT_WORKSPACE_PIN],t_[I.W.UNPIN_FILE_FROM_WORKSPACE]].filter(m.Vq),[e3[I.W.COPY_LINK],tc[I.W.SHARE],e9[I.W.DUPLICATE],e9[I.W.DUPLICATE_TO_DRAFTS],tu[I.W.USE_IN_NEW_FILE]].filter(m.Vq),[td[I.W.RESTORE_FROM_VERSION],ts[I.W.RENAME],tn[I.W.MOVE_FILE],e7[I.W.DELETE],ti[I.W.REMOVE_FROM_RECENTS],to[I.W.REMOVE_FROM_SHARED_FILES],tp[I.W.RESTORE],tp[I.W.RESTORE_TO],tp[I.W.DELETE_FOREVER]].filter(m.Vq)],ty=[];return th.filter(e=>e.length>0).forEach(e=>{ty.length>0&&ty.push({displayText:"",separator:!0}),ty.push(...e)}),(0,n.jsx)(E,{portalTarget:document.body,children:(0,n.jsx)(x.j,{autofocusPrevOnDismount:!0,dispatch:eL,items:ty,lean:"right",minWidth:1===tm?void 0:140,onMount:t,onSelectItem:(e,t)=>{e.callback&&e.callback("",{},eL,t)},parentRect:tf.targetRect,recordingKey:"tile-dropdown",showPoint:!1})})}function eM(e){let t,r,i,s,d,c,p,_,m,y,M,eL,eM,eW,eD,eB,eU,eK,eV,eH,eY=(0,Y.FC)(),ez=(0,f.wA)(),{user:e$,currentUserOrgId:eq}=eY,{dropdownShown:eG,openFileFolderId:eQ,selectedView:eX,pinnedFileKeys:eJ,selectedBranchKeyByRepoId:eZ,fileKeysByRepoId:e0,isOnDeleted:e1,attributionContextKey:e5}=(0,h.R)(e=>({dropdownShown:e.dropdownShown,openFileFolderId:e.openFile?.folderId,selectedView:e.selectedView,tileSelect_REDUX:e.tileSelect,pinnedFileKeys:e.pinnedFileKeys,selectedBranchKeyByRepoId:e.selectedBranchKeyByRepoId,fileKeysByRepoId:e.fileKeysByRepoId,isOnDeleted:"deletedFiles"===e.selectedView.view,attributionContextKey:e.sharingAttributionContextKey})),e4=e.tile,e6=(0,K.TA)(),[e2]=(0,N.IT)((0,U.OL)({userId:e6})),e8=(0,a.useMemo)(()=>e2?.data??{},[e2]),e3=(0,o.gS)(e.selectedTiles),e7=e4.type===g.nb.FILE?e4.file?.teamId:void 0,e9=(0,q.vt)(e7),te=(0,$.jn)(),{hasPendingRequest:tt,getUpgradeEligibility:tr,getUpgradePathway:tn}=(0,ek.wH)({folderId:e4.type===g.nb.FILE?e4.file.folderId:null,fileInBrowser:e4.type===g.nb.FILE?e4.file:void 0}),ta=(0,u.GI)("tile_action_dropdown"),{Sprig:tl}=(0,W.A)(),ti=(0,el.bY)("file_multi_move_limit").getDynamicConfig().get("fileLimit",100),to=D(),ts=(0,er.Xr)(g.Y6),td=e=>{ez(ex.Z({fileKey:e.key})),to()},tc=()=>{ez((0,H.n_)({toDraft:!1,tileSelect:e3})),ez(V.an()),to()},tu=()=>{let{selectedCount:t,deletableCount:r,allDrafts:n,filesByKey:a,reposById:l,offlineFilesByKey:i}=B.Mw(e.selectedTiles,e.permsByFileKey,e.permsByRepoId);if(r<t){let e=(0,w.t)("tile.dropdown.no_permission_to_trash_error");ez(L.s.error(e));return}ez(B.U1({filesByKey:a,reposById:l,offlineFilesByKey:i,allDrafts:n})),to()},tp=()=>{let t=(0,P.m8)(tv,e.permsByFileKey),r=(0,j.gX)(tx,e.permsByRepoId);t.length+r.length<tv.length+tx.length?ez(L.s.error((0,w.t)("flash.dont_have_permission_permanently_delete_files"))):(ez(B.Fh({fileKeys:t,repoIds:r})),to())},t_=()=>{let t=(0,P.g4)(tv,e.permsByFileKey),r=(0,j._H)(tx,e.permsByRepoId);0===t.length+r.length?ez(L.s.error((0,w.t)("tile.dropdown.no_permission_to_restore_error"))):(ez((0,H.b4)({fileKeys:t,repoIds:r})),to())},tf=()=>{ez((0,H.g4)({tileSelect:e3})),ez(V.an()),to()},tm=()=>{let e=Object.keys(e3[F.F.REPOS]);e.length>0&&ez(ev.iC({recent_repo_ids:e}));let t=[];for(let r of e)t=t.concat(e0[r]);let r=Object.keys(e3[F.F.FILES]).concat(t),n=r.map(e=>({key:e}));for(let e of(n.length>0&&(0,eb.yN)(n.map(e=>e.key)).catch(e=>{throw ez(L.s.error((0,w.t)("file_browser.file_browser_actions.recently_viewed_error",{numFiles:r.length}))),e}),Object.keys(e3[F.F.PROTOTYPES]))){let[t,r,n]=e.split(",");ez(eg.tl({fileKey:t,pageId:r}))}ez(V.an())},th=()=>{let t=e.sourceFile,r=e.loadedQueries.createBranchStatus;if(!t||!r)return;let n=k.e0.FILE_BROWSER;switch(r.status){case"upsell-org":ez(R.j({trackingContextName:n}));break;case"enabled":ez(R.l({trackingContextName:n,sourceFileKey:t.key,dispatchedFromEditor:!1}));break;case"disabled":case"hidden":break;default:(0,T.xb)(r.status)}},ty=(e,t,r)=>{let n={file:e,sectionId:t,entrypoint:"dropdown",fileBrowserFavorite:!0};r?ez(G.Fb(n)):ez(G.qP(n)),to()},tE=(e,t)=>{let r={prototype:e,entrypoint:"dropdown",fileBrowserEntryPoint:!0};t?ez(G.iN(r)):ez(G.X7(r))},tb=(e,t,r,n)=>{let a=e.is_favorited&&t.some(e=>e.id===r?.id);return{recordingKey:"add-to-sidebar",displayText:e.is_favorited?`${(0,w.t)("favorited_resources.indicate_section_prefix")}: ${r?.name||(0,w.t)("sidebar.starred")}`:(0,w.t)("favorited_resources.add_to_sidebar"),children:t.map(({id:e,name:t})=>({recordingKey:"add-to-sidebar-section",displayText:""===t?(0,w.t)("sidebar.starred"):t,isChecked:r?.id===e,alwaysShowCheckMarkOffset:a,callback:()=>n(e)}))}},tg=(e,t,r,n)=>{if(null===e.default_file_key)return void console.error("Repo file key should not be null");let a={file:v.F.toLiveGraph(t),repoId:e.id,sectionId:r,entrypoint:"dropdown",fileBrowserFavorite:!0};n?ez(G.Fb(a)):ez(G.qP(a))},tv=a.useMemo(()=>Object.keys(e3[F.F.FILES]),[e3]),tF=a.useMemo(()=>Object.keys(e3[F.F.PINNED_FILES]),[e3]),tx=a.useMemo(()=>Object.keys(e3[F.F.REPOS]),[e3]),tI=a.useMemo(()=>(0,P.Ul)(tv,e.permsByFileKey)||[],[e.permsByFileKey,tv]),tT=a.useMemo(()=>(0,P.n)(tv,e.permsByFileKey)||[],[e.permsByFileKey,tv]),tw=a.useMemo(()=>(0,P.g4)(tv,e.permsByFileKey)||[],[e.permsByFileKey,tv]),tR=a.useMemo(()=>(0,P.SW)(tv,e.permsByFileKey)||[],[e.permsByFileKey,tv]),tk=a.useMemo(()=>(0,P.v_)(tv,e.permsByFileKey).length,[e.permsByFileKey,tv]),tO=a.useMemo(()=>(0,P.v_)(tF,e.permsByFileKey).length,[e.permsByFileKey,tF]),tS=a.useMemo(()=>(0,P.m8)(tv,e.permsByFileKey)||[],[e.permsByFileKey,tv]),tC=a.useMemo(()=>{let t={};for(let r of e.selectedTiles.filter(e=>e.type===g.nb.REPO)){let e=r.repo.id,n=eZ[e],a=r.repo.default_file_key;n?t[e]=n:a&&(t[e]=a)}return t},[e.selectedTiles,eZ]),tA=a.useMemo(()=>e1?Object.keys(e3[F.F.REPOS]).length:((0,j.nL)(tx,tC,e.permsByRepoId)||[]).length,[e1,e.permsByRepoId,e3,tx,tC]),tP=a.useMemo(()=>(0,j.zj)(tx,e.permsByRepoId)||[],[e.permsByRepoId,tx]),tj=a.useMemo(()=>(0,j._H)(tx,e.permsByRepoId)||[],[e.permsByRepoId,tx]),tN=a.useMemo(()=>(0,j.CS)(tx,e.permsByRepoId)||[],[e.permsByRepoId,tx]),tL=a.useMemo(()=>(0,j.gX)(tx,e.permsByRepoId)||[],[e.permsByRepoId,tx]),tM=a.useMemo(()=>Object.keys((0,U.gp)(e3[F.F.OFFLINE_FILES],{offlineFiles:e8})),[e8,e3]),tW=a.useMemo(()=>(0,j.ae)(tx,e.permsByRepoId)||[],[e.permsByRepoId,tx]),tD=a.useMemo(()=>Object.keys(e3[F.F.FILES]).length+Object.keys(e3[F.F.REPOS]).length+Object.keys(e3[F.F.PROTOTYPES]).length,[e3]),tB=a.useMemo(()=>Object.keys(e3[F.F.FILES]).length+Object.keys(e3[F.F.PROTOTYPES]).length,[e3]),tU=a.useMemo(()=>Object.keys(e3[F.F.FILES]).length+Object.keys(e3[F.F.REPOS]).length,[e3]),tK=a.useMemo(()=>{let t=new Set,r=new Set;return tv.forEach(n=>{let a=e.permsByFileKey[n];a&&(t.add(a.planType||""),r.add(a.planId||""))}),tx.forEach(n=>{let a=e.permsByRepoId[n];a&&(t.add(a.planType||""),r.add(a.planId||""))}),1===t.size&&(t.has("team")||1===r.size)},[e.permsByFileKey,e.permsByRepoId,tv,tx]),tV=(0,ed.aI)(),tH=e4.type===g.nb.FILE?e4.file:null,tY=e4.type===g.nb.PINNED_FILE?e4.file:null,tz=tY||tH,t$=e4.type===g.nb.REPO?e4.repo:null,tq=(tz&&e.permsByFileKey[tz.key])??null,tG=(t$&&e.permsByRepoId[t$.id])??null,tQ=e.tile.type===g.nb.PROTOTYPE?e.tile.prototype:null,tX=null!=t$&&e4.branches?e4.branches.find(e=>(0,b.SA)(e,t$)):null,tJ=tX?v.F.toLiveGraph(tX):null,tZ=e.tile.type===g.nb.OFFLINE_FILE?e.tile.file:null,t0=(0,eA.mu)(e.tile.type===g.nb.FILE?v.F.toSinatra(e.tile.file):null,e6),t1=(0,eT.a9)(),t5=e4.type===g.nb.REPO?tJ:tz,t4=(0,a.useMemo)(()=>{let e=g.Tf.getEditorType(e4);if(!e$||!e||!t5)return null;let t=v.F.toSinatra(t5),r=tq?.mustUpgradeToShareDraft??!1;return tr((0,ew.wR)(e),!(0,eC.l)({file:{...t,mustUpgradeToShareDraft:r},user:e$,orgUser:t1,orgDraftsOwner:t1,teamUser:t0}))},[e4,t5,e$,t0,tr,t1,tq?.mustUpgradeToShareDraft]),t6=Object.keys(e3[F.F.FILES]).length,t2=Object.keys(e3[F.F.PINNED_FILES]).length,t8=Object.keys(e3[F.F.PROTOTYPES]).length,t3=Object.keys(e3[F.F.REPOS]).length,t7=Object.keys(e3[F.F.OFFLINE_FILES]).length,t9=(0,es.jB)({files:tH?[v.F.toSinatra(tH)]:[],repos:t$?[t$]:[],destinationFolderId:g.Tf.getFolderId(e4),isDestinationDrafts:!1}),re=(0,es.Cp)(t9.destinationPlan?.key||null,t9.licenseType),rt=e.selectedTiles.filter(e=>e.type===g.nb.FILE).map(e=>e.file).some(e=>e.editorType===eo._Y.FIGMAKE)&&t9.requiresUpgrade&&!tV,rr=(0,Z.D6)("TileActionDropdown"),rn=(0,Z.Kd)(rr).unwrapOr(!1),ra=(0,er.md)(ea.V1),rl=eG?.data;if(!rl)return null;let ri=t6+t2+t3,ro=ri+t7,rs=t6+t2+t3+t8+t7,rd=1===ri,rc=1===ro;if(0===rs)return(0,n.jsx)("div",{});let ru=!0,rp=!0,r_=!0,rf=!1,rm=!0,rh=!0,ry=!0;(tT.length+tP.length+tM.length<t6||t8>0)&&(ru=!1),(tS.length+tL.length<t6||t8>0||t7>0)&&(rp=!1),(tw.length<t6||tj.length<t3||t8>0||t7>0)&&(r_=!1),tR.length===t6&&tN.length===t3&&(rf=!0),(tk<t6||tO<t2||tA<t3||t8>0||t7>0)&&(rm=!1),t7>0&&(rh=!1);let rE=tI.length+tW.length;rE<ri&&(ry=!1);let rb="";rd||(rb=(0,w.t)("tile.dropdown.multiple_file_suffix",{totalSelected:ri}));let rg="";rc||(rg=(0,w.t)("tile.dropdown.multiple_file_suffix",{totalSelected:ro}));let rv=(r=(t=(0,Q.D6)(eq))?(0,w.t)("favorited_resources.remove_from_sidebar"):(0,w.t)("tile.favoriting.remove_from_favorites"),{[I.W.COPY_LINK]:e=>({displayText:(0,w.t)("tile.dropdown.copy_link"),recordingKey:"copy-link",callback:()=>(e=>{switch(e.type){case g.nb.FILE:let t=e.file;ez(S.S({fileKey:t.key,url:(0,C.jN)({file:t,attributionContext:(0,A.b)(e5,A.d.FILE_TILE_CONTEXT_MENU),allowDefaulting:!0}),source:A.d.FILE_TILE_CONTEXT_MENU}));break;case g.nb.PINNED_FILE:ez(S.S({fileKey:e.file.key,url:(0,C.jN)({file:e.file,attributionContext:(0,A.b)(e5,A.d.FILE_TILE_CONTEXT_MENU),allowDefaulting:!0}),source:A.d.FILE_TILE_CONTEXT_MENU}));break;case g.nb.PROTOTYPE:ez(O.S({url:(0,C.Kw)({base:"proto",file:{key:e.prototype.file_key},nodeId:e.prototype.page_id,attributionContext:(0,A.b)(e5,A.d.FILE_TILE_CONTEXT_MENU)})}));break;case g.nb.REPO:let r=(0,b.mr)(e.repo,e.branches,eZ);ez(S.S({fileKey:r.key,url:(0,b.CE)(r,e.repo,"file"),source:A.d.FILE_TILE_CONTEXT_MENU}))}})(e)}),[I.W.DELETE]:(e,t,r)=>{let n=!1;if(e.type===g.nb.REPO){let t=(0,b.mr)(e.repo,e.branches,eZ);n=!(0,b.SA)(t,e.repo)}return{displayText:n?(0,w.t)("tile.dropdown.move_file_and_branches_to_trash"):1===rs?(0,w.t)("tile.dropdown.trash_single_tile"):(0,w.t)("tile.dropdown.trash_file",{objText:t}),recordingKey:"delete",callback:tu,disabled:r}},[I.W.DUPLICATE]:(e,t)=>({displayText:1===rs?(0,w.t)("tile.dropdown.duplicate_single_tile"):(0,w.t)("tile.dropdown.duplicate",{objText:e}),recordingKey:"duplicate",callback:tc,disabled:t}),[I.W.DUPLICATE_TO_DRAFTS]:(e,t)=>({displayText:1===ri?(0,w.t)("tile.dropdown.duplicate_to_draft_single_file_or_repo"):(0,w.t)("tile.dropdown.duplicate_to_draft",{objText:e}),recordingKey:"duplicate-to-drafts",callback:tf,disabled:t}),[I.W.OPEN]:()=>({displayText:(0,w.t)("tile.dropdown.open"),recordingKey:"open",callback:(t,r,n,a)=>{e.openTile(a)}}),[I.W.OPEN_NEW_TAB]:t=>({displayText:(0,w.t)("tile.dropdown.open_new_tab"),recordingKey:"open-new-tab",callback:()=>(t=>{e.trackSearchFn&&e.trackSearchFn();let r=void 0===e.trackSearchFn;switch(t.type){case g.nb.FILE:let n=(0,C.rl)(t.file);(0,eh.nz)(n,t.file.key,eX,ez,tl,r);break;case g.nb.PINNED_FILE:(0,eh.nz)((0,C.jN)(t),t.file.key,eX,ez,tl,r);break;case g.nb.PROTOTYPE:(0,eh.D4)(t.prototype.url,t.prototype.file_key,t.prototype.page_id,eX);break;case g.nb.REPO:let a=(0,b.mr)(t.repo,t.branches,eZ);eu.Ay.redirect((0,b.CE)(a,t.repo,"file"),"_blank");break;case g.nb.OFFLINE_FILE:ez(em.NA({file:t.file,openNewFileIn:eE.ai.NEW_TAB,source:ey.U.OFFLINE_FILE_TILE}));return;default:(0,T.xb)(t)}})(t)}),[I.W.OPEN_WITH_DISABLED_PREVIEW]:t=>({displayText:(0,w.t)("tile.dropdown.open_with_disabled_preview"),recordingKey:"open-with-disabled-preview",callback:()=>(t=>{switch(e.trackSearchFn&&e.trackSearchFn(),t.type){case g.nb.FILE:case g.nb.PINNED_FILE:if(t.file.editorType===eo._Y.FIGMAKE){let e=(0,C.jN)({file:t.file,disablePreview:!0});(0,eh.nz)(e,t.file.key,eX,ez,tl)}}})(t)}),[I.W.PIN_FILE_TO_FOLDER]:e=>({displayText:(0,w.t)("tile.dropdown.pin_to_project"),recordingKey:"pin-file-to-folder",callback:()=>{null!=e.folderId&&ez(en.gO({folderId:e.folderId,teamId:e.teamId,fileKey:e.key})),to()}}),[I.W.PIN_REPO_TO_FOLDER]:e=>({displayText:(0,w.t)("tile.dropdown.pin_to_project"),recordingKey:"pin-repo-to-folder",callback:()=>{null!=e.folder_id&&null!=e.default_file_key&&ez(en.gO({folderId:e.folder_id,teamId:e.team_id,fileKey:e.default_file_key})),to()}}),[I.W.PIN_FILE_TO_WORKSPACE]:t=>{let r=!!e.loadedQueries.fileWorkspacePinActions&&e.loadedQueries.fileWorkspacePinActions.workspaceHasMaxPins;return{displayText:(0,w.t)("tile.dropdown.pin_to_workspace"),recordingKey:"pin-file-to-workspace",callback:()=>ta(t,r)}},[I.W.REMOVE_FROM_RECENTS]:(e,t)=>({displayText:(0,w.t)("tile.dropdown.remove_from_recent_pluralized",{numFiles:e}),recordingKey:"remove-from-recents",callback:tm,disabled:t}),[I.W.REMOVE_FROM_SHARED_FILES]:e=>({displayText:(0,w.t)("tile.dropdown.remove_from_shared_files"),recordingKey:"remove-from-shared-files",callback:()=>{let t,r,n;return t="",r="",e.type===g.nb.FILE?(t=e.sharedWithYouFields?.id??"",r=e.file.name??""):e.type===g.nb.PROTOTYPE&&(t=e.prototype.shared_with_you_id??"",r=e.prototype.fig_file?.name??e.prototype.name??""),n=async()=>{try{await (0,eb.LG)(t)}catch(e){ez(L.s.error((0,w.t)("file_browser.file_browser_actions.remove_files_from_shared_files")))}},void ez(X.to({type:eF.q,data:{fileName:r,onRemove:n}}))}}),[I.W.RENAME]:e=>{switch(e.type){case g.nb.FILE:return{displayText:(0,w.t)("tile.dropdown.rename"),recordingKey:"rename",callback:()=>{ts({type:"FILE",id:e.file.key}),ez(V.an()),to()}};case g.nb.REPO:let t=(0,b.mr)(e.repo,e.branches,eZ);return{displayText:(0,b.SA)(t,e.repo)?(0,w.t)("tile.dropdown.rename"):(0,w.t)("tile.dropdown.rename_file"),recordingKey:"rename",callback:()=>{ts({type:"REPO",id:e.repo.id}),ez(V.an()),to()}};case g.nb.OFFLINE_FILE:return{displayText:(0,w.t)("tile.dropdown.rename"),recordingKey:"rename",callback:()=>{var t;return t=e.file,void((0,U.dm)(t),ez(V.an()),to())}};default:(0,T.xb)(e)}},[I.W.MOVE_FILE]:(t,r,n)=>({displayText:1===t?(0,w.t)("tile.dropdown.move_file"):(0,w.t)("tile.dropdown.move_object",{objText:r}),recordingKey:"move-file",callback:()=>((t,r,n)=>{if(1===n){let n=e.selectedTiles[0];if(n?.type===g.nb.FILE)(0,ei.h)(v.F.toSinatra(n.file),null,ez,void 0,void 0,{canMove:!!t?.canMove,isUserViewerRestricted:!!t?.isUserRestrictedForSeat,planUser:t?.planUser??null,inDrafts:!!t?.isDraftFile,draftsMoveData:t9,hasConnectedPlanUserInOrg:re,canMoveWithReasons:t?.canMoveWithReasons});else if(n?.type===g.nb.REPO){let e=n.branches.find(e=>(0,b.SA)(e,n.repo));(0,ei.h)(e??null,n.repo,ez,void 0,void 0,{canMove:!!r?.canMove,isUserViewerRestricted:!!r?.isUserRestrictedForSeat,planUser:r?.planUser??null,inDrafts:!!r?.isDraftRepo,draftsMoveData:t9,hasConnectedPlanUserInOrg:re,canMoveWithReasons:r?.canMoveWithReasons})}}else{let t=e.selectedTiles.filter(e=>e.type===g.nb.FILE).map(e=>v.F.toSinatra(e.file)),r=e.selectedTiles.filter(e=>e.type===g.nb.REPO).map(e=>e.repo);(0,ei.O)(t,r,ez)}to()})(tq,tG,t),disabled:n||rt||(0,es.Px)(t9,!!tq?.isFileTypeDisabled,re),sideText:(0,es.zS)(t9,n||!!tq?.isFileTypeDisabled,re),rightJustifySideText:!0}),[I.W.RESTORE_FROM_VERSION]:e=>{switch(e.type){case g.nb.FILE:return{displayText:(0,w.t)("fullscreen_actions.toggle-version-history"),recordingKey:"restore-from-version",callback:()=>{td(e.file)}};case g.nb.REPO:let t=(0,b.mr)(e.repo,e.branches,eZ);return{displayText:(0,w.t)("fullscreen_actions.toggle-version-history"),recordingKey:"restore-from-version",callback:()=>{td(t)}};default:(0,T.wc)(I.W.RESTORE_FROM_VERSION)}},[I.W.SHARE]:e=>{let t=(()=>{switch(e.type){case g.nb.FILE:case g.nb.PINNED_FILE:return e.file;case g.nb.REPO:return(0,b.mr)(e.repo,e.branches,eZ);default:return(0,eI.$D)(l.FigmaTeam.WAYFINDING,Error("Invalid tile type when rendering DropdownActionOptions.SHARE"),{extra:{"tile.type":e.type,numFilesSelected:t6,numPinnedFilesSelected:t2,numReposSelected:t3}}),null}})(),r=g.Tf.getEditorType(e),n=(0,ew.wR)(r);return{displayText:(0,w.t)("tile.dropdown.share"),recordingKey:"share",callback:()=>{t&&ez(X.to({type:eS.g_,data:{fileKey:t.key,source:eR.nk.fileBrowserTileActionMenu}}))},sideText:(e=>{if(t4!==eO.q.UPGRADE_NOT_NEEDED&&tn(e)!==eO.J.AUTO_PATHWAY)return tt(e)?(0,w.t)("upgrades.request_sent"):(0,w.t)("upgrades.request")})(n),rightJustifySideText:!0,disabled:!!tt(n)&&t4===eO.q.CANNOT_UPGRADE}},[I.W.SHOW_IN_FOLDER]:e=>{switch(e.type){case g.nb.FILE:return{displayText:(0,w.t)("tile.dropdown.show_in_project"),recordingKey:"show-in-project-file",callback:()=>(e=>{if(null!=e.file.folderId)if(eq===e.file.parentOrgId)ez(ep.sf({view:"folder",folderId:e.file.folderId})),ez(V.y$({type:F.F.FILES,tiles:[e]}));else{let t=e.file.parentOrgId?`/files/${e.file.parentOrgId}/project/${e.file.folderId}`:`/files/project/${e.file.folderId}`;t=e$?(0,ec.NQ)(t,"fuid",e$.id):t,eu.Ay.redirect(t)}})(e)};case g.nb.REPO:return{displayText:(0,w.t)("tile.dropdown.show_in_project"),recordingKey:"show-in-project-repo",callback:()=>{ez(ep.sf({view:"folder",folderId:e.repo.folder_id})),ez(V.y$({type:F.F.REPOS,tiles:[e]}))}};default:(0,T.wc)(I.W.SHOW_IN_FOLDER)}},[I.W.UNPIN_FILE_FROM_FOLDER]:e=>({displayText:(0,w.t)("tile.dropdown.remove_project_pin"),recordingKey:"unpin-file-from-folder",callback:()=>{let t;null!=(t=e.folderId)&&ez(en.z6({folderId:t,fileKey:e.key})),to()}}),[I.W.UNPIN_REPO_FROM_FOLDER]:e=>({displayText:(0,w.t)("tile.dropdown.remove_project_pin"),recordingKey:"unpin-repo-from-folder",callback:()=>{null!=e.folder_id&&null!=e.default_file_key&&ez(en.z6({folderId:e.folder_id,fileKey:e.default_file_key})),to()}}),[I.W.UNPIN_FILE_FROM_WORKSPACE]:e=>({displayText:(0,w.t)("tile.dropdown.remove_workspace_pin"),recordingKey:"unpin-file-from-workspace",callback:()=>{ez(X.to({type:(0,ej.I)(),data:{pinnedFileId:e}})),to()}}),[I.W.EDIT_WORKSPACE_PIN]:e=>({displayText:(0,w.t)("tile.dropdown.edit_workspace_pin"),recordingKey:"edit-workspace-pin",callback:()=>{ez(X.to({type:(0,eN.l)(),data:{pinnedFileId:e}})),to()}}),[I.W.CREATE_BRANCH]:e=>({displayText:(0,w.t)("tile.dropdown.create_new_branch"),recordingKey:"create-branch",callback:th,disabled:e}),[I.W.DELETE_FOREVER]:(e,t)=>({displayText:(0,w.t)("tile.dropdown.delete_forever",{objectText:e}),recordingKey:"delete-forever",callback:tp,disabled:t}),[I.W.RESTORE]:(e,t,r)=>({displayText:(0,w.t)("tile.dropdown.restore",{objectText:e,numFiles:r}),recordingKey:"restore",callback:t_,disabled:t}),[I.W.RESTORE_TO]:(t,r,n)=>({displayText:(0,w.t)("tile.dropdown.restore_to",{objectText:t,numFiles:n}),recordingKey:"restore-to",callback:()=>((t,r)=>{let n=tR.length+tN.length;if(0===n)return void ez(L.s.error((0,w.t)("tile.dropdown.no_permission_to_restore_error")));if(1===n){let n=e.selectedTiles[0];if(n?.type===g.nb.FILE)(0,ei.h)(v.F.toSinatra(n.file),null,ez,void 0,void 0,{canMove:!!t?.canMove,isUserViewerRestricted:!!t?.isUserRestrictedForSeat,planUser:t?.planUser??null,inDrafts:!!t?.isDraftFile,draftsMoveData:t9,canMoveWithReasons:t?.canMoveWithReasons},void 0,!0);else if(n?.type===g.nb.REPO){let e=n.branches.find(e=>(0,b.SA)(e,n.repo));(0,ei.h)(e??null,n.repo,ez,void 0,void 0,{canMove:!!r?.canMove,isUserViewerRestricted:!!r?.isUserRestrictedForSeat,planUser:r?.planUser??null,inDrafts:!!r?.isDraftRepo,draftsMoveData:t9,canMoveWithReasons:r?.canMoveWithReasons},void 0,!0)}}else{let t=e.selectedTiles.filter(e=>e.type===g.nb.FILE).map(e=>v.F.toSinatra(e.file)),r=e.selectedTiles.filter(e=>e.type===g.nb.REPO).map(e=>e.repo);(0,ei.O)(t,r,ez,void 0,!0)}})(tq,tG),disabled:r}),[I.W.FAVORITE_FILE]:(r,n)=>{let{favoriteSidebarSection:a}=e.loadedQueries;return t&&null!=n&&n?.length>0?tb({is_favorited:r.isFavorited},n,a,e=>{ty(r,e,a?.id!==e)}):{displayText:(0,w.t)("tile.favoriting.add_to_favorites"),recordingKey:"favorite-file",callback:()=>ty(r,void 0,!0)}},[I.W.FAVORITE_PROTOTYPE]:e=>({displayText:(0,w.t)("tile.favoriting.add_to_favorites"),recordingKey:"favorite-prototype",callback:()=>tE(e,!0)}),[I.W.FAVORITE_REPO]:(r,n,a)=>{let{favoriteSidebarSection:l}=e.loadedQueries;return t&&null!=a?tb(r,a,l,e=>{tg(r,n,e,l?.id!==e)}):{displayText:(0,w.t)("tile.favoriting.add_to_favorites"),recordingKey:"favorite-repo",callback:()=>tg(r,n,void 0,!0)}},[I.W.UNFAVORITE_FILE]:e=>({displayText:r,recordingKey:"unfavorite-file",callback:()=>ty(e,void 0,!1)}),[I.W.UNFAVORITE_PROTOTYPE]:e=>({displayText:r,recordingKey:"unfavorite-prototype",callback:()=>tE(e,!1)}),[I.W.UNFAVORITE_REPO]:(e,t)=>({displayText:r,recordingKey:"unfavorite-repo",callback:()=>tg(e,t,void 0,!1)}),[I.W.USE_IN_NEW_FILE]:e=>(0,eP.rC)({dispatch:ez,fileKey:e.key,templateName:e.name}),[I.W.FILE_ANALYTICS]:e=>({displayText:(0,w.t)("fullscreen.filename_view.file_analytics"),recordingKey:"file-analytics",callback:()=>{null!=e.folderId&&ez((0,X.to)({type:ee.e,data:{fileKey:e.key,entrypoint:J.F.FileNavigation}}))}})}),rF=(i=(tQ&&e.permsByPrototypeId[tQ.file_key])??null,s=(0,z.R$)(e$,eq),d=!!tH&&!!tH.teamId&&e9,c="folder"===eX.view&&eJ[eX.folderId]||ra&&eQ&&eJ[eQ]||[],p=tH&&c.includes(tH.key),_=tY&&c.includes(tY.key),m=t$&&t$.default_file_key&&c.includes(t$.default_file_key),y=p||_||m||Object.keys(e3[F.F.PINNED_FILES]).length>0,M=t6+t2+t8+t3+t7===1,eL=tz?.editorType===eo._Y.FIGMAKE,eM=tz?.editorType===eo._Y.FIGMAKE&&!tV,eW=(tk>0||tO>0||tA>0)&&!s&&!d&&!te,eD=tP.length+tT.length+tM.length,eB=tL.length+tS.length,eU=tj.length+tw.length,eK=tN.length+tR.length,eV=0===eU&&0===eK&&0===eB&&e.tileActions.pinToFolder&&!e.tileActions.showInFolder&&M,eH=(0,Q.D6)(eq),{[I.W.COPY_LINK]:()=>!!(e.tileActions.copyLink&&M&&!tZ),[I.W.DELETE]:()=>!!(e.tileActions.delete&&eD>0&&0===t2),[I.W.DUPLICATE]:()=>!!(e.tileActions.duplicate&&eW),[I.W.DUPLICATE_TO_DRAFTS]:()=>!!(e.tileActions.duplicateToDrafts&&eW),[I.W.OPEN]:()=>!!(e.tileActions.open&&M),[I.W.OPEN_NEW_TAB]:()=>!!(e.tileActions.open&&M&&!ef.eD&&!(0,e_.ce)()),[I.W.OPEN_WITH_DISABLED_PREVIEW]:()=>!!(M&&(e4.type===g.nb.FILE&&e4.file.editorType===eo._Y.FIGMAKE||e4.type===g.nb.PINNED_FILE&&e4.file.editorType===eo._Y.FIGMAKE)),[I.W.PIN_FILE_TO_FOLDER]:()=>{let e=tq?.canPin;return!!(!y&&1===t6&&eV&&e)},[I.W.PIN_REPO_TO_FOLDER]:()=>{let e=tG?.canPin;return!!(!y&&1===t3&&eV&&e)},[I.W.PIN_FILE_TO_WORKSPACE]:()=>!!(M&&(1===t6||1===t3)&&e.tileActions.pinToWorkspace&&e.loadedQueries.fileWorkspacePinActions&&e.loadedQueries.fileWorkspacePinActions.shouldShowPinFileToWorkspaceAction),[I.W.REMOVE_FROM_RECENTS]:()=>!!(e.tileActions.removeFromRecents&&tD>0),[I.W.REMOVE_FROM_SHARED_FILES]:()=>!!(e.tileActions.removeFromSharedFiles&&1===tB),[I.W.RENAME]:()=>{let t=tq?.canRename,r=tG?.canRename;return!!(e.tileActions.rename&&M&&(1===t6&&t||1===t3&&r||1===t7))},[I.W.MOVE_FILE]:()=>{let t=tq?.canOpenMoveModal,r=tG?.canOpenMoveModal;return!!(e.tileActions.moveFile&&0===t7&&(M&&(1===t6&&t||1===t3&&r)||ri>1&&ri<=ti&&rE>0))},[I.W.RESTORE_FROM_VERSION]:()=>{let t=tq?.canRestoreFromVersion,r=!!t$&&tG?.canEditBranch(eZ[t$.id]);return!!(e.tileActions.restoreFromVersion&&M&&(1===t6&&t||1===t3&&r)&&!eL)},[I.W.SHARE]:()=>!!(e.tileActions.share&&M&&(1===t6||1===t2||1===t3)&&!tq?.isFileTypeDisabled&&!eM),[I.W.SHOW_IN_FOLDER]:()=>{let t=tq?.canShowInProject,r=tG?.canShowInProject;return!!(e.tileActions.showInFolder&&M&&(1===t3&&r||1===t6&&t))},[I.W.UNPIN_FILE_FROM_FOLDER]:()=>{let e=!!tq?.canPin;return!!(y&&t2<=1&&eV&&e)},[I.W.UNPIN_REPO_FROM_FOLDER]:()=>{let e=tG?.canPin;return!!(y&&t3<=1&&eV&&e)},[I.W.UNPIN_FILE_FROM_WORKSPACE]:()=>!!(e.tileActions.pinToWorkspace&&M&&e.loadedQueries.fileWorkspacePinActions&&e.loadedQueries.fileWorkspacePinActions.canEditPin),[I.W.EDIT_WORKSPACE_PIN]:()=>!!(e.tileActions.pinToWorkspace&&1===t6&&e.loadedQueries.fileWorkspacePinActions&&e.loadedQueries.fileWorkspacePinActions.canEditPin),[I.W.CREATE_BRANCH]:()=>!!(e.tileActions.createBranch&&M&&(1===t6||1===t2||1===t3)&&e.sourceFile&&e.loadedQueries.createBranchStatus&&"hidden"!==e.loadedQueries.createBranchStatus.status),[I.W.FAVORITE_FILE]:()=>{if("deletedFiles"===eX.view||tz?.parentOrgId!==eq)return!1;let t=tq?.canFavorite&&e.loadedQueries.isResourceInUserPlan,r=tq?.canFavorite&&!tq?.isFavorited&&e.loadedQueries.isResourceInUserPlan;return!!("team"!==eX.view&&!e.loadedQueries.hasMaxFavorites&&!eH&&(r&&1===t6&&M||tY&&1===t2&&!tY?.isFavorited))||(eH&&e.loadedQueries.userSidebarSections,!!t&&1===t6&&!!M||!!tY&&1===t2)},[I.W.FAVORITE_PROTOTYPE]:()=>{if("deletedFiles"===eX.view||"team"===eX.view||tQ?.parent_org?.id!==eq)return!1;let t=i?.canFavorite&&e.loadedQueries.isResourceInUserPlan;return!!(!e.loadedQueries.hasMaxFavorites&&!eH&&1===t8&&M&&t)},[I.W.FAVORITE_REPO]:()=>{if("deletedFiles"===eX.view||t$?.parent_org_id!==eq)return!1;let t=tG?.canFavorite&&e.loadedQueries.isResourceInUserPlan;return!!("team"!==eX.view&&!e.loadedQueries.hasMaxFavorites&&!eH&&1===t3&&M&&t)||(eH&&e.loadedQueries.userSidebarSections,1===t3&&!!M&&!!t)},[I.W.UNFAVORITE_FILE]:()=>{if("deletedFiles"===eX.view||"team"===eX.view||tz?.parentOrgId!==eq)return!1;let e=tq?.canFavorite&&tq?.isFavorited;return!!(tH?.parentOrgId===eq&&(1===t6&&M&&e||tY&&1===t2&&tY?.isFavorited))},[I.W.UNFAVORITE_PROTOTYPE]:()=>{if("deletedFiles"===eX.view||"team"===eX.view||tQ?.parent_org?.id!==eq)return!1;let e=i?.canUnfavorite;return!!(1===t8&&M&&e)},[I.W.UNFAVORITE_REPO]:()=>{if("deletedFiles"===eX.view||"team"===eX.view||t$?.parent_org_id!==eq)return!1;let e=tG?.canUnfavorite;return!!(1===t3&&M&&e)},[I.W.USE_IN_NEW_FILE]:()=>{let e=!!tq?.canUseInNewFile;return!!(M&&tz&&e)},[I.W.DELETE_FOREVER]:()=>!!(e.tileActions.trashPageActions&&eB>0),[I.W.RESTORE]:()=>!!(e.tileActions.trashPageActions&&eU>0&&!s),[I.W.RESTORE_TO]:()=>!!(e.tileActions.trashPageActions&&eK>0&&!s&&!(e.tileActions.trashPageActions&&eU>0)),[I.W.FILE_ANALYTICS]:()=>{let e=tz??tJ,t=(0,et.MG)(e?{parentOrgId:e.parentOrgId||null}:null,!!e?.lastPublishedAt,rn);return!!(e&&t)}}),rx=(e,...t)=>rF[e]()?[].concat(rv[e](...t)):[],rI=[[...rx(I.W.SHOW_IN_FOLDER,e4),...rx(I.W.OPEN,e4),...rx(I.W.OPEN_NEW_TAB,e4),...rx(I.W.OPEN_WITH_DISABLED_PREVIEW,e4)],[...rx(I.W.CREATE_BRANCH,null!=e.loadedQueries.createBranchStatus&&"disabled"===e.loadedQueries.createBranchStatus.status)],[...rx(I.W.FILE_ANALYTICS,tz??tJ)],[...rx(I.W.FAVORITE_FILE,tz,e.loadedQueries.userSidebarSections),...rx(I.W.FAVORITE_PROTOTYPE,tQ),...rx(I.W.FAVORITE_REPO,t$,tX,e.loadedQueries.userSidebarSections),...rx(I.W.UNFAVORITE_FILE,tz),...rx(I.W.UNFAVORITE_PROTOTYPE,tQ),...rx(I.W.UNFAVORITE_REPO,t$,tX),...rx(I.W.PIN_FILE_TO_FOLDER,tH),...rx(I.W.PIN_REPO_TO_FOLDER,t$),...rx(I.W.UNPIN_FILE_FROM_FOLDER,tz),...rx(I.W.UNPIN_REPO_FROM_FOLDER,t$),...rx(I.W.PIN_FILE_TO_WORKSPACE,tH?.key||tX?.key),...rx(I.W.EDIT_WORKSPACE_PIN,e.loadedQueries.fileWorkspacePinActions?.existingFilePinId),...rx(I.W.UNPIN_FILE_FROM_WORKSPACE,e.loadedQueries.fileWorkspacePinActions?.existingFilePinId)],[...rx(I.W.COPY_LINK,e4),...rx(I.W.SHARE,e4),...rx(I.W.DUPLICATE,rb,!rm),...rx(I.W.DUPLICATE_TO_DRAFTS,rb,!rm),...rx(I.W.USE_IN_NEW_FILE,tz)],[...rx(I.W.RESTORE_FROM_VERSION,e4),...rx(I.W.RENAME,e4),...rx(I.W.MOVE_FILE,tU,rb,!(1===rs||ry&&tK)),...rx(I.W.DELETE,e4,rg,!ru),...rx(I.W.REMOVE_FROM_RECENTS,tD,!rh),...rx(I.W.REMOVE_FROM_SHARED_FILES,e4),...rx(I.W.RESTORE,rb,!r_,ri),...rx(I.W.RESTORE_TO,rb,!rf,ri),...rx(I.W.DELETE_FOREVER,rb,!rp)]],rT=[];return rI.filter(e=>e.length>0).forEach(e=>{rT.length>0&&rT.push({displayText:"",separator:!0}),rT.push(...e)}),(0,n.jsx)(E,{portalTarget:document.body,children:(0,n.jsx)(x.j,{autofocusPrevOnDismount:!0,dispatch:ez,items:rT,lean:"right",minWidth:rd?void 0:140,onMount:e.onMount,onSelectItem:(e,t)=>{e.callback&&e.callback("",{},ez,t)},parentRect:rl.targetRect,recordingKey:"tile-dropdown",showPoint:!1})})}function eW(e){return _.v.getFeatureGate("tile_action_dropdown_refactor")?(0,n.jsx)(eL,{...e}):(0,n.jsx)(eM,{...e})}var eD=r(964099),eB=r(835048),eU=r(855700),eK=r(357578),eV=r(665002);function eH({tileActions:e,openTile:t,tile:r,selectedTiles:_,dropdownVisible:f,trackSearchFn:m}){var h,y;let E,b,F,x,I,T=r||(1===_.length?_[0]??null:null),w=f&&null!==r,{filePermissions:R,repoPermissions:k,protoPermissions:O}=(0,o.xD)(_),S=(0,eV.ud)(),C=a.useMemo(()=>{if(!T)return null;let e=null;if(T.type===g.nb.FILE)e=T.file;else if(T.type===g.nb.REPO){let t=S[T.repo.default_file_key];e=t?v.F.toLiveGraph(t):null}else T.type===g.nb.PINNED_FILE&&(e=T.file);return e},[S,T]),A=function({sourceFile:e,tile:t,tileActions:r,enabled:n}){let a=t?.file?.key,l=(0,eK.ac)(e,n);(0,eU.d)({file:e??null});let i=t?g.Tf.getOrgId(t):null,o=t?g.Tf.getFavoriteResourceTeamId(t):null,s=(0,eh.jm)(i,o),d=(0,eB.Y)(a??"",eo.bk.FILE,i,o,n),c=(0,u.pH)(e?.key??"",{enabled:!!e&&r.pinToWorkspace&&n}),p=d.hasMaxFavorites,_=d.favorite,f=d.orderedSidebarSections??[],m=(0,Q.t$)(d.userSidebarSections??[],f),h=m.find(e=>e.id===_?.resource.sidebarSectionId),y="loaded"!==d.status&&"disabled"!==d.status,E="loaded"!==l.status&&"disabled"!==l.status,b="loaded"!==c.status&&"disabled"!==c.status;return{loading:y||E||b,data:{hasMaxFavorites:p,userSidebarSections:m,favoriteSidebarSection:h,createBranchStatus:l.data,isResourceInUserPlan:!!s,fileWorkspacePinActions:c.data}}}({sourceFile:C,tile:T,tileActions:e,enabled:1===_.length}),P=A.loading&&r?.type!==g.nb.OFFLINE_FILE||"loaded"!==R.status||"loaded"!==k.status||"loaded"!==O.status,j=(h=_.length>1,E=a.useRef(!1),b=a.useRef(w),F=a.useRef(null),a.useEffect(()=>{w&&!1===b.current&&(F.current&&(F.current=null),P?F.current=new s.rw:(E.current=!0,i.az.trackDefinedEvent("file_browser.context_menu_render",{cache_hit:!0,durationMs:0,isBulkSelect:h}))),w&&!P&&(F.current?.stop(e=>{let t=e<=50;i.az.trackDefinedEvent("file_browser.context_menu_render",{cache_hit:t,durationMs:e,isBulkSelect:h}),E.current=t}),F.current=null),b.current=w},[w,P,h]),E.current);return(y=w&&!j?_:[],x=(0,eD.z0)(),I=a.useMemo(()=>y,[y.map(e=>g.Tf.getId(e)).join(",")]),a.useEffect(()=>{let e=I.length>1;I.forEach(t=>{let r=x(t);i.az.trackDefinedEvent("file_browser.context_menu_item_loaded",{wasHovered:void 0!==r,isBulkSelect:e,timeSinceHoverMs:r?Date.now()-r:void 0})})},[I,x]),!w||P)?null:(0,n.jsx)(c.tH,{boundaryKey:"TileActionDropdown",sentryTags:{area:l.FigmaTeam.WAYFINDING},fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING,children:(0,n.jsx)(d.u9,{label:"TileActionDropdown",context:{enabledActions:{...e}},logToFigment:!0,children:(0,n.jsx)(eW,{loadedQueries:A.data,onMount:()=>{p.$.endAndReport(`${g.Tf.getId(r)}`)},openTile:t,permsByFileKey:R.data,permsByPrototypeId:O.data,permsByRepoId:k.data,selectedTiles:_,sourceFile:C,tile:r,tileActions:e,trackSearchFn:m})})})}},740939(e,t,r){r.d(t,{W:()=>n});let n=1464==r.j?{COPY_LINK:"COPY_LINK",DELETE:"DELETE",DUPLICATE:"DUPLICATE",DUPLICATE_TO_DRAFTS:"DUPLICATE_TO_DRAFTS",OPEN:"OPEN",OPEN_NEW_TAB:"OPEN_NEW_TAB",OPEN_WITH_DISABLED_PREVIEW:"OPEN_WITH_DISABLED_PREVIEW",PIN_FILE_TO_FOLDER:"PIN_FILE_TO_FOLDER",PIN_REPO_TO_FOLDER:"PIN_REPO_TO_FOLDER",PIN_FILE_TO_WORKSPACE:"PIN_FILE_TO_WORKSPACE",RENAME:"RENAME",MOVE_FILE:"MOVE_FILE",SHARE:"SHARE",SHOW_IN_FOLDER:"SHOW_IN_FOLDER",REMOVE_FROM_RECENTS:"REMOVE_FROM_RECENTS",REMOVE_FROM_SHARED_FILES:"REMOVE_FROM_SHARED_FILES",RESTORE_FROM_VERSION:"RESTORE_FROM_VERSION",UNPIN_FILE_FROM_FOLDER:"UNPIN_FILE_FROM_FOLDER",UNPIN_REPO_FROM_FOLDER:"UNPIN_REPO_FROM_FOLDER",UNPIN_FILE_FROM_WORKSPACE:"UNPIN_FILE_FROM_WORKSPACE",EDIT_WORKSPACE_PIN:"EDIT_WORKSPACE_PIN",CREATE_BRANCH:"CREATE_BRANCH",FAVORITE_FILE:"FAVORITE_FILE",FAVORITE_PROTOTYPE:"FAVORITE_PROTOTYPE",FAVORITE_REPO:"FAVORITE_REPO",UNFAVORITE_FILE:"UNFAVORITE_FILE",UNFAVORITE_PROTOTYPE:"UNFAVORITE_PROTOTYPE",UNFAVORITE_REPO:"UNFAVORITE_REPO",USE_IN_NEW_FILE:"USE_IN_NEW_FILE",FILE_ANALYTICS:"FILE_ANALYTICS",DELETE_FOREVER:"DELETE_FOREVER",RESTORE:"RESTORE",RESTORE_TO:"RESTORE_TO"}:null},643300(e,t,r){r.d(t,{L:()=>l});var n=r(105652),a=r(636773);function l(){let e=`TILE_ACTION_DROPDOWN_${n.useId()}`;return(0,a.BK)(e)}},964099(e,t,r){r.d(t,{FA:()=>s,my:()=>d,xj:()=>u,z0:()=>c});var n=r(239976),a=r(105652),l=r(181645),i=r(832763);let o=(0,a.createContext)({onHover:()=>{},onLeave:()=>{},getItemHoveredAt:()=>void 0,items:[]});function s(){return(0,a.useContext)(o).onHover}function d(){return(0,a.useContext)(o).onLeave}function c(){return(0,a.useContext)(o).getItemHoveredAt}function u({children:e}){let[t,r]=(0,a.useState)({}),s=(0,a.useRef)({});(0,a.useEffect)(()=>()=>{s.current={}},[]);let d=(0,a.useCallback)(e=>{let t=i.Tf.getId(e);return s.current[t]?.enter},[]),c=(0,a.useCallback)(e=>{r(t=>{let r=i.Tf.getId(e);return t[r]?t:{...t,[r]:e}}),s.current[i.Tf.getId(e)]||(s.current[i.Tf.getId(e)]={enter:Date.now()})},[]),u=(0,a.useCallback)(e=>{let t=i.Tf.getId(e),n=s.current[t];if(n&&!n.leave){let e=Date.now();s.current[t]={...n,leave:e},l.az.trackDefinedEvent("file_browser.context_menu_item_hover",{hoverDurationMs:e-n.enter})}r(e=>{let r={...e};return delete r[t],r})},[]),p=(0,a.useMemo)(()=>Object.values(t),[t]),_=(0,a.useMemo)(()=>({onHover:c,onLeave:u,getItemHoveredAt:d,items:p}),[p,c,u,d]);return(0,n.jsx)(o.Provider,{value:_,children:e})}},880067(e,t,r){r.d(t,{Q4:()=>O,gE:()=>R,u5:()=>k});var n=r(850159),a=r(3752),l=r(181645),i=r(30890),o=r(436174),s=r(42053),d=r(116682),c=r(937070);if(1464==r.j)var u=r(613629);var p=r(387166),_=r(540769),f=r(220117),m=r(537916);if(1464==r.j)var h=r(539554);var y=r(26197);if(1464==r.j)var E=r(435065);var b=r(83522);if(1464==r.j)var g=r(487817);var v=r(169984),F=r(357661),x=r(309295);if(1464==r.j)var I=r(839066);if(1464==r.j)var T=r(383383);async function w(e,t,r,a,l,i){let o=[],d=null;try{d=await (0,y.nm)()(r),o=(0,E.F)(a,t,d)}catch(t){let e=t?.data?.message||(0,n.t)("file_browser.error_try_again");r(u.F.enqueue({message:e,type:"error"}))}let c=(a.authedActiveCommunityProfile?.associated_users??[]).filter(e=>e.user_id in a.authedUsers.byId).length>1,p=(0,_.JJ)(t.viewer_mode),f=o.map(e=>(0,m.y)(e,p,a,d,i)).filter(e=>null!==e);1!==f.length||c?(0===f.length&&(0,s.xi)("community","no available workspaces for workspace selection modal",{workspaces:o,userId:a.user?.id}),e({onSelectWorkspace:l,workspaces:f,mode:"new_file"})):l(f[0])}let R=(e,t={isFreemiumPreview:!1,adminReviewerOverride:!1,skipWorkspaceSelection:!1,userId:void 0,openInNewTab:!0})=>r=>async(n,s)=>{let u=s();function _(e){let s={headers:{...d.Ay.defaults.headers}},_={};e&&(s.headers["X-Figma-User-ID"]=e.userId,_.org_id=e.orgId,_.team_id=e.teamId),!0===t.adminReviewerOverride&&(_.admin_reviewer_override=!0),d.Ay.post(`/api/hub_files/v2/${r.id}/copy`,_,s).then(({data:s})=>{let d=s.meta,f=(0,F.m3)(r),m=!0!==f?"none":!0===t.isFreemiumPreview?"trial":"paid";(0,l.sx)(h.M5.HUB_FILE_DUPLICATED,{hubFileId:r.id,figFileKey:d.key,isMonetized:f,paidStatus:m,searchSessionId:(0,p.wr)(u),file_team_id:_.team_id,org_id:_.org_id,file_folder_id:d.folder_id}),"whiteboard"===d.editor_type&&n((0,c.Hx)({storeInRecentsKey:I.$A.FigJam,id:r.id,type:I.vt.CommunityResource}));let y=(0,b.to)(d);y=(0,i.dR)(y,{"is-community-duplicate":"1",fuid:e?.userId||t.userId||""}),!0===t.isFreemiumPreview&&(y=(0,i.dR)(y,{"is-freemium-preview":"1"})),o.Ay.redirect(y,a.A.isMobileBrowser||!t.openInNewTab?void 0:"_blank")})}(0,f.YN)()&&t.skipWorkspaceSelection?_():await w(e,r,n,u,_)},k=(e,t={skipWorkspaceSelection:!1,userId:void 0})=>r=>async(n,l)=>{let s=l();function d(e){let n=(0,T.e)(g._Y.SLIDES,x.f6.COMMUNITY_RESOURCE_TILE_USE_TEMPLATE,r.library_key);e?((0,v.Y9)(e.userId,!1,e.orgId,void 0,e.teamId??null),n=(0,i.dR)(n,{fuid:e.userId})):t.userId&&(n=(0,i.dR)(n,{fuid:t.userId})),o.Ay.redirect(n,a.A.isMobileBrowser?void 0:"_blank")}(0,f.YN)()&&t.skipWorkspaceSelection?d():await w(e,r,n,s,d)},O=(e,t={skipWorkspaceSelection:!1,userId:void 0})=>r=>async(n,l)=>{let s=l();function d(e){let n=`/file/new?initial-library-key=${r.library_key}`;e?((0,v.Y9)(e.userId,!1,e.orgId,void 0,e.teamId??null),n=(0,i.dR)(n,{fuid:e.userId})):t.userId&&(n=(0,i.dR)(n,{fuid:t.userId})),o.Ay.redirect(n,a.A.isMobileBrowser?void 0:"_blank")}(0,f.YN)()&&t.skipWorkspaceSelection?d():await w(e,r,n,s,d,!0)}},759555(e,t,r){r.d(t,{A:()=>p});var n=r(645186),a=r(181645),l=r(880067),i=r(24375),o=r(38900),s=r(508295),d=r(357661),c=r(446493),u=r(387166);function p({resource:e,adminReviewerOverride:t=!1,isFreemiumPreview:r=!1,skipWorkspaceSelection:p=!1,openInNewTab:_=!0}){let f=(0,n.wA)(),m=(0,u.Jm)(),h=(0,c.T)(),y=(0,s.iZ)();if(!(0,d.U)(e))return()=>{};let E=l.gE(t=>{(0,a.sx)("try_it_out_drafts_picker_menu_opened",{hubFileId:e.id,searchSessionId:m}),f((0,o.to)({type:i._,data:{payload:t}}))},{isFreemiumPreview:r,adminReviewerOverride:t,skipWorkspaceSelection:h||p,userId:y?.id,openInNewTab:_});return()=>{f(E(e))}}},775913(e,t,r){r.d(t,{I:()=>l});var n=r(865804);if(1464==r.j)var a=r(113641);function l(){return(0,n.j6)().name===a.e0.RESOURCE_HUB_LIGHTBOX_RDP}},835048(e,t,r){r.d(t,{Y:()=>o});var n=r(140979),a=r(668522),l=r(571916),i=r(644350);function o(e,t,r=null,s=null,d=!0){let c=(0,n.bc)(i.qjT,{resourceId:e,resourceType:t,orgId:r,teamId:r?null:s},{enabled:d}),u=c.data?(0,l.eU)(c.data,t):void 0;return{status:c.status,favorite:u,hasMaxFavorites:!!c.data?.favoritedResources?.numFavorites&&(0,l.tW)(c.data?.favoritedResources.numFavorites),userSidebarSections:c.data?.currentUser?(0,a.oA)(c.data.currentUser.userSidebarSections):null,orderedSidebarSections:c.data?.currentUser.baseOrgUser?.fileBrowserPreferences?.orderedSidebarSections}}},64537(e,t,r){r.d(t,{Q:()=>h,S:()=>y});var n=r(850159),a=r(95382),l=r(668522),i=r(42053),o=r(116682),s=r(863825),d=r(613629),c=r(898312),u=r(644350),p=r(924114),_=r(270010),f=r(699720),m=r(265773);let h=(0,m.nF)(async(e,t,{loadingKey:r})=>{let o=!1;try{o=!!(0,l.oA)((await (0,a.Ek)(u.jmg,{fileKey:t.file_key})).deviceTryFile)}catch(e){(0,i.x1)("claimFigJamTryFile","Request failed for fetching LG DeviceTryFileView",e,{reportAsSentryError:!0})}try{let a;a=o?f.L.claimDeviceFile({fileKey:t.file_key}):_.Uy.claimTryFile({fileKey:t.file_key,folderId:t.folder_id}),(0,p.N)(a,e,r);let{data:l}=await a,{save_location:i,folder_name:s,org_id:u}=l.meta,{user:m,currentUserOrgId:h,selectedView:y}=e.getState(),E=(0,n.t)("figjam_try.this_file_has_been_saved_to_drafts");if("team"===i&&s&&(E=(0,n.t)("figjam_try.this_file_has_been_saved_to_folder_name",{folder_name:s})),u&&u!==h&&m){let t={userId:m.id,orgId:u};e.dispatch(c._l({workspace:t,view:y}))}e.dispatch(d.F.enqueue({message:E}))}catch(t){e.dispatch(s.s.error("Unable to save file. Please try again later."))}}),y=(0,m.nF)(async(e,{userName:t,file_key:r},{loadingKey:a})=>{try{await o.Ay.put(`/api/try/file/${r}`,{name:(0,n.t)("figjam_try.default_filename",{userName:t})})}catch(e){console.error(e)}})},700354(e,t,r){let n;r.d(t,{Z:()=>p,T:()=>u});var a=r(863825),l=r(765326),i=r(936652),o=r(38900),s=r(980711),d=r(279378),c=r(265773);let u=(0,c.nF)((e,{fileKey:t,versionId:r})=>{s.W.getVersion({fileKey:t,versionId:r}).then(({data:t})=>{let r=t.meta.version;e.dispatch(o.to({type:d.y,data:{description:r.description,label:r.label,savepointID:r.id,isEditingMergeSavepoint:!0}}))},()=>{e.dispatch(a.s.error("An error occurred while retrieving the file history."))})}),p=(0,c.nF)(async(e,{fileKey:t},{liveStore:d})=>{try{let{data:a}=await s.W.getVersions({fileKey:t,pageSize:100}),c=await d.fetchFile(t),u=a.meta.versions;e.dispatch(o.to({type:n??=(0,i.Ju)(l.A.createLazyComponent(()=>Promise.all([r.e("905"),r.e("7360"),r.e("1617"),r.e("826"),r.e("7205"),r.e("7840"),r.e("7606"),r.e("5830"),r.e("8916"),r.e("5639"),r.e("8701"),r.e("5654"),r.e("8783"),r.e("1904"),r.e("9387"),r.e("907"),r.e("177"),r.e("5693"),r.e("9931"),r.e("5869"),r.e("3416"),r.e("6467"),r.e("3582"),r.e("4395"),r.e("3278")]).then(r.bind(r,579982)).then(e=>e.FileRestoreFromVersionModal),(0,i.Ij)("FileRestoreFromVersionModal"))),data:{fig:c,versions:u}}))}catch(t){e.dispatch(a.s.error("An error occurred while retrieving the file history."))}})},458914(e,t,r){r.d(t,{$:()=>g,E:()=>b});var n=r(105652),a=r(645186),l=r(885705),i=r(706354);if(2036!=r.j)var o=r(741542);var s=r(350923),d=r(195784),c=r(490753),u=r(539236),p=r(198788),_=r(358873),f=r(508295);if(2036!=r.j)var m=r(487817);var h=r(309295);if(2036!=r.j)var y=r(317673);var E=r(942496);function b({newFileFrom:e,folderData:t,forceOpenNewTab:r}){let b=(0,a.wA)(),g=(0,f.TA)(),v=(0,a.d4)(e=>e.user),F=(0,a.d4)(e=>e.selectedView),x=(0,s.Xr)(y.P4),I=(0,a.d4)(e=>{let r="DRAFTS_FOLDER"!==t?t:void 0;return r&&r.teamId?e.teams[r.teamId]:void 0}),T=(0,a.d4)(e=>e.currentTeamId?e.teams[e.currentTeamId]:void 0),{Sprig:w}=(0,p.A)();return(0,n.useCallback)(({editorType:n,contextClicked:a,triggerElement:s,newFileDataLocalStorageKey:p})=>f=>{b((0,E.zE)({editorType:n,triggerElement:s,team:I||T,from:e,openNewFileIn:r||(0,c.oJ)(f)?h.ai.NEW_TAB:h.ai.SAME_TAB,folderData:t,callback:e=>{(0,d.Cu)({userId:g,fileKey:e},a)},newFileDataLocalStorageKey:p})),n===m._Y.SITES&&x(!0),(0,o.getFeatureFlags)().file_browser_sentiment_survey&&w("setAttribute","fb_file_created",!0),u.J.addAction("file_created",i.FigmaTeam.WAYFINDING,l.$.INFO,{sourceComponent:a,selectedView:(0,_.fu)({selectedView:F,user:v})})},[b,t,I,T,r,e,g,x,w,F,v])}function g({editorType:e,triggerElement:t,contextClicked:r,...a}){let l=b(a);return(0,n.useMemo)(()=>l({editorType:e,triggerElement:t,contextClicked:r}),[l,e,t,r])}},649862(e,t,r){r.d(t,{MA:()=>s,om:()=>i,x1:()=>o});var n,a,l,i=1464==r.j?((n=i||{})[n.eduRestrictedSitesBanner=0]="eduRestrictedSitesBanner",n[n.TestThemeBanner=1]="TestThemeBanner",n[n.TestWarningBanner=2]="TestWarningBanner",n[n.TestOOMBanner=3]="TestOOMBanner",n[n.TestInfoBanner=4]="TestInfoBanner",n[n.StarterTeamOverFreeLimitAndLocked=5]="StarterTeamOverFreeLimitAndLocked",n[n.EduGracePeriodAccessRestricted=6]="EduGracePeriodAccessRestricted",n[n.EduGracePeriodShowReminder=7]="EduGracePeriodShowReminder",n[n.OrphanedOrgDraftsFile=8]="OrphanedOrgDraftsFile",n[n.TeamAbandonedDraftsFile=9]="TeamAbandonedDraftsFile",n[n.TeamAdminOpenInvoiceReminder=10]="TeamAdminOpenInvoiceReminder",n[n.PersonalProjectDeprecatedFile=11]="PersonalProjectDeprecatedFile",n[n.ProTeamPastDue=12]="ProTeamPastDue",n[n.ProTeamChargeFailed=13]="ProTeamChargeFailed",n[n.ProTeamNoMonthlySubEditorCountExceeded=14]="ProTeamNoMonthlySubEditorCountExceeded",n[n.MultiplayerSessionUpgrade=15]="MultiplayerSessionUpgrade",n[n.AdminI18nLocalWarnBanner=16]="AdminI18nLocalWarnBanner",n[n.FigJamTryDraftsBanner=17]="FigJamTryDraftsBanner",n[n.FigJamTryClaimBanner=18]="FigJamTryClaimBanner",n[n.CommunityResourceCTANuxBanner=19]="CommunityResourceCTANuxBanner",n[n.communityM10nApprovalBanner=20]="communityM10nApprovalBanner",n[n.communityM10nFinishSetupBanner=21]="communityM10nFinishSetupBanner",n[n.communityM10nAdtlInfoNeededBanner=22]="communityM10nAdtlInfoNeededBanner",n[n.communityResourceInReviewBanner=23]="communityResourceInReviewBanner",n[n.CommunityResourceCreatorBanner=24]="CommunityResourceCreatorBanner",n[n.ExternalContentControlBanner=25]="ExternalContentControlBanner",n[n.MemoryWarningBanner=26]="MemoryWarningBanner",n[n.MemoryErrorBanner=27]="MemoryErrorBanner",n[n.MemorySafeBanner=28]="MemorySafeBanner",n[n.AdminUserDisposableDomainWarningBanner=29]="AdminUserDisposableDomainWarningBanner",n[n.FileIsTeamTemplate=30]="FileIsTeamTemplate",n[n.DowntimeBanner=31]="DowntimeBanner",n[n.FreemiumPreviewBanner=32]="FreemiumPreviewBanner",n[n.FileCreationFailureBanner=33]="FileCreationFailureBanner",n[n.DevModePaywallBanner=34]="DevModePaywallBanner",n[n.DevModeInTrialBanner=35]="DevModeInTrialBanner",n[n.devModeStarterTrialBanner=36]="devModeStarterTrialBanner",n[n.DesktopDownloadBanner=37]="DesktopDownloadBanner",n[n.BrowserDeprecationBanner=38]="BrowserDeprecationBanner",n[n.FragmentTextSearchQualityBanner=39]="FragmentTextSearchQualityBanner",n[n.Gen1DesignViewerBanner=40]="Gen1DesignViewerBanner",n[n.DesktopDeprecationBanner=41]="DesktopDeprecationBanner",n[n.LoggedOutCta=42]="LoggedOutCta",n[n.SeatBillingTermsReminder=43]="SeatBillingTermsReminder",n[n.CooperOldFileBanner=44]="CooperOldFileBanner",n[n.InteropPagesBanner=45]="InteropPagesBanner",n[n.ForceClientReload=46]="ForceClientReload",n[n.TemplatePublishingNudgeBanner=47]="TemplatePublishingNudgeBanner",n[n.DevModeDemoFileUpsellBanner=48]="DevModeDemoFileUpsellBanner",n[n.OrderFormBillingTermsBanner=49]="OrderFormBillingTermsBanner",n[n.NonAdminBillingTermsBanner=50]="NonAdminBillingTermsBanner",n[n.OrgDowngradeBanner=51]="OrgDowngradeBanner",n[n.DevModeMCPSSEDeprecationBanner=52]="DevModeMCPSSEDeprecationBanner",n[n.SlotsEnablementReload=53]="SlotsEnablementReload",n[n.SupportShareWarningBanner=54]="SupportShareWarningBanner",n[n.GuestExpirationWarningBanner=55]="GuestExpirationWarningBanner",n):null,o=1464==r.j?((a=o||{}).INFO="info",a.WARN="warn",a.SUCCESS="success",a.ERROR="error",a.WARN_SOFT="warn_soft",a.CONFIDENTIALITY="confidentiality",a.BRAND_STRONG="brand_strong",a.DANGER="danger",a.INFO_SOFT="info_soft",a.FPL_DEFAULT="fpl_default",a.FPL_DANGER="fpl_danger",a.FPL_BRAND="fpl_brand",a.FPL_SUCCESS="fpl_success",a.FPL_WARN="fpl_warn",a):null,s=1464==r.j?((l=s||{}).STRUCTURED="structured",l.CUSTOM="custom",l):null},446493(e,t,r){r.d(t,{T:()=>l});var n=r(138247),a=r(775913);function l(){let e=(0,a.I)(),t=(0,n.AG)();return e||t}},951468(e,t,r){r.d(t,{$f:()=>Z});var n=r(239976),a=r(105652),l=r(645186),i=r(130729),o=r(916290),s=r(147911),d=r(395227),c=r(497817),u=r(68278),p=r(732632),_=r(71239),f=r(297151),m=r(859978),h=r(874287),y=r(282318),E=r(412955),b=r(31551),g=r(850159),v=r(574988),F=r(865804),x=r(838719),I=r(227031),T=r(834116),w=r(848694),R=r(67892),k=r(687497),O=r(985373),S=r(38900),C=r(936652),A=r(932630),P=r(36722),j=r(487817),N=r(331850),L=r(547898),M=r(541391),W=r(308323),D=r(874937),B=r(961645),U=r(676835),K=r(360214),V=r(31287);function H({opacity:e}){return(0,n.jsx)("div",{style:{opacity:e},children:(0,n.jsxs)("div",{...{className:"x78zum5 x6s0dn4 x1i71x30 x1vi7shn xp6roeo"},children:[(0,n.jsx)(K.Wi,{style:{width:24,height:24,borderRadius:4,flexShrink:0}}),(0,n.jsxs)("div",{...{className:"x78zum5 xdt5ytf xg2d0mh x1iyjqo2"},children:[(0,n.jsx)(K.Wi,{style:{height:14,width:120,borderRadius:2}}),(0,n.jsx)(K.Wi,{style:{height:12,width:180,borderRadius:2}})]})]})})}function Y(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{...v.xk(V.g.searchContainer),children:[(0,n.jsx)("div",{...v.xk(V.g.searchBarWrapper),children:(0,n.jsx)(K.Wi,{style:{height:24,borderRadius:6,width:"100%"}})}),(0,n.jsx)(K.Wi,{style:{width:24,height:24,borderRadius:4}})]}),(0,n.jsx)("div",{...{className:"x1w4f5ud x1vamu9a x1gcgh60 x1jwbysl x78zum5 xdt5ytf x1nfngrj"},children:Array.from({length:5},(e,t)=>(0,n.jsx)(H,{opacity:t<2?1:1-(t-2+1)/4},t))})]})}var z=r(852448),$=r(792706);let q={all:null,joined:j.ZF.USER_GROUPS_JOINED,created:j.ZF.USER_GROUPS_CREATED},G={k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kOIVth:"x883omv",khm7nJ:null,k1C7PZ:null,kzQI83:"x1iyjqo2",kmuXW:"xs83m0k",kCS8Yb:"x1t1x2f9",k7Eaqz:"xeuugli",kVQacm:"xb3r6kr",kXHlph:null,kORKVm:null,kLKAdn:"x1vi7shn",kGO01o:"xp6roeo",$$css:!0},Q={kmVPX3:"x1717udv",kg3NbH:null,kuDDbn:null,kP0aTx:null,kpe85a:null,k8WAf4:null,kLKAdn:null,kGO01o:null,kE3dHu:"x8rdmch",kZCmMZ:null,kwRFfy:null,koQZXg:"x1e38ib8",keTefX:null,k71WvV:null,kfdmCh:"x1sy0etr",kaIpWk:"x19y5rnk",krdFHd:null,kfmiAY:null,kVL7Gh:null,kT0f0o:null,kIxVMA:null,ksF3WI:null,kqGeR4:null,kYm2EN:null,kWkggS:"xjbqb8w xv2f06h",$$css:!0};function X({userGroup:e,onViewSharedFilesClick:t,onSettingsClick:r,onDeleteClick:a}){let{canEdit:l,canDelete:i}=(0,P.en)(P.Ls.FILE_BROWSER,{id:e.id,createdByUserId:e.createdByUser?.id});return(0,n.jsxs)($.zx,{children:[e.isMember&&(0,n.jsx)(s.q7,{onClick:()=>t(e),children:(0,g.t)("user_groups.view_shared_files")}),(0,n.jsx)(s.q7,{onClick:()=>r(e,l),children:(0,g.t)("user_groups.settings")}),i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.wv,{}),(0,n.jsx)(s.q7,{onClick:()=>a(e),children:(0,g.t)("user_groups.delete_user_group_button")})]})]})}function J({open:e,onClose:t,initialFilterOption:r,initialSortOption:I,initialSearchQuery:C,initialPlanHasUserGroups:K,onUserGroupCreated:H}){let $=(0,l.wA)(),J=(0,A.DP)(),ee=(0,P.Q3)(),et=(0,N.S2)().unwrapOr(null),er=et?.planRecordId,en=(0,N.px)(),ea=(0,N.j_)(en).unwrapOr(!1),{canCreate:el,userGroupCreationSetting:ei}=(0,P.en)(P.Ls.FILE_BROWSER),eo=ei===j.W2.ADMINS,es=el||eo,ed=d.hS({open:e,onClose:t}),{manager:ec,getTriggerProps:eu}=s.b({initialPosition:"bottom-end"}),[ep,e_]=a.useState(C??""),[ef,em]=a.useState(r??"all"),[eh,ey]=a.useState(I??"name_asc"),[eE,eb]=a.useState(K??null),eg=a.useCallback(e=>{e_(e)},[e_]),ev=a.useMemo(()=>(0,i.s)(eg,300),[eg]),eF="name_asc"===eh||"name_desc"===eh?j.z7.NAME:j.z7.LAST_ACTIVITY_AT,ex="name_asc"===eh||"last_updated_asc"===eh?"asc":"desc",eI=q[ef],{userGroups:eT,fetchMore:ew,status:eR}=(0,P.Qx)({firstPageSize:50,sortProperty:eF,sortOrder:ex,queryString:ep,useDBQuery:""===ep,filterProperty:eI}),ek=a.useMemo(()=>{let e=[];for(let t of eT){let r=t.userGroup;r&&e.push((0,U.c)(r))}return e},[eT]);a.useEffect(()=>{"loaded"===eR&&(ek.length>0?!0!==eE&&eb(!0):ep||"all"!==ef||eb(!1))},[eR,eE,ep,ef,ek.length]);let eO=a.useMemo(()=>[{name:(0,g.t)("user_groups.user_group"),className:v.xW(G)??"",cellComponent:e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.q,{userGroup:e,size:24}),(0,n.jsxs)("div",{...{className:"x78zum5 xdt5ytf x1iyjqo2 xs83m0k xdl72j9 xeuugli xb3r6kr"},children:[(0,n.jsx)(k.E,{fontSize:11,fontWeight:"medium",truncate:"end",showTooltipWhenTruncated:!0,children:e.name}),(0,n.jsxs)("div",{...{className:"x78zum5 x6s0dn4 xb3r6kr xuxw1ft x1jwbysl xeuugli"},children:[(0,n.jsx)(k.E,{fontSize:11,color:"secondary",children:(0,g.t)("user_group.member_count",{count:e.memberCount})}),e.description&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.E,{fontSize:11,color:"secondary",children:"\xa0\xb7\xa0"}),(0,n.jsx)(k.E,{fontSize:11,color:"secondary",truncate:"end",showTooltipWhenTruncated:!0,children:e.description})]})]})]})]})}],[]),eS=a.useCallback(()=>{$((0,S.AS)()),$((0,S.to)({type:Z,data:{initialFilterOption:ef,initialSortOption:eh,initialSearchQuery:ep,initialPlanHasUserGroups:eE??void 0,onUserGroupCreated:H}}))},[$,ef,eh,ep,eE,H]),eC=(0,n.jsxs)(s.bL,{manager:ec,children:[(0,n.jsx)("div",{...{0:{className:"x78zum5 x6s0dn4 xl56j7k"},1:{className:"x78zum5 x6s0dn4 xl56j7k xcr9a89 x19y5rnk"}}["all"!==ef|0],children:(0,n.jsx)(c.d,{"aria-label":(0,g.t)("user_group.filter_user_groups"),...eu(),children:"all"!==ef?(0,n.jsx)(h.S,{className:"x1aue78i"}):(0,n.jsx)(y.S,{})})}),(0,n.jsxs)(s.mc,{children:[(0,n.jsx)(s.hE,{children:(0,g.t)("user_group.filter.title")}),(0,n.jsxs)(u.z6,{title:"",value:ef,onChange:e=>em(e),children:[(0,n.jsx)(u.CU,{value:"all",children:(0,g.t)("user_group.filter.all_user_groups")}),(0,n.jsx)(u.CU,{value:"joined",children:(0,g.t)("user_group.filter.groups_joined")}),(0,n.jsx)(u.CU,{value:"created",children:(0,g.t)("user_group.filter.groups_created")})]}),(0,n.jsx)(s.hE,{children:(0,g.t)("user_group.filter.sort_by")}),(0,n.jsxs)(u.z6,{title:"",value:eh,onChange:e=>ey(e),children:[(0,n.jsx)(u.CU,{value:"name_asc",children:(0,g.t)("user_group.filter.sort.a_to_z")}),(0,n.jsx)(u.CU,{value:"name_desc",children:(0,g.t)("user_group.filter.sort.z_to_a")}),(0,n.jsx)(u.CU,{value:"last_updated_desc",children:(0,g.t)("user_group.filter.sort.most_recently_updated")}),(0,n.jsx)(u.CU,{value:"last_updated_asc",children:(0,g.t)("user_group.filter.sort.oldest_updated")})]})]})]}),eA=a.useCallback((e,t)=>{$((0,S.to)({type:B.u,data:{userGroup:e,canEdit:t,onBack:eS}}))},[$,eS]),eP=a.useCallback(e=>{$((0,S.to)({type:W.u,data:{userGroups:[e],onCancel:()=>{$((0,S.Lo)())},onCloseClick:()=>{$((0,S.Lo)())}},showModalsBeneath:!0}))},[$]),ej=a.useCallback(e=>{ee(e.id)},[ee]),eN=a.useMemo(()=>[{name:"menu-cell",cellComponent:e=>(0,n.jsx)(X,{userGroup:e,onViewSharedFilesClick:ej,onSettingsClick:eA,onDeleteClick:eP})}],[ej,eA,eP]),eL=a.useCallback(e=>{$((0,S.AS)()),$((0,S.to)({type:D.y,data:{userGroupId:e.id,onBack:eS}}))},[$,eS]);return et&&er?(0,n.jsx)(F.fu,{name:"user_groups_modal",children:(0,n.jsx)(_.bL,{manager:ed,width:"lg","data-testid":"user-groups-modal",children:(0,n.jsxs)(f.vo,{children:[(0,n.jsxs)(f.Jh,{...v.xk(V.g.customHeader),children:[(0,n.jsx)(f.hE,{children:(0,g.t)("user_groups.all_user_groups")}),(0,n.jsx)(f.Ch,{...v.xk(V.g.customClose)})]}),(0,n.jsx)(f.nB,{scrolling:"manual",padding:0,children:(0,n.jsx)("div",{...v.xk(V.g.modalBodyContainer,es&&!0===eE?V.g.modalBodyContainerWithFooter:V.g.modalBodyContainerWithoutFooter),children:null===eE?(0,n.jsx)(Y,{}):(0,n.jsxs)(n.Fragment,{children:[eE&&(0,n.jsxs)("div",{...v.xk(V.g.searchContainer),children:[(0,n.jsx)("div",{...v.xk(V.g.searchBarWrapper),children:(0,n.jsx)(w.y2,{autoFocus:!0,styleOverrides:{boxSizing:"border-box",width:"100%",borderRadius:"6px"},onChange:ev,query:ep,placeholder:(0,g.t)("user_group.search_placeholder"),resultsCount:ek.length})}),eC]}),(0,n.jsx)("div",{...{className:"x1iyjqo2 xs83m0k xdl72j9 xysyzu8 x2lwn1j"},children:0===ek.length&&"loaded"===eR?(0,n.jsx)("div",{...{className:"x78zum5 xdt5ytf x6s0dn4 x1lpwdgh x1g0v9sp x8rdmch xctkrei x2b8uid x1n0bwc9"},children:"all"!==ef?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.oW,{src:(0,x.staticAssetWithUploadsPath)("dark"===J?"40c38fef7cb51e8ecb8825f4a9a1d834d2adc783":"a70afe2b28f296873f64775063953e3ac062dbc0"),alt:(0,g.t)("user_groups.user_group_logo"),width:150}),(0,n.jsx)("div",{...{className:"x15r87gk x1n0bwc9"},children:(0,g.t)("user_groups.no_groups_match_the_current_filter")}),(0,n.jsx)("div",{...{className:"xehsoiq"},children:(0,n.jsx)(p.$n,{variant:"secondary",iconPrefix:(0,n.jsx)(E.f,{className:"x1057jvv"}),onClick:()=>em("all"),children:(0,g.t)("user_groups.clear_filter")})})]}):ep?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.oW,{src:(0,x.staticAssetWithUploadsPath)("dark"===J?"40c38fef7cb51e8ecb8825f4a9a1d834d2adc783":"a70afe2b28f296873f64775063953e3ac062dbc0"),alt:(0,g.t)("user_groups.user_group_logo"),width:150}),(0,n.jsx)("div",{...{className:"x15r87gk x1n0bwc9"},children:(0,g.t)("user_groups.no_groups_match_your_search")})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.oW,{src:(0,x.staticAssetWithUploadsPath)("df36707be31e857112158776a58401aac4b43979"),alt:(0,g.t)("user_groups.user_group_logo"),width:150}),(0,n.jsx)("div",{...{className:"xehsoiq x1akne3o xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh"},children:(0,g.t)("user_groups.no_user_groups_in_plan_yet",{planName:et?.name??""})}),(0,n.jsx)("div",{...{className:"x15r87gk x1n0bwc9"},children:(0,g.t)("user_groups.create_your_first_user_group_for_quick_flexible_collaboration_short")}),es&&(0,n.jsx)("div",{...{className:"xehsoiq"},children:(0,n.jsx)(p.$n,{variant:"primary",iconPrefix:(0,n.jsx)(b.J,{}),disabled:eo,...eo&&{"data-tooltip":(0,g.t)("user_groups.create_user_group_disabled_by_admins"),"data-tooltip-type":"text","data-tooltip-show-above":!0},onClick:()=>{$((0,S.AS)()),$((0,S.to)({type:M.C,data:{source:"user_groups_modal",onBack:eS,onCancel:eS,onSuccess:e=>{H?.(),$((0,S.AS)()),$((0,S.to)({type:D.y,data:{userGroupId:e.id,onBack:eS}}))},prefillCreatorEmail:!0}}))},children:(0,g.t)("user_groups.create_user_group")})})]})}):(0,n.jsx)(z.Cj,{columns:eO,emptyContent:null,getItemKey:e=>e.id,hideHeader:!0,isLoading:"loaded"!==eR||!!ew,itemTypeContext:{itemType:"user_group",getSelectedCountString:()=>(0,g.t)("multi_select_list.selected_count_user_groups",{numSelected:0})},items:ek,minContentWidth:0,noCheckboxColumn:!0,onFetchMore:ew,onRowClick:eL,onSelectedItemsChange:o.lQ,onSetSortState:o.lQ,rightActionColumns:eN,scrollAwayContent:ek.length>0?(0,n.jsx)("div",{...v.xk(V.g.multiSelectListScrollAwayContent),children:"all"===ef?(0,g.t)("user_group.filter.all_user_groups"):"joined"===ef?(0,g.t)("user_group.filter.groups_joined"):(0,g.t)("user_group.filter.groups_created")}):null,scrollContainerInnerClassName:v.xW(V.g.scrollContainerInner),selectAllDisabled:!0,sortState:{columnName:"",isReversed:!1},styleOverrideClassNames:{row:v.xW(Q)??""}})})]})})}),es&&!0===eE&&(0,n.jsxs)(f.wi,{children:[eo&&ea&&(0,n.jsx)("span",{...{className:"x1n0bwc9"},children:(0,g.tx)("user_groups.admins_can_manage_groups_from_admin_console",{adminConsoleLink:(0,n.jsx)(m.E,{...{className:"x1quhyk7 x1ypdohk"},onClick:()=>{$((0,S.AS)()),$(O.sf({view:"orgAdminSettings",orgAdminSettingsViewTab:L.J7.MEMBERS,orgAdminSettingsViewSecondaryTab:L.M7.USER_GROUPS}))},children:(0,g.t)("user_groups.admin_console")})})}),(0,n.jsx)(f.jk,{children:(0,n.jsx)(p.$n,{variant:"primary",iconPrefix:(0,n.jsx)(b.J,{}),disabled:eo,...eo&&{"data-tooltip":(0,g.t)("user_groups.create_user_group_disabled_by_admins"),"data-tooltip-type":"text","data-tooltip-show-above":!0},onClick:()=>{$((0,S.AS)()),$((0,S.to)({type:M.C,data:{source:"user_groups_modal",onBack:eS,onCancel:eS,onSuccess:e=>{H?.(),$((0,S.AS)()),$((0,S.to)({type:D.y,data:{userGroupId:e.id,onBack:eS}}))},prefillCreatorEmail:!0}}))},children:(0,g.t)("user_groups.create_user_group")})})]})]})})}):null}let Z=(0,C.Ju)(function(e){return(0,n.jsx)(I.u9,{label:"UserGroupsModal",children:(0,n.jsx)(J,{...e})})},"UserGroupsModal",C.ZU.YES)},864467(e,t,r){r.d(t,{Q:()=>s,R:()=>o});var n=r(105652),a=r(779757),l=r(140979),i=r(644350);function o(e){let t=e.canRead;return{canRead:t,canFavorite:e.canRead&&!e.isFavorited,canUnfavorite:e.canRead&&e.isFavorited}}function s(e,t=!0){let r=(0,n.useMemo)(()=>e.map(e=>({prototypeId:e})),[e]),d=(0,l.p)(i.vE,r,{enabled:t});return(0,n.useMemo)(()=>a.Qw.all(d.map(e=>e.result)).transform(e=>{let t={};for(let r of e){let e=r.prototype;e&&(t[e.id]=o(e))}return t}),[d])}},582036(e,t,r){r.d(t,{Cm:()=>d,gS:()=>u,xD:()=>p});var n=r(105652),a=r(832763);if(1464==r.j)var l=r(164031);var i=r(79303),o=r(864467),s=r(741405);function d(e,t=!0){return function(e,t=!0){let r=(0,i.IT)(e.fileKeys||c,t);return{files:r,repos:(0,s.k8)(e.repoIds||c,t),prototypes:(0,o.Q)(e.prototypeIds||c,t)}}(n.useMemo(()=>{let t={fileKeys:[],repoIds:[],prototypeIds:[]};return e.forEach(e=>{if(e.type===a.nb.FILE)t.fileKeys.push(a.Tf.getId(e));else if(e.type===a.nb.REPO)t.repoIds.push(a.Tf.getId(e));else if(e.type===a.nb.PROTOTYPE){let r=e.prototype.id;t.prototypeIds.push(r)}}),t},[e]),t)}let c=1464==r.j?[]:null;function u(e){return n.useMemo(()=>{let t={[l.F.FILES]:{},[l.F.PINNED_FILES]:{},[l.F.PROTOTYPES]:{},[l.F.REPOS]:{},[l.F.PROJECTS]:{},[l.F.OFFLINE_FILES]:{}};if(e)for(let r of e)t[a.YC[r.type]][a.Tf.getId(r)]=!0;return t},[e])}function p(e,{enabled:t=!0}={}){let r=u(e),a=n.useMemo(()=>[...Object.keys(r[l.F.FILES]),...Object.keys(r[l.F.PINNED_FILES])],[r]),d=n.useMemo(()=>Object.keys(r[l.F.REPOS]),[r]),c=n.useMemo(()=>Object.keys(r[l.F.PROTOTYPES]).map(e=>{if(!e.includes(","))throw Error(`Expected prototype id ${e} to be a client-side generated id`);let[t,r,n]=e.split(",");return n}),[r]),_=(0,i.IT)(a,t);return{filePermissions:_,repoPermissions:(0,s.k8)(d,t),protoPermissions:(0,o.Q)(c,t)}}},708114(e,t,r){function n(){return null}r.d(t,{A:()=>a,S:()=>l}),r(513486),r(574677),new(r(380683)).b({name:"litmus",dependencies:[],exports:{"./components":"./components.ts","./litmus_view_selector":"./litmus_view_selector.ts","./is_litmus":"./is_litmus.ts"},sideEffects:!1,friendFiles:[],routeHints:["litmus"],eslint:{rules:{"react/no-array-index-key":"off"}}});let a=n,l=n},835258(e,t,r){r.d(t,{OF:()=>a,e7:()=>n});let n=function(){return!1},a=function(){return!1}},890681(e,t,r){r.d(t,{F:()=>c});var n=r(239976),a=r(105652),l=r(850159),i=r(838719),o=r(863825),s=r(69603);let d=class e extends a.PureComponent{constructor(e){super(e),this.state={loaded:!1,error:null,isOpen:!1}}componentDidMount(){e.singleton=this}componentWillUnmount(){e.singleton=null}init(){return(0,s.L3)().then(()=>{this.state.loaded||(window.zE("webWidget","hide"),window.zE("webWidget:on","open",()=>{this.setState({isOpen:!0})}),window.zE("webWidget:on","close",()=>{this.setState({isOpen:!1}),this.close(!0)})),this.setState({loaded:!0,error:null})}).catch(e=>{throw e&&console.error("Unable to load Zendesk Web Widget:",e),this.setState({loaded:!1,error:e}),e})}open(e){let{userEmail:t,userName:r}=this.props;(0,i.isProd)()&&t?.endsWith("@figma.com")?this.props.dispatch(o.s.flash("Hello there! Sadly Figmates cannot use this feature. Please use a non-@figma.com account to test Zendesk")):this.init().then(()=>(0,s.wB)({name:r,email:t},e)).then(()=>{this.state.isOpen||(0,s.b_)()}).catch(()=>{this.props.dispatch(o.s.flash((0,l.t)("help_widget.zendesk.unavailable_error_message",{supportEmail:(0,i.supportEmail)()})))})}close(e=!1){this.state.loaded&&(this.state.isOpen||e)&&(window.zE("webWidget","hide"),window.zE("webWidget","close"))}isError(){return!!this.state.error}render(){return(0,n.jsx)("div",{className:"zendesk-web-widget"})}};d.singleton=null;let c=1464==r.j?d:null},638871(e,t,r){r.d(t,{AV:()=>u,xv:()=>_,Bm:()=>p});var n=r(239976),a=r(105652),l=r(523924),i=r(513427),o=r(224542),s=r.n(o),d=r(289886);let c="loading_page--fadeOut--vsa4j";function u({backgroundColor:e="default",children:t,loaded:r,loadingElementId:o,loadingElementClassName:u,delay:p=0}){let _=a.useRef(null),f=a.useRef(null);a.useEffect(()=>{if(_.current&&!f.current&&!(0,i.Lg)()){let e=document.getElementById(o);e&&(f.current=e.cloneNode(!0),_.current.appendChild(f.current))}},[o,_]);let m={animationDelay:`${p}ms`,backgroundColor:function(e){if("default"===e)return"var(--color-bg)";(0,l.xb)(e)}(e)};return(0,n.jsxs)(n.Fragment,{children:[r&&t,(0,n.jsx)("div",{"data-testid":`${o}-loading-skeleton`,ref:_,className:s()(u,d.s.eventsNone.absolute.top0.left0.right0.bottom0.overflowHidden.opacity1.$,{[c]:r}),style:m})]})}function p({result:e,children:t,...r}){let a="loaded"===e.status;return(0,n.jsx)(u,{...r,loaded:a,children:a?t(e.data):null})}function _({loaded:e,loadingSkeletonElement:t,showElementBeforeLoaded:r,children:l}){let i=a.useRef(e);return(0,n.jsxs)("div",{className:d.s.grid.$,children:[(e||r)&&(0,n.jsx)("div",{className:s()(d.s.gridRowEnd1.gridColumnEnd1.$),children:l}),(0,n.jsx)("div",{className:s()(d.s.eventsNone.gridRowEnd1.gridColumnEnd1.overflowHidden.$,{[c]:e,[d.s.opacity1.$]:!i.current}),children:t})]})}},388565(e,t,r){r.d(t,{e:()=>b});var n=r(239976),a=r(741542),l=r(350923),i=r(105652),o=r(946182),s=r(203574),d=r(567584),c=r(487817),u=r(206881),p=r(318131),_=r(289886);function f({thumbnailUrl:e,thumbnailType:t,clientMeta:r,lastTouchedAt:a,config:l,...o}){let[d,c]=i.useState(1),[u,p]=i.useState({x:0,y:0}),f=i.useRef(null),m=l?.get("FJZoomableThumbnailsScale",3.5)??3.5,h=i.useCallback(e=>{let t=f.current;if(!t)return;let r=t.getBoundingClientRect();p({x:e.clientX-r.left,y:e.clientY-r.top})},[p]),y=i.useCallback(()=>{c(m)},[m,c]),E=i.useCallback(()=>{c(1)},[c]);return(0,n.jsx)("div",{className:_.s.hFull.wFull.$,onMouseMove:h,onMouseEnter:y,onMouseLeave:E,onDragStart:E,children:(0,n.jsx)("div",{ref:f,className:_.s.hFull.wFull.$,children:(0,n.jsx)(s.V,{thumbnailUrl:e,thumbnailType:t,lastTouchedAt:a,clientMeta:r,addtlStyles:{transform:`scale(${d})`,transformOrigin:`${u.x}px ${u.y}px`,transition:`transform 0.4s ease ${.5*(d>1)}s`},draggable:!0,...o})})})}function m({thumbnailUrl:e,thumbnailType:t,additionalThumbnailUrls:r,clientMeta:a,lastTouchedAt:l,editorType:_,...m}){let{getConfig:h}=(0,o.I7)("exp_search_fb_thumbnail_previews"),y=h(),E=y.get("shouldAutoplay",!0),b=i.useRef(null);switch(_){case c._Y.WHITEBOARD:if(t===d.F.WHITEBOARD)break;return(0,n.jsx)(f,{thumbnailUrl:e,clientMeta:a,thumbnailType:t,lastTouchedAt:l,config:y,...m});default:let g=(r||[]).slice(0,6);if(g.length<3)break;if(E)return(0,n.jsx)(u.A,{ref:b,thumbnailUrl:e,additionalThumbnailUrls:g,clientMeta:a,thumbnailType:t,lastTouchedAt:l,...m});return(0,n.jsx)(p._,{ref:b,thumbnailUrl:e,additionalThumbnailUrls:g,clientMeta:a,thumbnailType:t,lastTouchedAt:l,...m})}return(0,n.jsx)(s.V,{thumbnailUrl:e,clientMeta:a,thumbnailType:t,lastTouchedAt:l,...m})}var h=r(427368),y=r(343902),E=r(832763);function b({tile:e,interactiveThumbnailsEnabled:t,...r}){var i;let o,u,p=E.Tf.getIsPasswordProtected(e),_=(0,l.md)((0,E.hi)({tile:e,enabled:p})),f=E.Tf.getThumbnailUrl(e),b=E.Tf.getTouchedAt(e),g=(i=e,o=E.Tf.getIsThumbnailFullWidth(i),u=E.Tf.getEditorType(i),i.type===E.nb.PROTOTYPE?d.F.PROTOTYPE:i.type===E.nb.OFFLINE_FILE?d.F.OFFLINE:u===c._Y.SLIDES?d.F.SLIDES:u===c._Y.WHITEBOARD?o?d.F.WHITEBOARD:d.F.DEFAULT_WHITEBOARD:o?d.F.DESIGN:d.F.DEFAULT_DESIGN);if(p){if("loading"===_.status)return(0,n.jsx)(y.q,{...r});if(!_.unwrapOr(!1))return(0,n.jsx)(h.N,{thumbnailType:g,...r})}let v=E.Tf.getClientMeta(e),F=E.Tf.getEditorType(e),x=E.Tf.getFileOrMainBranchKey(e);return(0,a.getFeatureFlags)().scrub_file_browser_search_results&&t&&f?(0,n.jsx)(m,{thumbnailUrl:f,thumbnailType:g,additionalThumbnailUrls:E.Tf.getPreviewThumbnailUrls(e)??[],clientMeta:v,lastTouchedAt:b,editorType:F,...r},x):(0,n.jsx)(s.V,{thumbnailUrl:f,clientMeta:v,thumbnailType:g,lastTouchedAt:b,...r},x)}},206881(e,t,r){r.d(t,{A:()=>_});var n=r(239976),a=r(105652),l=r(706354),i=r(224542),o=r.n(i),s=r(42053),d=r(203574),c=r(289886),u=r(618088),p=r(958850);let _=a.forwardRef(({thumbnailUrl:e,additionalThumbnailUrls:t,thumbnailType:r,clientMeta:i,lastTouchedAt:_,...f},m)=>{let[h,y]=a.useState(0),[E,b]=a.useState(!1),[g,v]=a.useState(!1),F=a.useRef(null),x=a.useRef(void 0),I=a.useRef(void 0),[T,w]=a.useState(!1),R=(0,u.E)(e,t,r,!0),k=R.length,O=R[h];a.useEffect(()=>{T||Promise.all(t.map(e=>(0,u.N)(e))).then(()=>{w(!0)}).catch(e=>{(0,s.x1)(l.FigmaTeam.SEARCH,"[fb-scrubber] Error: Could not pre-load fragment thumbnails",e)})},[T,t]);let S=()=>{I.current||(I.current=window.setInterval(()=>{y(e=>(e+1)%k)},800))},C=()=>{I.current&&(clearInterval(I.current),I.current=void 0)},A=()=>{clearTimeout(x.current),x.current=void 0,b(!1),v(!1),C(),y(0)},P=(e,t)=>{if(C(),0!==t.buttons){A(),y(0);return}y(e)};if(a.useEffect(()=>{clearInterval(I.current),clearTimeout(x.current)},[]),!T)return(0,n.jsx)("div",{className:c.s.hFull.wFull.$,children:(0,n.jsx)(d.V,{thumbnailUrl:e,thumbnailType:r,lastTouchedAt:_,clientMeta:i,...f})});let j=Array.from({length:R.length}).map((e,t)=>(0,n.jsx)("div",{className:p.j6,onMouseEnter:g?e=>P(t,e):void 0,onMouseMove:g?e=>P(t,e):void 0,children:(0,n.jsx)("button",{className:o()(p.Om,{[p.o]:t===h})},t)},t));return(0,n.jsx)("div",{className:c.s.hFull.wFull.$,ref:m,onMouseEnter:()=>{b(!0),S(),x.current=window.setTimeout(()=>{v(!0)},200)},onMouseLeave:A,onDragStart:A,children:(0,n.jsxs)("div",{ref:F,className:c.s.hFull.wFull.$,children:[(0,n.jsx)("div",{className:p.rR}),(0,n.jsx)(d.V,{thumbnailUrl:O,thumbnailType:r,lastTouchedAt:_,clientMeta:i,draggable:!0,...f}),(0,n.jsx)("div",{className:o()(p.r$,{[p.R]:!E}),onMouseLeave:g?()=>{S()}:void 0,children:j})]})})})},618088(e,t,r){if(r.d(t,{E:()=>l,N:()=>a}),1464==r.j)var n=r(567584);function a(e){return new Promise((t,r)=>{let n=new Image;n.src=e,n.crossOrigin="anonymous",n.onload=()=>{t(e)},n.onerror=e=>{r(e)}})}function l(e,t,r,a){return 0===t.length?[e]:a||r===n.F.SLIDES?[e,...t]:[e,...t,e]}},318131(e,t,r){r.d(t,{_:()=>m,i:()=>f});var n=r(239976),a=r(105652),l=r(706354),i=r(350923),o=r(224542),s=r.n(o),d=r(42053),c=r(203574),u=r(289886),p=r(618088),_=r(958850);let f=(0,i.eU)(new Set),m=a.forwardRef(({thumbnailUrl:e,additionalThumbnailUrls:t,thumbnailType:r,clientMeta:o,lastTouchedAt:m,showEmptyState:h,...y},E)=>{let[b,g]=a.useState(0),[v,F]=a.useState(b),[x,I]=a.useState(500),T=a.useRef(void 0),w=a.useRef(b),R=a.useRef(null);a.useEffect(()=>{w.current=b,T.current||(T.current=window.setTimeout(()=>{F(w.current),T.current=void 0,I(100)},x))},[b]);let[k,O]=a.useState(!1),S=(0,p.E)(e,t,r),C=S.length,A=S[v];a.useEffect(()=>{k||Promise.all(t.map(e=>(0,p.N)(e))).then(()=>{O(!0)}).catch(e=>{(0,d.x1)(l.FigmaTeam.SEARCH,"[fb-scrubber] Error: Could not pre-load fragment thumbnails",e)})},[k,t]);let P=a.useCallback(e=>{let t=R.current;if(!t)return;let r=t.getBoundingClientRect(),n=r.width/C;g(Math.max(0,Math.min(Math.floor((e.clientX-r.left)/n),C-1)))},[C]),j=()=>{clearTimeout(T.current),T.current=void 0,g(0),F(0),I(500)},N=(0,i.Xr)(f),L="IntersectionObserver"in window,[M,W]=a.useState(!1);return(a.useEffect(()=>{if(!L||!k||"function"==typeof E||!E?.current)return;let e=E.current,t=new IntersectionObserver(([e])=>{W(e.isIntersecting)},{threshold:1});return t.observe(e),()=>{t.unobserve(e)}},[E,t,k,L]),a.useEffect(()=>(M?N(t=>new Set(t).add(e)):N(t=>{let r=new Set(t);return r.delete(e),r}),()=>{N(t=>{let r=new Set(t);return r.delete(e),r})}),[M,e,N]),k)?(0,n.jsx)("div",{className:s()(u.s.hFull.wFull.$,_.xn),ref:E,onMouseMove:P,onMouseEnter:()=>{I(500)},onMouseLeave:j,onDragStart:j,children:(0,n.jsxs)("div",{ref:R,className:u.s.hFull.wFull.$,children:[(0,n.jsx)("div",{"data-onboarding-key":M?"scrubbable-thumbnail":void 0,className:_.rR}),(0,n.jsx)(c.V,{thumbnailUrl:A,thumbnailType:r,lastTouchedAt:m,clientMeta:o,draggable:!0,...y})]})}):(0,n.jsx)("div",{onMouseEnter:h?e=>{e.target.style.transition="opacity 0.2s ease-in-out",e.target.style.opacity="0.5",setTimeout(()=>{e.target.style.opacity="1"},200)}:void 0,className:u.s.hFull.wFull.$,children:(0,n.jsx)(c.V,{thumbnailUrl:e,thumbnailType:r,lastTouchedAt:m,clientMeta:o,...y})})})},947169(e,t,r){r.d(t,{ID:()=>n}),r(574988);let n=1464==r.j?{inputMargin:"8px",previewRowHeight:"48px",containerWidth:"380px",containerWidthDesktopNewTab:"816px",bottomPaddingDesktopNewTab:"32px",barHeight:"32px",facetedSearchHeight:"40px"}:null},96277(e,t,r){if(r.d(t,{z:()=>a}),1464==r.j)var n=r(741542);function a(){return(0,n.getFeatureFlags)().sites_beta?"BETA":"UNKNOWN"}},622531(e,t,r){r.d(t,{v:()=>l});var n=r(105652),a=r(239976);let l=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M17 14.942V16.5c0 .005 0 .024-.02.063a.8.8 0 0 1-.153.198c-.183.18-.498.388-.969.584-.937.39-2.3.655-3.858.655s-2.921-.265-3.858-.655c-.47-.196-.786-.404-.969-.584a.8.8 0 0 1-.154-.198A.14.14 0 0 1 7 16.5v-1.558c.274.169.593.316.94.442 1.063.387 2.499.616 4.06.616s2.997-.23 4.06-.616a5 5 0 0 0 .94-.442m0-1.442c0 .076-.04.212-.258.4-.216.185-.558.375-1.024.544-.927.338-2.242.556-3.718.556s-2.79-.218-3.718-.556c-.466-.17-.808-.359-1.024-.545C7.041 13.712 7 13.576 7 13.5v-1.558c.274.169.593.316.94.442 1.063.387 2.499.616 4.06.616s2.997-.23 4.06-.616a5 5 0 0 0 .94-.442zm-9.742-2.6c-.217-.188-.258-.324-.258-.4V8.942c.274.169.593.316.94.442C9.003 9.771 10.439 10 12 10s2.997-.23 4.06-.616c.347-.126.666-.273.94-.442V10.5c0 .076-.04.212-.258.4-.216.185-.558.375-1.024.544-.927.338-2.242.556-3.718.556s-2.79-.218-3.718-.556c-.466-.17-.808-.359-1.024-.545M17 7.5c0-.005 0-.024-.02-.063a.8.8 0 0 0-.153-.198c-.183-.18-.498-.388-.969-.584C14.921 6.265 13.558 6 12 6s-2.921.265-3.858.655c-.47.196-.786.404-.969.584a.8.8 0 0 0-.154.198A.14.14 0 0 0 7 7.5c0 .076.04.212.258.4.216.185.558.375 1.024.544C9.209 8.782 10.524 9 12 9s2.79-.218 3.718-.556c.466-.17.808-.359 1.024-.545.217-.187.258-.323.258-.399m-11 0C6 6.12 8.686 5 12 5s6 1.12 6 2.5v9c0 1.38-2.686 2.5-6 2.5s-6-1.12-6-2.5z",clipRule:"evenodd"})})})},218896(e,t,r){r.d(t,{s:()=>l});var n=r(105652),a=r(239976);let l=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M7.5 6a.5.5 0 0 1 .5.5v9.793l1.146-1.146a.5.5 0 0 1 .707.707l-2 2a.5.5 0 0 1-.707 0l-2-2-.064-.079a.5.5 0 0 1 .693-.693l.078.064L7 16.293V6.5a.5.5 0 0 1 .5-.5m10 10a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1zm0-3a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1zm0-3a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1zm0-3a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1z"})})})},308113(e,t,r){r.d(t,{w:()=>l});var n=r(105652),a=r(239976);let l=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M18 4a2 2 0 0 1 2 2v6.172l-.01.197a2 2 0 0 1-.576 1.217l-5.828 5.828-.146.133a2 2 0 0 1-1.268.453H6l-.204-.01A2 2 0 0 1 4 18V6a2 2 0 0 1 2-2zM6 5a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h6v-5a2 2 0 0 1 2-2h5V6a1 1 0 0 0-1-1zm8 8a1 1 0 0 0-1 1v4.586L18.586 13z"})})})},211573(e,t,r){r.d(t,{R:()=>l});var n=r(105652),a=r(239976);let l=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M18 12a6 6 0 1 1-12 0 6 6 0 0 1 12 0m1 0a7 7 0 1 1-14 0 7 7 0 0 1 14 0m-6.5-3.5a.5.5 0 0 0-1 0V12a.5.5 0 0 0 .146.354l2 2a.5.5 0 0 0 .708-.708L12.5 11.793z",clipRule:"evenodd"})})})}}]);

//# debugId=64227ceb-6998-5d24-a46c-3cfbc63f1f33

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/fec9ae9428c06b273ea4bbb7ae8df3ddecef6ee7/3416-a492e75c14b55166.min.js.map